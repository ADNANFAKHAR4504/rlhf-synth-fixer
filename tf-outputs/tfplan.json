{"format_version":"1.2","terraform_version":"1.12.2","variables":{"aws_region":{"value":"us-west-2"},"environment":{"value":"production"},"environment_suffix":{"value":"synthtrainr838"},"notification_email":{"value":"security-alerts@example.com"},"project_name":{"value":"SecureInfrastructure"}},"planned_values":{"outputs":{"access_logs_bucket_name":{"sensitive":false,"type":"string","value":"718240086340-security-synthtrainr838-access-logs"},"cloudwatch_log_group_name":{"sensitive":false,"type":"string","value":"/aws/security/718240086340-security-synthtrainr838"},"config_bucket_name":{"sensitive":false,"type":"string","value":"718240086340-security-synthtrainr838-config-bucket"},"cross_account_role_arn":{"sensitive":false},"guardduty_detector_id":{"sensitive":false},"kms_key_arn":{"sensitive":false},"kms_key_id":{"sensitive":false},"lambda_function_arn":{"sensitive":false},"lambda_function_name":{"sensitive":false,"type":"string","value":"718240086340-security-synthtrainr838-security-response"},"secure_bucket_arn":{"sensitive":false},"secure_bucket_name":{"sensitive":false,"type":"string","value":"718240086340-security-synthtrainr838-secure-data"},"security_hub_account_id":{"sensitive":false},"security_monitoring_role_arn":{"sensitive":false},"sns_topic_arn":{"sensitive":false},"step_function_arn":{"sensitive":false}},"root_module":{"resources":[{"address":"aws_cloudwatch_log_group.security_logs","mode":"managed","type":"aws_cloudwatch_log_group","name":"security_logs","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"name":"/aws/security/718240086340-security-synthtrainr838","region":"us-west-2","retention_in_days":90,"skip_destroy":false,"tags":{"AccountId":"718240086340","Environment":"production","EnvironmentSuffix":"synthtrainr838","ManagedBy":"terraform","Project":"SecureInfrastructure"},"tags_all":{"AccountId":"718240086340","Environment":"production","EnvironmentSuffix":"synthtrainr838","ManagedBy":"terraform","Project":"SecureInfrastructure"}},"sensitive_values":{"tags":{},"tags_all":{}},"identity_schema_version":0,"identity":{"account_id":null,"name":null,"region":null}},{"address":"aws_cloudwatch_log_metric_filter.iam_actions","mode":"managed","type":"aws_cloudwatch_log_metric_filter","name":"iam_actions","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"log_group_name":"/aws/security/718240086340-security-synthtrainr838","metric_transformation":[{"default_value":null,"dimensions":null,"name":"IAMActions","namespace":"Security/IAM","unit":"None","value":"1"}],"name":"718240086340-security-synthtrainr838-iam-actions","pattern":"{ ($.eventName = CreateUser) || ($.eventName = DeleteUser) || ($.eventName = CreateRole) || ($.eventName = DeleteRole) || ($.eventName = AttachUserPolicy) || ($.eventName = DetachUserPolicy) }","region":"us-west-2"},"sensitive_values":{"metric_transformation":[{}]}},{"address":"aws_cloudwatch_metric_alarm.iam_actions_alarm","mode":"managed","type":"aws_cloudwatch_metric_alarm","name":"iam_actions_alarm","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":1,"values":{"actions_enabled":true,"alarm_description":"This metric monitors IAM actions","alarm_name":"718240086340-security-synthtrainr838-iam-actions-alarm","comparison_operator":"GreaterThanOrEqualToThreshold","datapoints_to_alarm":null,"dimensions":null,"evaluation_periods":1,"extended_statistic":null,"insufficient_data_actions":null,"metric_name":"IAMActions","metric_query":[],"namespace":"Security/IAM","ok_actions":null,"period":300,"region":"us-west-2","statistic":"Sum","tags":{"AccountId":"718240086340","Environment":"production","EnvironmentSuffix":"synthtrainr838","ManagedBy":"terraform","Project":"SecureInfrastructure"},"tags_all":{"AccountId":"718240086340","Environment":"production","EnvironmentSuffix":"synthtrainr838","ManagedBy":"terraform","Project":"SecureInfrastructure"},"threshold":1,"threshold_metric_id":null,"treat_missing_data":"missing","unit":null},"sensitive_values":{"alarm_actions":[],"metric_query":[],"tags":{},"tags_all":{}}},{"address":"aws_config_configuration_recorder.security_recorder","mode":"managed","type":"aws_config_configuration_recorder","name":"security_recorder","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"name":"718240086340-security-synthtrainr838-config-recorder","recording_group":[{"all_supported":true,"include_global_resource_types":true,"resource_types":null}],"region":"us-west-2"},"sensitive_values":{"recording_group":[{"exclusion_by_resource_types":[],"recording_strategy":[]}],"recording_mode":[]}},{"address":"aws_config_configuration_recorder_status.security_recorder_status","mode":"managed","type":"aws_config_configuration_recorder_status","name":"security_recorder_status","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"is_enabled":true,"name":"718240086340-security-synthtrainr838-config-recorder","region":"us-west-2"},"sensitive_values":{}},{"address":"aws_config_delivery_channel.security_delivery_channel","mode":"managed","type":"aws_config_delivery_channel","name":"security_delivery_channel","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"name":"718240086340-security-synthtrainr838-config-delivery-channel","region":"us-west-2","s3_bucket_name":"718240086340-security-synthtrainr838-config-bucket","s3_key_prefix":"config","s3_kms_key_arn":null,"snapshot_delivery_properties":[],"sns_topic_arn":null},"sensitive_values":{"snapshot_delivery_properties":[]}},{"address":"aws_guardduty_detector.main","mode":"managed","type":"aws_guardduty_detector","name":"main","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"enable":true,"region":"us-west-2","tags":{"AccountId":"718240086340","Environment":"production","EnvironmentSuffix":"synthtrainr838","ManagedBy":"terraform","Project":"SecureInfrastructure"},"tags_all":{"AccountId":"718240086340","Environment":"production","EnvironmentSuffix":"synthtrainr838","ManagedBy":"terraform","Project":"SecureInfrastructure"}},"sensitive_values":{"datasources":[],"tags":{},"tags_all":{}}},{"address":"aws_guardduty_detector_feature.eks_audit_logs","mode":"managed","type":"aws_guardduty_detector_feature","name":"eks_audit_logs","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"additional_configuration":[],"name":"EKS_AUDIT_LOGS","region":"us-west-2","status":"ENABLED"},"sensitive_values":{"additional_configuration":[]}},{"address":"aws_guardduty_detector_feature.malware_protection","mode":"managed","type":"aws_guardduty_detector_feature","name":"malware_protection","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"additional_configuration":[],"name":"EBS_MALWARE_PROTECTION","region":"us-west-2","status":"ENABLED"},"sensitive_values":{"additional_configuration":[]}},{"address":"aws_guardduty_detector_feature.s3_logs","mode":"managed","type":"aws_guardduty_detector_feature","name":"s3_logs","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"additional_configuration":[],"name":"S3_DATA_EVENTS","region":"us-west-2","status":"ENABLED"},"sensitive_values":{"additional_configuration":[]}},{"address":"aws_iam_role.config_role","mode":"managed","type":"aws_iam_role","name":"config_role","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"assume_role_policy":"{\"Statement\":[{\"Action\":\"sts:AssumeRole\",\"Effect\":\"Allow\",\"Principal\":{\"Service\":\"config.amazonaws.com\"}}],\"Version\":\"2012-10-17\"}","description":null,"force_detach_policies":false,"max_session_duration":3600,"name":"718240086340-security-synthtrainr838-config-role","path":"/","permissions_boundary":null,"tags":{"AccountId":"718240086340","Environment":"production","EnvironmentSuffix":"synthtrainr838","ManagedBy":"terraform","Project":"SecureInfrastructure"},"tags_all":{"AccountId":"718240086340","Environment":"production","EnvironmentSuffix":"synthtrainr838","ManagedBy":"terraform","Project":"SecureInfrastructure"}},"sensitive_values":{"inline_policy":[],"managed_policy_arns":[],"tags":{},"tags_all":{}},"identity_schema_version":0,"identity":{"account_id":null,"name":null}},{"address":"aws_iam_role.cross_account_role","mode":"managed","type":"aws_iam_role","name":"cross_account_role","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"assume_role_policy":"{\"Statement\":[{\"Action\":\"sts:AssumeRole\",\"Condition\":{\"StringEquals\":{\"sts:ExternalId\":\"718240086340-security-synthtrainr838-external-id\"}},\"Effect\":\"Allow\",\"Principal\":{\"AWS\":\"arn:aws:iam::718240086340:root\"}}],\"Version\":\"2012-10-17\"}","description":null,"force_detach_policies":false,"max_session_duration":3600,"name":"718240086340-security-synthtrainr838-cross-account-role","path":"/","permissions_boundary":null,"tags":{"AccountId":"718240086340","Environment":"production","EnvironmentSuffix":"synthtrainr838","ManagedBy":"terraform","Project":"SecureInfrastructure"},"tags_all":{"AccountId":"718240086340","Environment":"production","EnvironmentSuffix":"synthtrainr838","ManagedBy":"terraform","Project":"SecureInfrastructure"}},"sensitive_values":{"inline_policy":[],"managed_policy_arns":[],"tags":{},"tags_all":{}},"identity_schema_version":0,"identity":{"account_id":null,"name":null}},{"address":"aws_iam_role.lambda_execution_role","mode":"managed","type":"aws_iam_role","name":"lambda_execution_role","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"assume_role_policy":"{\"Statement\":[{\"Action\":\"sts:AssumeRole\",\"Effect\":\"Allow\",\"Principal\":{\"Service\":\"lambda.amazonaws.com\"}}],\"Version\":\"2012-10-17\"}","description":null,"force_detach_policies":false,"max_session_duration":3600,"name":"718240086340-security-synthtrainr838-lambda-execution-role","path":"/","permissions_boundary":null,"tags":{"AccountId":"718240086340","Environment":"production","EnvironmentSuffix":"synthtrainr838","ManagedBy":"terraform","Project":"SecureInfrastructure"},"tags_all":{"AccountId":"718240086340","Environment":"production","EnvironmentSuffix":"synthtrainr838","ManagedBy":"terraform","Project":"SecureInfrastructure"}},"sensitive_values":{"inline_policy":[],"managed_policy_arns":[],"tags":{},"tags_all":{}},"identity_schema_version":0,"identity":{"account_id":null,"name":null}},{"address":"aws_iam_role.security_monitoring_role","mode":"managed","type":"aws_iam_role","name":"security_monitoring_role","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"assume_role_policy":"{\"Statement\":[{\"Action\":\"sts:AssumeRole\",\"Effect\":\"Allow\",\"Principal\":{\"Service\":[\"lambda.amazonaws.com\",\"config.amazonaws.com\"]}}],\"Version\":\"2012-10-17\"}","description":null,"force_detach_policies":false,"max_session_duration":3600,"name":"718240086340-security-synthtrainr838-monitoring-role","path":"/","permissions_boundary":null,"tags":{"AccountId":"718240086340","Environment":"production","EnvironmentSuffix":"synthtrainr838","ManagedBy":"terraform","Project":"SecureInfrastructure"},"tags_all":{"AccountId":"718240086340","Environment":"production","EnvironmentSuffix":"synthtrainr838","ManagedBy":"terraform","Project":"SecureInfrastructure"}},"sensitive_values":{"inline_policy":[],"managed_policy_arns":[],"tags":{},"tags_all":{}},"identity_schema_version":0,"identity":{"account_id":null,"name":null}},{"address":"aws_iam_role.step_function_role","mode":"managed","type":"aws_iam_role","name":"step_function_role","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"assume_role_policy":"{\"Statement\":[{\"Action\":\"sts:AssumeRole\",\"Effect\":\"Allow\",\"Principal\":{\"Service\":\"states.amazonaws.com\"}}],\"Version\":\"2012-10-17\"}","description":null,"force_detach_policies":false,"max_session_duration":3600,"name":"718240086340-security-synthtrainr838-step-function-role","path":"/","permissions_boundary":null,"tags":{"AccountId":"718240086340","Environment":"production","EnvironmentSuffix":"synthtrainr838","ManagedBy":"terraform","Project":"SecureInfrastructure"},"tags_all":{"AccountId":"718240086340","Environment":"production","EnvironmentSuffix":"synthtrainr838","ManagedBy":"terraform","Project":"SecureInfrastructure"}},"sensitive_values":{"inline_policy":[],"managed_policy_arns":[],"tags":{},"tags_all":{}},"identity_schema_version":0,"identity":{"account_id":null,"name":null}},{"address":"aws_iam_role_policy.config_s3_policy","mode":"managed","type":"aws_iam_role_policy","name":"config_s3_policy","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"name":"718240086340-security-synthtrainr838-config-s3-policy"},"sensitive_values":{},"identity_schema_version":0,"identity":{"account_id":null,"name":null,"role":null}},{"address":"aws_iam_role_policy.cross_account_policy","mode":"managed","type":"aws_iam_role_policy","name":"cross_account_policy","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"name":"718240086340-security-synthtrainr838-cross-account-policy"},"sensitive_values":{},"identity_schema_version":0,"identity":{"account_id":null,"name":null,"role":null}},{"address":"aws_iam_role_policy.lambda_execution_policy","mode":"managed","type":"aws_iam_role_policy","name":"lambda_execution_policy","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"name":"718240086340-security-synthtrainr838-lambda-execution-policy","policy":"{\"Version\":\"2012-10-17\",\"Statement\":[{\"Action\":[\"logs:CreateLogGroup\",\"logs:CreateLogStream\",\"logs:PutLogEvents\",\"sns:Publish\",\"iam:ListUsers\",\"iam:GetUser\",\"iam:PutUserPolicy\",\"iam:DeleteUserPolicy\",\"kms:Encrypt\",\"kms:Decrypt\",\"kms:GenerateDataKey\"],\"Effect\":\"Allow\",\"Resource\":\"*\"}]}"},"sensitive_values":{},"identity_schema_version":0,"identity":{"account_id":null,"name":null,"role":null}},{"address":"aws_iam_role_policy.security_monitoring_policy","mode":"managed","type":"aws_iam_role_policy","name":"security_monitoring_policy","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"name":"718240086340-security-synthtrainr838-monitoring-policy","policy":"{\"Version\":\"2012-10-17\",\"Statement\":[{\"Action\":[\"logs:CreateLogGroup\",\"logs:CreateLogStream\",\"logs:PutLogEvents\",\"sns:Publish\",\"cloudwatch:PutMetricData\",\"config:PutEvaluations\",\"iam:ListUsers\",\"iam:GetUser\",\"iam:ListAccessKeys\",\"securityhub:BatchImportFindings\",\"guardduty:GetFindings\"],\"Effect\":\"Allow\",\"Resource\":\"*\"}]}"},"sensitive_values":{},"identity_schema_version":0,"identity":{"account_id":null,"name":null,"role":null}},{"address":"aws_iam_role_policy.step_function_policy","mode":"managed","type":"aws_iam_role_policy","name":"step_function_policy","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"name":"718240086340-security-synthtrainr838-step-function-policy"},"sensitive_values":{},"identity_schema_version":0,"identity":{"account_id":null,"name":null,"role":null}},{"address":"aws_iam_role_policy_attachment.config_policy","mode":"managed","type":"aws_iam_role_policy_attachment","name":"config_policy","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"policy_arn":"arn:aws:iam::aws:policy/service-role/AWS_ConfigRole","role":"718240086340-security-synthtrainr838-config-role"},"sensitive_values":{},"identity_schema_version":0,"identity":{"account_id":null,"policy_arn":null,"role":null}},{"address":"aws_kms_alias.security_key_alias","mode":"managed","type":"aws_kms_alias","name":"security_key_alias","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"name":"alias/718240086340-security-synthtrainr838-key","region":"us-west-2"},"sensitive_values":{}},{"address":"aws_kms_key.security_key","mode":"managed","type":"aws_kms_key","name":"security_key","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"bypass_policy_lockout_safety_check":false,"custom_key_store_id":null,"customer_master_key_spec":"SYMMETRIC_DEFAULT","deletion_window_in_days":7,"description":"KMS key for encrypting sensitive data","enable_key_rotation":true,"is_enabled":true,"key_usage":"ENCRYPT_DECRYPT","policy":"{\"Statement\":[{\"Action\":\"kms:*\",\"Effect\":\"Allow\",\"Principal\":{\"AWS\":\"arn:aws:iam::718240086340:root\"},\"Resource\":\"*\",\"Sid\":\"Enable IAM User Permissions\"},{\"Action\":[\"kms:Encrypt\",\"kms:Decrypt\",\"kms:ReEncrypt*\",\"kms:GenerateDataKey*\",\"kms:CreateGrant\",\"kms:DescribeKey\"],\"Condition\":{\"ArnLike\":{\"kms:EncryptionContext:aws:logs:arn\":\"arn:aws:logs:us-west-2:718240086340:log-group:*\"}},\"Effect\":\"Allow\",\"Principal\":{\"Service\":\"logs.us-west-2.amazonaws.com\"},\"Resource\":\"*\",\"Sid\":\"Allow CloudWatch Logs\"}],\"Version\":\"2012-10-17\"}","region":"us-west-2","tags":{"AccountId":"718240086340","Environment":"production","EnvironmentSuffix":"synthtrainr838","ManagedBy":"terraform","Project":"SecureInfrastructure"},"tags_all":{"AccountId":"718240086340","Environment":"production","EnvironmentSuffix":"synthtrainr838","ManagedBy":"terraform","Project":"SecureInfrastructure"},"timeouts":null,"xks_key_id":null},"sensitive_values":{"tags":{},"tags_all":{}}},{"address":"aws_lambda_function.security_response","mode":"managed","type":"aws_lambda_function","name":"security_response","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"code_signing_config_arn":null,"dead_letter_config":[],"description":null,"environment":[{}],"file_system_config":[],"filename":"security_response.zip","function_name":"718240086340-security-synthtrainr838-security-response","handler":"index.handler","image_config":[],"image_uri":null,"kms_key_arn":null,"layers":null,"memory_size":128,"package_type":"Zip","publish":false,"region":"us-west-2","replace_security_groups_on_destroy":null,"replacement_security_group_ids":null,"reserved_concurrent_executions":-1,"runtime":"python3.9","s3_bucket":null,"s3_key":null,"s3_object_version":null,"skip_destroy":false,"snap_start":[],"tags":{"AccountId":"718240086340","Environment":"production","EnvironmentSuffix":"synthtrainr838","ManagedBy":"terraform","Project":"SecureInfrastructure"},"tags_all":{"AccountId":"718240086340","Environment":"production","EnvironmentSuffix":"synthtrainr838","ManagedBy":"terraform","Project":"SecureInfrastructure"},"timeout":300,"timeouts":null,"vpc_config":[]},"sensitive_values":{"architectures":[],"dead_letter_config":[],"environment":[{"variables":{}}],"ephemeral_storage":[],"file_system_config":[],"image_config":[],"logging_config":[],"snap_start":[],"tags":{},"tags_all":{},"tracing_config":[],"vpc_config":[]}},{"address":"aws_s3_bucket.access_logs","mode":"managed","type":"aws_s3_bucket","name":"access_logs","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"bucket":"718240086340-security-synthtrainr838-access-logs","force_destroy":true,"region":"us-west-2","tags":{"AccountId":"718240086340","Environment":"production","EnvironmentSuffix":"synthtrainr838","ManagedBy":"terraform","Project":"SecureInfrastructure"},"tags_all":{"AccountId":"718240086340","Environment":"production","EnvironmentSuffix":"synthtrainr838","ManagedBy":"terraform","Project":"SecureInfrastructure"},"timeouts":null},"sensitive_values":{"cors_rule":[],"grant":[],"lifecycle_rule":[],"logging":[],"object_lock_configuration":[],"replication_configuration":[],"server_side_encryption_configuration":[],"tags":{},"tags_all":{},"versioning":[],"website":[]},"identity_schema_version":0,"identity":{"account_id":null,"bucket":null,"region":null}},{"address":"aws_s3_bucket.config_bucket","mode":"managed","type":"aws_s3_bucket","name":"config_bucket","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"bucket":"718240086340-security-synthtrainr838-config-bucket","force_destroy":true,"region":"us-west-2","tags":{"AccountId":"718240086340","Environment":"production","EnvironmentSuffix":"synthtrainr838","ManagedBy":"terraform","Project":"SecureInfrastructure"},"tags_all":{"AccountId":"718240086340","Environment":"production","EnvironmentSuffix":"synthtrainr838","ManagedBy":"terraform","Project":"SecureInfrastructure"},"timeouts":null},"sensitive_values":{"cors_rule":[],"grant":[],"lifecycle_rule":[],"logging":[],"object_lock_configuration":[],"replication_configuration":[],"server_side_encryption_configuration":[],"tags":{},"tags_all":{},"versioning":[],"website":[]},"identity_schema_version":0,"identity":{"account_id":null,"bucket":null,"region":null}},{"address":"aws_s3_bucket.secure_bucket","mode":"managed","type":"aws_s3_bucket","name":"secure_bucket","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"bucket":"718240086340-security-synthtrainr838-secure-data","force_destroy":true,"region":"us-west-2","tags":{"AccountId":"718240086340","Environment":"production","EnvironmentSuffix":"synthtrainr838","ManagedBy":"terraform","Project":"SecureInfrastructure"},"tags_all":{"AccountId":"718240086340","Environment":"production","EnvironmentSuffix":"synthtrainr838","ManagedBy":"terraform","Project":"SecureInfrastructure"},"timeouts":null},"sensitive_values":{"cors_rule":[],"grant":[],"lifecycle_rule":[],"logging":[],"object_lock_configuration":[],"replication_configuration":[],"server_side_encryption_configuration":[],"tags":{},"tags_all":{},"versioning":[],"website":[]},"identity_schema_version":0,"identity":{"account_id":null,"bucket":null,"region":null}},{"address":"aws_s3_bucket_logging.secure_bucket_logging","mode":"managed","type":"aws_s3_bucket_logging","name":"secure_bucket_logging","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"expected_bucket_owner":null,"region":"us-west-2","target_grant":[],"target_object_key_format":[],"target_prefix":"access-logs/"},"sensitive_values":{"target_grant":[],"target_object_key_format":[]}},{"address":"aws_s3_bucket_policy.access_logs_policy","mode":"managed","type":"aws_s3_bucket_policy","name":"access_logs_policy","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"region":"us-west-2"},"sensitive_values":{}},{"address":"aws_s3_bucket_policy.config_bucket_policy","mode":"managed","type":"aws_s3_bucket_policy","name":"config_bucket_policy","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"region":"us-west-2"},"sensitive_values":{}},{"address":"aws_s3_bucket_policy.secure_bucket_policy","mode":"managed","type":"aws_s3_bucket_policy","name":"secure_bucket_policy","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"region":"us-west-2"},"sensitive_values":{}},{"address":"aws_s3_bucket_public_access_block.access_logs_pab","mode":"managed","type":"aws_s3_bucket_public_access_block","name":"access_logs_pab","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"block_public_acls":true,"block_public_policy":true,"ignore_public_acls":true,"region":"us-west-2","restrict_public_buckets":true,"skip_destroy":null},"sensitive_values":{}},{"address":"aws_s3_bucket_public_access_block.config_bucket_pab","mode":"managed","type":"aws_s3_bucket_public_access_block","name":"config_bucket_pab","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"block_public_acls":true,"block_public_policy":true,"ignore_public_acls":true,"region":"us-west-2","restrict_public_buckets":true,"skip_destroy":null},"sensitive_values":{}},{"address":"aws_s3_bucket_public_access_block.secure_bucket_pab","mode":"managed","type":"aws_s3_bucket_public_access_block","name":"secure_bucket_pab","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"block_public_acls":true,"block_public_policy":true,"ignore_public_acls":true,"region":"us-west-2","restrict_public_buckets":true,"skip_destroy":null},"sensitive_values":{}},{"address":"aws_s3_bucket_server_side_encryption_configuration.access_logs_encryption","mode":"managed","type":"aws_s3_bucket_server_side_encryption_configuration","name":"access_logs_encryption","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"expected_bucket_owner":null,"region":"us-west-2","rule":[{"apply_server_side_encryption_by_default":[{"sse_algorithm":"aws:kms"}],"bucket_key_enabled":true}]},"sensitive_values":{"rule":[{"apply_server_side_encryption_by_default":[{}]}]}},{"address":"aws_s3_bucket_server_side_encryption_configuration.config_bucket_encryption","mode":"managed","type":"aws_s3_bucket_server_side_encryption_configuration","name":"config_bucket_encryption","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"expected_bucket_owner":null,"region":"us-west-2","rule":[{"apply_server_side_encryption_by_default":[{"sse_algorithm":"aws:kms"}],"bucket_key_enabled":true}]},"sensitive_values":{"rule":[{"apply_server_side_encryption_by_default":[{}]}]}},{"address":"aws_s3_bucket_server_side_encryption_configuration.secure_bucket_encryption","mode":"managed","type":"aws_s3_bucket_server_side_encryption_configuration","name":"secure_bucket_encryption","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"expected_bucket_owner":null,"region":"us-west-2","rule":[{"apply_server_side_encryption_by_default":[{"sse_algorithm":"aws:kms"}],"bucket_key_enabled":true}]},"sensitive_values":{"rule":[{"apply_server_side_encryption_by_default":[{}]}]}},{"address":"aws_s3_bucket_versioning.secure_bucket_versioning","mode":"managed","type":"aws_s3_bucket_versioning","name":"secure_bucket_versioning","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"expected_bucket_owner":null,"mfa":null,"region":"us-west-2","versioning_configuration":[{"status":"Enabled"}]},"sensitive_values":{"versioning_configuration":[{}]}},{"address":"aws_securityhub_account.main","mode":"managed","type":"aws_securityhub_account","name":"main","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":1,"values":{"auto_enable_controls":true,"enable_default_standards":true,"region":"us-west-2"},"sensitive_values":{}},{"address":"aws_securityhub_standards_subscription.aws_foundational","mode":"managed","type":"aws_securityhub_standards_subscription","name":"aws_foundational","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"region":"us-west-2","standards_arn":"arn:aws:securityhub:us-west-2::standards/aws-foundational-security-best-practices/v/1.0.0","timeouts":null},"sensitive_values":{}},{"address":"aws_securityhub_standards_subscription.cis","mode":"managed","type":"aws_securityhub_standards_subscription","name":"cis","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"region":"us-west-2","standards_arn":"arn:aws:securityhub:us-west-2::standards/cis-aws-foundations-benchmark/v/1.4.0","timeouts":null},"sensitive_values":{}},{"address":"aws_sfn_state_machine.security_workflow","mode":"managed","type":"aws_sfn_state_machine","name":"security_workflow","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"name":"718240086340-security-synthtrainr838-security-workflow","publish":false,"region":"us-west-2","tags":{"AccountId":"718240086340","Environment":"production","EnvironmentSuffix":"synthtrainr838","ManagedBy":"terraform","Project":"SecureInfrastructure"},"tags_all":{"AccountId":"718240086340","Environment":"production","EnvironmentSuffix":"synthtrainr838","ManagedBy":"terraform","Project":"SecureInfrastructure"},"timeouts":null,"type":"STANDARD"},"sensitive_values":{"encryption_configuration":[],"logging_configuration":[],"tags":{},"tags_all":{},"tracing_configuration":[]}},{"address":"aws_sns_topic.security_alerts","mode":"managed","type":"aws_sns_topic","name":"security_alerts","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"application_failure_feedback_role_arn":null,"application_success_feedback_role_arn":null,"application_success_feedback_sample_rate":null,"archive_policy":null,"content_based_deduplication":false,"delivery_policy":null,"display_name":null,"fifo_topic":false,"firehose_failure_feedback_role_arn":null,"firehose_success_feedback_role_arn":null,"firehose_success_feedback_sample_rate":null,"http_failure_feedback_role_arn":null,"http_success_feedback_role_arn":null,"http_success_feedback_sample_rate":null,"lambda_failure_feedback_role_arn":null,"lambda_success_feedback_role_arn":null,"lambda_success_feedback_sample_rate":null,"name":"718240086340-security-synthtrainr838-security-alerts","region":"us-west-2","sqs_failure_feedback_role_arn":null,"sqs_success_feedback_role_arn":null,"sqs_success_feedback_sample_rate":null,"tags":{"AccountId":"718240086340","Environment":"production","EnvironmentSuffix":"synthtrainr838","ManagedBy":"terraform","Project":"SecureInfrastructure"},"tags_all":{"AccountId":"718240086340","Environment":"production","EnvironmentSuffix":"synthtrainr838","ManagedBy":"terraform","Project":"SecureInfrastructure"}},"sensitive_values":{"tags":{},"tags_all":{}},"identity_schema_version":0,"identity":{"arn":null}},{"address":"aws_sns_topic_subscription.security_email","mode":"managed","type":"aws_sns_topic_subscription","name":"security_email","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"confirmation_timeout_in_minutes":1,"delivery_policy":null,"endpoint":"security-alerts@example.com","endpoint_auto_confirms":false,"filter_policy":null,"protocol":"email","raw_message_delivery":false,"redrive_policy":null,"region":"us-west-2","replay_policy":null,"subscription_role_arn":null},"sensitive_values":{}}]}},"resource_changes":[{"address":"aws_cloudwatch_log_group.security_logs","mode":"managed","type":"aws_cloudwatch_log_group","name":"security_logs","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"name":"/aws/security/718240086340-security-synthtrainr838","region":"us-west-2","retention_in_days":90,"skip_destroy":false,"tags":{"AccountId":"718240086340","Environment":"production","EnvironmentSuffix":"synthtrainr838","ManagedBy":"terraform","Project":"SecureInfrastructure"},"tags_all":{"AccountId":"718240086340","Environment":"production","EnvironmentSuffix":"synthtrainr838","ManagedBy":"terraform","Project":"SecureInfrastructure"}},"after_unknown":{"arn":true,"id":true,"kms_key_id":true,"log_group_class":true,"name_prefix":true,"tags":{},"tags_all":{}},"before_sensitive":false,"after_sensitive":{"tags":{},"tags_all":{}},"after_identity":{"account_id":null,"name":null,"region":null}}},{"address":"aws_cloudwatch_log_metric_filter.iam_actions","mode":"managed","type":"aws_cloudwatch_log_metric_filter","name":"iam_actions","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"log_group_name":"/aws/security/718240086340-security-synthtrainr838","metric_transformation":[{"default_value":null,"dimensions":null,"name":"IAMActions","namespace":"Security/IAM","unit":"None","value":"1"}],"name":"718240086340-security-synthtrainr838-iam-actions","pattern":"{ ($.eventName = CreateUser) || ($.eventName = DeleteUser) || ($.eventName = CreateRole) || ($.eventName = DeleteRole) || ($.eventName = AttachUserPolicy) || ($.eventName = DetachUserPolicy) }","region":"us-west-2"},"after_unknown":{"apply_on_transformed_logs":true,"id":true,"metric_transformation":[{}]},"before_sensitive":false,"after_sensitive":{"metric_transformation":[{}]}}},{"address":"aws_cloudwatch_metric_alarm.iam_actions_alarm","mode":"managed","type":"aws_cloudwatch_metric_alarm","name":"iam_actions_alarm","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"actions_enabled":true,"alarm_description":"This metric monitors IAM actions","alarm_name":"718240086340-security-synthtrainr838-iam-actions-alarm","comparison_operator":"GreaterThanOrEqualToThreshold","datapoints_to_alarm":null,"dimensions":null,"evaluation_periods":1,"extended_statistic":null,"insufficient_data_actions":null,"metric_name":"IAMActions","metric_query":[],"namespace":"Security/IAM","ok_actions":null,"period":300,"region":"us-west-2","statistic":"Sum","tags":{"AccountId":"718240086340","Environment":"production","EnvironmentSuffix":"synthtrainr838","ManagedBy":"terraform","Project":"SecureInfrastructure"},"tags_all":{"AccountId":"718240086340","Environment":"production","EnvironmentSuffix":"synthtrainr838","ManagedBy":"terraform","Project":"SecureInfrastructure"},"threshold":1,"threshold_metric_id":null,"treat_missing_data":"missing","unit":null},"after_unknown":{"alarm_actions":true,"arn":true,"evaluate_low_sample_count_percentiles":true,"id":true,"metric_query":[],"tags":{},"tags_all":{}},"before_sensitive":false,"after_sensitive":{"alarm_actions":[],"metric_query":[],"tags":{},"tags_all":{}}}},{"address":"aws_config_configuration_recorder.security_recorder","mode":"managed","type":"aws_config_configuration_recorder","name":"security_recorder","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"name":"718240086340-security-synthtrainr838-config-recorder","recording_group":[{"all_supported":true,"include_global_resource_types":true,"resource_types":null}],"region":"us-west-2"},"after_unknown":{"id":true,"recording_group":[{"exclusion_by_resource_types":true,"recording_strategy":true}],"recording_mode":true,"role_arn":true},"before_sensitive":false,"after_sensitive":{"recording_group":[{"exclusion_by_resource_types":[],"recording_strategy":[]}],"recording_mode":[]}}},{"address":"aws_config_configuration_recorder_status.security_recorder_status","mode":"managed","type":"aws_config_configuration_recorder_status","name":"security_recorder_status","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"is_enabled":true,"name":"718240086340-security-synthtrainr838-config-recorder","region":"us-west-2"},"after_unknown":{"id":true},"before_sensitive":false,"after_sensitive":{}}},{"address":"aws_config_delivery_channel.security_delivery_channel","mode":"managed","type":"aws_config_delivery_channel","name":"security_delivery_channel","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"name":"718240086340-security-synthtrainr838-config-delivery-channel","region":"us-west-2","s3_bucket_name":"718240086340-security-synthtrainr838-config-bucket","s3_key_prefix":"config","s3_kms_key_arn":null,"snapshot_delivery_properties":[],"sns_topic_arn":null},"after_unknown":{"id":true,"snapshot_delivery_properties":[]},"before_sensitive":false,"after_sensitive":{"snapshot_delivery_properties":[]}}},{"address":"aws_guardduty_detector.main","mode":"managed","type":"aws_guardduty_detector","name":"main","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"enable":true,"region":"us-west-2","tags":{"AccountId":"718240086340","Environment":"production","EnvironmentSuffix":"synthtrainr838","ManagedBy":"terraform","Project":"SecureInfrastructure"},"tags_all":{"AccountId":"718240086340","Environment":"production","EnvironmentSuffix":"synthtrainr838","ManagedBy":"terraform","Project":"SecureInfrastructure"}},"after_unknown":{"account_id":true,"arn":true,"datasources":true,"finding_publishing_frequency":true,"id":true,"tags":{},"tags_all":{}},"before_sensitive":false,"after_sensitive":{"datasources":[],"tags":{},"tags_all":{}}}},{"address":"aws_guardduty_detector_feature.eks_audit_logs","mode":"managed","type":"aws_guardduty_detector_feature","name":"eks_audit_logs","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"additional_configuration":[],"name":"EKS_AUDIT_LOGS","region":"us-west-2","status":"ENABLED"},"after_unknown":{"additional_configuration":[],"detector_id":true,"id":true},"before_sensitive":false,"after_sensitive":{"additional_configuration":[]}}},{"address":"aws_guardduty_detector_feature.malware_protection","mode":"managed","type":"aws_guardduty_detector_feature","name":"malware_protection","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"additional_configuration":[],"name":"EBS_MALWARE_PROTECTION","region":"us-west-2","status":"ENABLED"},"after_unknown":{"additional_configuration":[],"detector_id":true,"id":true},"before_sensitive":false,"after_sensitive":{"additional_configuration":[]}}},{"address":"aws_guardduty_detector_feature.s3_logs","mode":"managed","type":"aws_guardduty_detector_feature","name":"s3_logs","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"additional_configuration":[],"name":"S3_DATA_EVENTS","region":"us-west-2","status":"ENABLED"},"after_unknown":{"additional_configuration":[],"detector_id":true,"id":true},"before_sensitive":false,"after_sensitive":{"additional_configuration":[]}}},{"address":"aws_iam_role.config_role","mode":"managed","type":"aws_iam_role","name":"config_role","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"assume_role_policy":"{\"Statement\":[{\"Action\":\"sts:AssumeRole\",\"Effect\":\"Allow\",\"Principal\":{\"Service\":\"config.amazonaws.com\"}}],\"Version\":\"2012-10-17\"}","description":null,"force_detach_policies":false,"max_session_duration":3600,"name":"718240086340-security-synthtrainr838-config-role","path":"/","permissions_boundary":null,"tags":{"AccountId":"718240086340","Environment":"production","EnvironmentSuffix":"synthtrainr838","ManagedBy":"terraform","Project":"SecureInfrastructure"},"tags_all":{"AccountId":"718240086340","Environment":"production","EnvironmentSuffix":"synthtrainr838","ManagedBy":"terraform","Project":"SecureInfrastructure"}},"after_unknown":{"arn":true,"create_date":true,"id":true,"inline_policy":true,"managed_policy_arns":true,"name_prefix":true,"tags":{},"tags_all":{},"unique_id":true},"before_sensitive":false,"after_sensitive":{"inline_policy":[],"managed_policy_arns":[],"tags":{},"tags_all":{}},"after_identity":{"account_id":null,"name":null}}},{"address":"aws_iam_role.cross_account_role","mode":"managed","type":"aws_iam_role","name":"cross_account_role","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"assume_role_policy":"{\"Statement\":[{\"Action\":\"sts:AssumeRole\",\"Condition\":{\"StringEquals\":{\"sts:ExternalId\":\"718240086340-security-synthtrainr838-external-id\"}},\"Effect\":\"Allow\",\"Principal\":{\"AWS\":\"arn:aws:iam::718240086340:root\"}}],\"Version\":\"2012-10-17\"}","description":null,"force_detach_policies":false,"max_session_duration":3600,"name":"718240086340-security-synthtrainr838-cross-account-role","path":"/","permissions_boundary":null,"tags":{"AccountId":"718240086340","Environment":"production","EnvironmentSuffix":"synthtrainr838","ManagedBy":"terraform","Project":"SecureInfrastructure"},"tags_all":{"AccountId":"718240086340","Environment":"production","EnvironmentSuffix":"synthtrainr838","ManagedBy":"terraform","Project":"SecureInfrastructure"}},"after_unknown":{"arn":true,"create_date":true,"id":true,"inline_policy":true,"managed_policy_arns":true,"name_prefix":true,"tags":{},"tags_all":{},"unique_id":true},"before_sensitive":false,"after_sensitive":{"inline_policy":[],"managed_policy_arns":[],"tags":{},"tags_all":{}},"after_identity":{"account_id":null,"name":null}}},{"address":"aws_iam_role.lambda_execution_role","mode":"managed","type":"aws_iam_role","name":"lambda_execution_role","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"assume_role_policy":"{\"Statement\":[{\"Action\":\"sts:AssumeRole\",\"Effect\":\"Allow\",\"Principal\":{\"Service\":\"lambda.amazonaws.com\"}}],\"Version\":\"2012-10-17\"}","description":null,"force_detach_policies":false,"max_session_duration":3600,"name":"718240086340-security-synthtrainr838-lambda-execution-role","path":"/","permissions_boundary":null,"tags":{"AccountId":"718240086340","Environment":"production","EnvironmentSuffix":"synthtrainr838","ManagedBy":"terraform","Project":"SecureInfrastructure"},"tags_all":{"AccountId":"718240086340","Environment":"production","EnvironmentSuffix":"synthtrainr838","ManagedBy":"terraform","Project":"SecureInfrastructure"}},"after_unknown":{"arn":true,"create_date":true,"id":true,"inline_policy":true,"managed_policy_arns":true,"name_prefix":true,"tags":{},"tags_all":{},"unique_id":true},"before_sensitive":false,"after_sensitive":{"inline_policy":[],"managed_policy_arns":[],"tags":{},"tags_all":{}},"after_identity":{"account_id":null,"name":null}}},{"address":"aws_iam_role.security_monitoring_role","mode":"managed","type":"aws_iam_role","name":"security_monitoring_role","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"assume_role_policy":"{\"Statement\":[{\"Action\":\"sts:AssumeRole\",\"Effect\":\"Allow\",\"Principal\":{\"Service\":[\"lambda.amazonaws.com\",\"config.amazonaws.com\"]}}],\"Version\":\"2012-10-17\"}","description":null,"force_detach_policies":false,"max_session_duration":3600,"name":"718240086340-security-synthtrainr838-monitoring-role","path":"/","permissions_boundary":null,"tags":{"AccountId":"718240086340","Environment":"production","EnvironmentSuffix":"synthtrainr838","ManagedBy":"terraform","Project":"SecureInfrastructure"},"tags_all":{"AccountId":"718240086340","Environment":"production","EnvironmentSuffix":"synthtrainr838","ManagedBy":"terraform","Project":"SecureInfrastructure"}},"after_unknown":{"arn":true,"create_date":true,"id":true,"inline_policy":true,"managed_policy_arns":true,"name_prefix":true,"tags":{},"tags_all":{},"unique_id":true},"before_sensitive":false,"after_sensitive":{"inline_policy":[],"managed_policy_arns":[],"tags":{},"tags_all":{}},"after_identity":{"account_id":null,"name":null}}},{"address":"aws_iam_role.step_function_role","mode":"managed","type":"aws_iam_role","name":"step_function_role","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"assume_role_policy":"{\"Statement\":[{\"Action\":\"sts:AssumeRole\",\"Effect\":\"Allow\",\"Principal\":{\"Service\":\"states.amazonaws.com\"}}],\"Version\":\"2012-10-17\"}","description":null,"force_detach_policies":false,"max_session_duration":3600,"name":"718240086340-security-synthtrainr838-step-function-role","path":"/","permissions_boundary":null,"tags":{"AccountId":"718240086340","Environment":"production","EnvironmentSuffix":"synthtrainr838","ManagedBy":"terraform","Project":"SecureInfrastructure"},"tags_all":{"AccountId":"718240086340","Environment":"production","EnvironmentSuffix":"synthtrainr838","ManagedBy":"terraform","Project":"SecureInfrastructure"}},"after_unknown":{"arn":true,"create_date":true,"id":true,"inline_policy":true,"managed_policy_arns":true,"name_prefix":true,"tags":{},"tags_all":{},"unique_id":true},"before_sensitive":false,"after_sensitive":{"inline_policy":[],"managed_policy_arns":[],"tags":{},"tags_all":{}},"after_identity":{"account_id":null,"name":null}}},{"address":"aws_iam_role_policy.config_s3_policy","mode":"managed","type":"aws_iam_role_policy","name":"config_s3_policy","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"name":"718240086340-security-synthtrainr838-config-s3-policy"},"after_unknown":{"id":true,"name_prefix":true,"policy":true,"role":true},"before_sensitive":false,"after_sensitive":{},"after_identity":{"account_id":null,"name":null,"role":null}}},{"address":"aws_iam_role_policy.cross_account_policy","mode":"managed","type":"aws_iam_role_policy","name":"cross_account_policy","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"name":"718240086340-security-synthtrainr838-cross-account-policy"},"after_unknown":{"id":true,"name_prefix":true,"policy":true,"role":true},"before_sensitive":false,"after_sensitive":{},"after_identity":{"account_id":null,"name":null,"role":null}}},{"address":"aws_iam_role_policy.lambda_execution_policy","mode":"managed","type":"aws_iam_role_policy","name":"lambda_execution_policy","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"name":"718240086340-security-synthtrainr838-lambda-execution-policy","policy":"{\"Version\":\"2012-10-17\",\"Statement\":[{\"Action\":[\"logs:CreateLogGroup\",\"logs:CreateLogStream\",\"logs:PutLogEvents\",\"sns:Publish\",\"iam:ListUsers\",\"iam:GetUser\",\"iam:PutUserPolicy\",\"iam:DeleteUserPolicy\",\"kms:Encrypt\",\"kms:Decrypt\",\"kms:GenerateDataKey\"],\"Effect\":\"Allow\",\"Resource\":\"*\"}]}"},"after_unknown":{"id":true,"name_prefix":true,"role":true},"before_sensitive":false,"after_sensitive":{},"after_identity":{"account_id":null,"name":null,"role":null}}},{"address":"aws_iam_role_policy.security_monitoring_policy","mode":"managed","type":"aws_iam_role_policy","name":"security_monitoring_policy","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"name":"718240086340-security-synthtrainr838-monitoring-policy","policy":"{\"Version\":\"2012-10-17\",\"Statement\":[{\"Action\":[\"logs:CreateLogGroup\",\"logs:CreateLogStream\",\"logs:PutLogEvents\",\"sns:Publish\",\"cloudwatch:PutMetricData\",\"config:PutEvaluations\",\"iam:ListUsers\",\"iam:GetUser\",\"iam:ListAccessKeys\",\"securityhub:BatchImportFindings\",\"guardduty:GetFindings\"],\"Effect\":\"Allow\",\"Resource\":\"*\"}]}"},"after_unknown":{"id":true,"name_prefix":true,"role":true},"before_sensitive":false,"after_sensitive":{},"after_identity":{"account_id":null,"name":null,"role":null}}},{"address":"aws_iam_role_policy.step_function_policy","mode":"managed","type":"aws_iam_role_policy","name":"step_function_policy","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"name":"718240086340-security-synthtrainr838-step-function-policy"},"after_unknown":{"id":true,"name_prefix":true,"policy":true,"role":true},"before_sensitive":false,"after_sensitive":{},"after_identity":{"account_id":null,"name":null,"role":null}}},{"address":"aws_iam_role_policy_attachment.config_policy","mode":"managed","type":"aws_iam_role_policy_attachment","name":"config_policy","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"policy_arn":"arn:aws:iam::aws:policy/service-role/AWS_ConfigRole","role":"718240086340-security-synthtrainr838-config-role"},"after_unknown":{"id":true},"before_sensitive":false,"after_sensitive":{},"after_identity":{"account_id":null,"policy_arn":null,"role":null}}},{"address":"aws_kms_alias.security_key_alias","mode":"managed","type":"aws_kms_alias","name":"security_key_alias","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"name":"alias/718240086340-security-synthtrainr838-key","region":"us-west-2"},"after_unknown":{"arn":true,"id":true,"name_prefix":true,"target_key_arn":true,"target_key_id":true},"before_sensitive":false,"after_sensitive":{}}},{"address":"aws_kms_key.security_key","mode":"managed","type":"aws_kms_key","name":"security_key","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"bypass_policy_lockout_safety_check":false,"custom_key_store_id":null,"customer_master_key_spec":"SYMMETRIC_DEFAULT","deletion_window_in_days":7,"description":"KMS key for encrypting sensitive data","enable_key_rotation":true,"is_enabled":true,"key_usage":"ENCRYPT_DECRYPT","policy":"{\"Statement\":[{\"Action\":\"kms:*\",\"Effect\":\"Allow\",\"Principal\":{\"AWS\":\"arn:aws:iam::718240086340:root\"},\"Resource\":\"*\",\"Sid\":\"Enable IAM User Permissions\"},{\"Action\":[\"kms:Encrypt\",\"kms:Decrypt\",\"kms:ReEncrypt*\",\"kms:GenerateDataKey*\",\"kms:CreateGrant\",\"kms:DescribeKey\"],\"Condition\":{\"ArnLike\":{\"kms:EncryptionContext:aws:logs:arn\":\"arn:aws:logs:us-west-2:718240086340:log-group:*\"}},\"Effect\":\"Allow\",\"Principal\":{\"Service\":\"logs.us-west-2.amazonaws.com\"},\"Resource\":\"*\",\"Sid\":\"Allow CloudWatch Logs\"}],\"Version\":\"2012-10-17\"}","region":"us-west-2","tags":{"AccountId":"718240086340","Environment":"production","EnvironmentSuffix":"synthtrainr838","ManagedBy":"terraform","Project":"SecureInfrastructure"},"tags_all":{"AccountId":"718240086340","Environment":"production","EnvironmentSuffix":"synthtrainr838","ManagedBy":"terraform","Project":"SecureInfrastructure"},"timeouts":null,"xks_key_id":null},"after_unknown":{"arn":true,"id":true,"key_id":true,"multi_region":true,"rotation_period_in_days":true,"tags":{},"tags_all":{}},"before_sensitive":false,"after_sensitive":{"tags":{},"tags_all":{}}}},{"address":"aws_lambda_function.security_response","mode":"managed","type":"aws_lambda_function","name":"security_response","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"code_signing_config_arn":null,"dead_letter_config":[],"description":null,"environment":[{}],"file_system_config":[],"filename":"security_response.zip","function_name":"718240086340-security-synthtrainr838-security-response","handler":"index.handler","image_config":[],"image_uri":null,"kms_key_arn":null,"layers":null,"memory_size":128,"package_type":"Zip","publish":false,"region":"us-west-2","replace_security_groups_on_destroy":null,"replacement_security_group_ids":null,"reserved_concurrent_executions":-1,"runtime":"python3.9","s3_bucket":null,"s3_key":null,"s3_object_version":null,"skip_destroy":false,"snap_start":[],"tags":{"AccountId":"718240086340","Environment":"production","EnvironmentSuffix":"synthtrainr838","ManagedBy":"terraform","Project":"SecureInfrastructure"},"tags_all":{"AccountId":"718240086340","Environment":"production","EnvironmentSuffix":"synthtrainr838","ManagedBy":"terraform","Project":"SecureInfrastructure"},"timeout":300,"timeouts":null,"vpc_config":[]},"after_unknown":{"architectures":true,"arn":true,"code_sha256":true,"dead_letter_config":[],"environment":[{"variables":true}],"ephemeral_storage":true,"file_system_config":[],"id":true,"image_config":[],"invoke_arn":true,"last_modified":true,"logging_config":true,"qualified_arn":true,"qualified_invoke_arn":true,"role":true,"signing_job_arn":true,"signing_profile_version_arn":true,"snap_start":[],"source_code_hash":true,"source_code_size":true,"tags":{},"tags_all":{},"tracing_config":true,"version":true,"vpc_config":[]},"before_sensitive":false,"after_sensitive":{"architectures":[],"dead_letter_config":[],"environment":[{"variables":{}}],"ephemeral_storage":[],"file_system_config":[],"image_config":[],"logging_config":[],"snap_start":[],"tags":{},"tags_all":{},"tracing_config":[],"vpc_config":[]}}},{"address":"aws_s3_bucket.access_logs","mode":"managed","type":"aws_s3_bucket","name":"access_logs","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"bucket":"718240086340-security-synthtrainr838-access-logs","force_destroy":true,"region":"us-west-2","tags":{"AccountId":"718240086340","Environment":"production","EnvironmentSuffix":"synthtrainr838","ManagedBy":"terraform","Project":"SecureInfrastructure"},"tags_all":{"AccountId":"718240086340","Environment":"production","EnvironmentSuffix":"synthtrainr838","ManagedBy":"terraform","Project":"SecureInfrastructure"},"timeouts":null},"after_unknown":{"acceleration_status":true,"acl":true,"arn":true,"bucket_domain_name":true,"bucket_prefix":true,"bucket_region":true,"bucket_regional_domain_name":true,"cors_rule":true,"grant":true,"hosted_zone_id":true,"id":true,"lifecycle_rule":true,"logging":true,"object_lock_configuration":true,"object_lock_enabled":true,"policy":true,"replication_configuration":true,"request_payer":true,"server_side_encryption_configuration":true,"tags":{},"tags_all":{},"versioning":true,"website":true,"website_domain":true,"website_endpoint":true},"before_sensitive":false,"after_sensitive":{"cors_rule":[],"grant":[],"lifecycle_rule":[],"logging":[],"object_lock_configuration":[],"replication_configuration":[],"server_side_encryption_configuration":[],"tags":{},"tags_all":{},"versioning":[],"website":[]},"after_identity":{"account_id":null,"bucket":null,"region":null}}},{"address":"aws_s3_bucket.config_bucket","mode":"managed","type":"aws_s3_bucket","name":"config_bucket","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"bucket":"718240086340-security-synthtrainr838-config-bucket","force_destroy":true,"region":"us-west-2","tags":{"AccountId":"718240086340","Environment":"production","EnvironmentSuffix":"synthtrainr838","ManagedBy":"terraform","Project":"SecureInfrastructure"},"tags_all":{"AccountId":"718240086340","Environment":"production","EnvironmentSuffix":"synthtrainr838","ManagedBy":"terraform","Project":"SecureInfrastructure"},"timeouts":null},"after_unknown":{"acceleration_status":true,"acl":true,"arn":true,"bucket_domain_name":true,"bucket_prefix":true,"bucket_region":true,"bucket_regional_domain_name":true,"cors_rule":true,"grant":true,"hosted_zone_id":true,"id":true,"lifecycle_rule":true,"logging":true,"object_lock_configuration":true,"object_lock_enabled":true,"policy":true,"replication_configuration":true,"request_payer":true,"server_side_encryption_configuration":true,"tags":{},"tags_all":{},"versioning":true,"website":true,"website_domain":true,"website_endpoint":true},"before_sensitive":false,"after_sensitive":{"cors_rule":[],"grant":[],"lifecycle_rule":[],"logging":[],"object_lock_configuration":[],"replication_configuration":[],"server_side_encryption_configuration":[],"tags":{},"tags_all":{},"versioning":[],"website":[]},"after_identity":{"account_id":null,"bucket":null,"region":null}}},{"address":"aws_s3_bucket.secure_bucket","mode":"managed","type":"aws_s3_bucket","name":"secure_bucket","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"bucket":"718240086340-security-synthtrainr838-secure-data","force_destroy":true,"region":"us-west-2","tags":{"AccountId":"718240086340","Environment":"production","EnvironmentSuffix":"synthtrainr838","ManagedBy":"terraform","Project":"SecureInfrastructure"},"tags_all":{"AccountId":"718240086340","Environment":"production","EnvironmentSuffix":"synthtrainr838","ManagedBy":"terraform","Project":"SecureInfrastructure"},"timeouts":null},"after_unknown":{"acceleration_status":true,"acl":true,"arn":true,"bucket_domain_name":true,"bucket_prefix":true,"bucket_region":true,"bucket_regional_domain_name":true,"cors_rule":true,"grant":true,"hosted_zone_id":true,"id":true,"lifecycle_rule":true,"logging":true,"object_lock_configuration":true,"object_lock_enabled":true,"policy":true,"replication_configuration":true,"request_payer":true,"server_side_encryption_configuration":true,"tags":{},"tags_all":{},"versioning":true,"website":true,"website_domain":true,"website_endpoint":true},"before_sensitive":false,"after_sensitive":{"cors_rule":[],"grant":[],"lifecycle_rule":[],"logging":[],"object_lock_configuration":[],"replication_configuration":[],"server_side_encryption_configuration":[],"tags":{},"tags_all":{},"versioning":[],"website":[]},"after_identity":{"account_id":null,"bucket":null,"region":null}}},{"address":"aws_s3_bucket_logging.secure_bucket_logging","mode":"managed","type":"aws_s3_bucket_logging","name":"secure_bucket_logging","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"expected_bucket_owner":null,"region":"us-west-2","target_grant":[],"target_object_key_format":[],"target_prefix":"access-logs/"},"after_unknown":{"bucket":true,"id":true,"target_bucket":true,"target_grant":[],"target_object_key_format":[]},"before_sensitive":false,"after_sensitive":{"target_grant":[],"target_object_key_format":[]}}},{"address":"aws_s3_bucket_policy.access_logs_policy","mode":"managed","type":"aws_s3_bucket_policy","name":"access_logs_policy","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"region":"us-west-2"},"after_unknown":{"bucket":true,"id":true,"policy":true},"before_sensitive":false,"after_sensitive":{}}},{"address":"aws_s3_bucket_policy.config_bucket_policy","mode":"managed","type":"aws_s3_bucket_policy","name":"config_bucket_policy","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"region":"us-west-2"},"after_unknown":{"bucket":true,"id":true,"policy":true},"before_sensitive":false,"after_sensitive":{}}},{"address":"aws_s3_bucket_policy.secure_bucket_policy","mode":"managed","type":"aws_s3_bucket_policy","name":"secure_bucket_policy","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"region":"us-west-2"},"after_unknown":{"bucket":true,"id":true,"policy":true},"before_sensitive":false,"after_sensitive":{}}},{"address":"aws_s3_bucket_public_access_block.access_logs_pab","mode":"managed","type":"aws_s3_bucket_public_access_block","name":"access_logs_pab","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"block_public_acls":true,"block_public_policy":true,"ignore_public_acls":true,"region":"us-west-2","restrict_public_buckets":true,"skip_destroy":null},"after_unknown":{"bucket":true,"id":true},"before_sensitive":false,"after_sensitive":{}}},{"address":"aws_s3_bucket_public_access_block.config_bucket_pab","mode":"managed","type":"aws_s3_bucket_public_access_block","name":"config_bucket_pab","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"block_public_acls":true,"block_public_policy":true,"ignore_public_acls":true,"region":"us-west-2","restrict_public_buckets":true,"skip_destroy":null},"after_unknown":{"bucket":true,"id":true},"before_sensitive":false,"after_sensitive":{}}},{"address":"aws_s3_bucket_public_access_block.secure_bucket_pab","mode":"managed","type":"aws_s3_bucket_public_access_block","name":"secure_bucket_pab","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"block_public_acls":true,"block_public_policy":true,"ignore_public_acls":true,"region":"us-west-2","restrict_public_buckets":true,"skip_destroy":null},"after_unknown":{"bucket":true,"id":true},"before_sensitive":false,"after_sensitive":{}}},{"address":"aws_s3_bucket_server_side_encryption_configuration.access_logs_encryption","mode":"managed","type":"aws_s3_bucket_server_side_encryption_configuration","name":"access_logs_encryption","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"expected_bucket_owner":null,"region":"us-west-2","rule":[{"apply_server_side_encryption_by_default":[{"sse_algorithm":"aws:kms"}],"bucket_key_enabled":true}]},"after_unknown":{"bucket":true,"id":true,"rule":[{"apply_server_side_encryption_by_default":[{"kms_master_key_id":true}]}]},"before_sensitive":false,"after_sensitive":{"rule":[{"apply_server_side_encryption_by_default":[{}]}]}}},{"address":"aws_s3_bucket_server_side_encryption_configuration.config_bucket_encryption","mode":"managed","type":"aws_s3_bucket_server_side_encryption_configuration","name":"config_bucket_encryption","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"expected_bucket_owner":null,"region":"us-west-2","rule":[{"apply_server_side_encryption_by_default":[{"sse_algorithm":"aws:kms"}],"bucket_key_enabled":true}]},"after_unknown":{"bucket":true,"id":true,"rule":[{"apply_server_side_encryption_by_default":[{"kms_master_key_id":true}]}]},"before_sensitive":false,"after_sensitive":{"rule":[{"apply_server_side_encryption_by_default":[{}]}]}}},{"address":"aws_s3_bucket_server_side_encryption_configuration.secure_bucket_encryption","mode":"managed","type":"aws_s3_bucket_server_side_encryption_configuration","name":"secure_bucket_encryption","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"expected_bucket_owner":null,"region":"us-west-2","rule":[{"apply_server_side_encryption_by_default":[{"sse_algorithm":"aws:kms"}],"bucket_key_enabled":true}]},"after_unknown":{"bucket":true,"id":true,"rule":[{"apply_server_side_encryption_by_default":[{"kms_master_key_id":true}]}]},"before_sensitive":false,"after_sensitive":{"rule":[{"apply_server_side_encryption_by_default":[{}]}]}}},{"address":"aws_s3_bucket_versioning.secure_bucket_versioning","mode":"managed","type":"aws_s3_bucket_versioning","name":"secure_bucket_versioning","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"expected_bucket_owner":null,"mfa":null,"region":"us-west-2","versioning_configuration":[{"status":"Enabled"}]},"after_unknown":{"bucket":true,"id":true,"versioning_configuration":[{"mfa_delete":true}]},"before_sensitive":false,"after_sensitive":{"versioning_configuration":[{}]}}},{"address":"aws_securityhub_account.main","mode":"managed","type":"aws_securityhub_account","name":"main","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"auto_enable_controls":true,"enable_default_standards":true,"region":"us-west-2"},"after_unknown":{"arn":true,"control_finding_generator":true,"id":true},"before_sensitive":false,"after_sensitive":{}}},{"address":"aws_securityhub_standards_subscription.aws_foundational","mode":"managed","type":"aws_securityhub_standards_subscription","name":"aws_foundational","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"region":"us-west-2","standards_arn":"arn:aws:securityhub:us-west-2::standards/aws-foundational-security-best-practices/v/1.0.0","timeouts":null},"after_unknown":{"id":true},"before_sensitive":false,"after_sensitive":{}}},{"address":"aws_securityhub_standards_subscription.cis","mode":"managed","type":"aws_securityhub_standards_subscription","name":"cis","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"region":"us-west-2","standards_arn":"arn:aws:securityhub:us-west-2::standards/cis-aws-foundations-benchmark/v/1.4.0","timeouts":null},"after_unknown":{"id":true},"before_sensitive":false,"after_sensitive":{}}},{"address":"aws_sfn_state_machine.security_workflow","mode":"managed","type":"aws_sfn_state_machine","name":"security_workflow","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"name":"718240086340-security-synthtrainr838-security-workflow","publish":false,"region":"us-west-2","tags":{"AccountId":"718240086340","Environment":"production","EnvironmentSuffix":"synthtrainr838","ManagedBy":"terraform","Project":"SecureInfrastructure"},"tags_all":{"AccountId":"718240086340","Environment":"production","EnvironmentSuffix":"synthtrainr838","ManagedBy":"terraform","Project":"SecureInfrastructure"},"timeouts":null,"type":"STANDARD"},"after_unknown":{"arn":true,"creation_date":true,"definition":true,"description":true,"encryption_configuration":true,"id":true,"logging_configuration":true,"name_prefix":true,"revision_id":true,"role_arn":true,"state_machine_version_arn":true,"status":true,"tags":{},"tags_all":{},"tracing_configuration":true,"version_description":true},"before_sensitive":false,"after_sensitive":{"encryption_configuration":[],"logging_configuration":[],"tags":{},"tags_all":{},"tracing_configuration":[]}}},{"address":"aws_sns_topic.security_alerts","mode":"managed","type":"aws_sns_topic","name":"security_alerts","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"application_failure_feedback_role_arn":null,"application_success_feedback_role_arn":null,"application_success_feedback_sample_rate":null,"archive_policy":null,"content_based_deduplication":false,"delivery_policy":null,"display_name":null,"fifo_topic":false,"firehose_failure_feedback_role_arn":null,"firehose_success_feedback_role_arn":null,"firehose_success_feedback_sample_rate":null,"http_failure_feedback_role_arn":null,"http_success_feedback_role_arn":null,"http_success_feedback_sample_rate":null,"lambda_failure_feedback_role_arn":null,"lambda_success_feedback_role_arn":null,"lambda_success_feedback_sample_rate":null,"name":"718240086340-security-synthtrainr838-security-alerts","region":"us-west-2","sqs_failure_feedback_role_arn":null,"sqs_success_feedback_role_arn":null,"sqs_success_feedback_sample_rate":null,"tags":{"AccountId":"718240086340","Environment":"production","EnvironmentSuffix":"synthtrainr838","ManagedBy":"terraform","Project":"SecureInfrastructure"},"tags_all":{"AccountId":"718240086340","Environment":"production","EnvironmentSuffix":"synthtrainr838","ManagedBy":"terraform","Project":"SecureInfrastructure"}},"after_unknown":{"arn":true,"beginning_archive_time":true,"fifo_throughput_scope":true,"id":true,"kms_master_key_id":true,"name_prefix":true,"owner":true,"policy":true,"signature_version":true,"tags":{},"tags_all":{},"tracing_config":true},"before_sensitive":false,"after_sensitive":{"tags":{},"tags_all":{}},"after_identity":{"arn":null}}},{"address":"aws_sns_topic_subscription.security_email","mode":"managed","type":"aws_sns_topic_subscription","name":"security_email","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"confirmation_timeout_in_minutes":1,"delivery_policy":null,"endpoint":"security-alerts@example.com","endpoint_auto_confirms":false,"filter_policy":null,"protocol":"email","raw_message_delivery":false,"redrive_policy":null,"region":"us-west-2","replay_policy":null,"subscription_role_arn":null},"after_unknown":{"arn":true,"confirmation_was_authenticated":true,"filter_policy_scope":true,"id":true,"owner_id":true,"pending_confirmation":true,"topic_arn":true},"before_sensitive":false,"after_sensitive":{}}}],"output_changes":{"access_logs_bucket_name":{"actions":["create"],"before":null,"after":"718240086340-security-synthtrainr838-access-logs","after_unknown":false,"before_sensitive":false,"after_sensitive":false},"cloudwatch_log_group_name":{"actions":["create"],"before":null,"after":"/aws/security/718240086340-security-synthtrainr838","after_unknown":false,"before_sensitive":false,"after_sensitive":false},"config_bucket_name":{"actions":["create"],"before":null,"after":"718240086340-security-synthtrainr838-config-bucket","after_unknown":false,"before_sensitive":false,"after_sensitive":false},"cross_account_role_arn":{"actions":["create"],"before":null,"after_unknown":true,"before_sensitive":false,"after_sensitive":false},"guardduty_detector_id":{"actions":["create"],"before":null,"after_unknown":true,"before_sensitive":false,"after_sensitive":false},"kms_key_arn":{"actions":["create"],"before":null,"after_unknown":true,"before_sensitive":false,"after_sensitive":false},"kms_key_id":{"actions":["create"],"before":null,"after_unknown":true,"before_sensitive":false,"after_sensitive":false},"lambda_function_arn":{"actions":["create"],"before":null,"after_unknown":true,"before_sensitive":false,"after_sensitive":false},"lambda_function_name":{"actions":["create"],"before":null,"after":"718240086340-security-synthtrainr838-security-response","after_unknown":false,"before_sensitive":false,"after_sensitive":false},"secure_bucket_arn":{"actions":["create"],"before":null,"after_unknown":true,"before_sensitive":false,"after_sensitive":false},"secure_bucket_name":{"actions":["create"],"before":null,"after":"718240086340-security-synthtrainr838-secure-data","after_unknown":false,"before_sensitive":false,"after_sensitive":false},"security_hub_account_id":{"actions":["create"],"before":null,"after_unknown":true,"before_sensitive":false,"after_sensitive":false},"security_monitoring_role_arn":{"actions":["create"],"before":null,"after_unknown":true,"before_sensitive":false,"after_sensitive":false},"sns_topic_arn":{"actions":["create"],"before":null,"after_unknown":true,"before_sensitive":false,"after_sensitive":false},"step_function_arn":{"actions":["create"],"before":null,"after_unknown":true,"before_sensitive":false,"after_sensitive":false}},"prior_state":{"format_version":"1.0","terraform_version":"1.12.2","values":{"outputs":{"access_logs_bucket_name":{"sensitive":false,"value":"718240086340-security-synthtrainr838-access-logs","type":"string"},"cloudwatch_log_group_name":{"sensitive":false,"value":"/aws/security/718240086340-security-synthtrainr838","type":"string"},"config_bucket_name":{"sensitive":false,"value":"718240086340-security-synthtrainr838-config-bucket","type":"string"},"lambda_function_name":{"sensitive":false,"value":"718240086340-security-synthtrainr838-security-response","type":"string"},"secure_bucket_name":{"sensitive":false,"value":"718240086340-security-synthtrainr838-secure-data","type":"string"}},"root_module":{"resources":[{"address":"data.archive_file.security_response_zip","mode":"data","type":"archive_file","name":"security_response_zip","provider_name":"registry.terraform.io/hashicorp/archive","schema_version":0,"values":{"exclude_symlink_directories":null,"excludes":null,"id":"7c25b24090573a49352ae3027413c42a7e7dacf9","output_base64sha256":"W4ZZon5s0Uj4uduWP9uBXm5+qBzmjdEG49UoyTPyLl0=","output_base64sha512":"n/uDqtFpzR55LntQTG64sKEehqW6RQKK3BgnFVaSZ+EdA2GuH9oBhMHSBO2ze+c8nkDp+DNNrONBgvPwl92Mvg==","output_file_mode":null,"output_md5":"43373fd553c475808ec4173bf5976fac","output_path":"security_response.zip","output_sha":"7c25b24090573a49352ae3027413c42a7e7dacf9","output_sha256":"5b8659a27e6cd148f8b9db963fdb815e6e7ea81ce68dd106e3d528c933f22e5d","output_sha512":"9ffb83aad169cd1e792e7b504c6eb8b0a11e86a5ba45028adc182715569267e11d0361ae1fda0184c1d204edb37be73c9e40e9f8334dace34182f3f097dd8cbe","output_size":441,"source":[{"content":"import json\r\nimport boto3\r\nimport os\r\n\r\ndef handler(event, context):\r\n    sns = boto3.client('sns')\r\n    \r\n    # Process security event\r\n    print(f\"Processing security event: {json.dumps(event)}\")\r\n    \r\n    # Send notification\r\n    sns.publish(\r\n        TopicArn=os.environ['SNS_TOPIC_ARN'],\r\n        Subject='Security Alert: Unauthorized Access Attempt',\r\n        Message=f'Security event detected: {json.dumps(event)}'\r\n    )\r\n    \r\n    return {\r\n        'statusCode': 200,\r\n        'body': json.dumps('Security response completed')\r\n    }\r\n","filename":"index.py"}],"source_content":null,"source_content_filename":null,"source_dir":null,"source_file":null,"type":"zip"},"sensitive_values":{"source":[{}]}},{"address":"data.aws_caller_identity.current","mode":"data","type":"aws_caller_identity","name":"current","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"account_id":"718240086340","arn":"arn:aws:iam::718240086340:user/arpit.p","id":"718240086340","user_id":"AIDA2OOTR7FCIWEAYDUAY"},"sensitive_values":{}},{"address":"data.aws_region.current","mode":"data","type":"aws_region","name":"current","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"description":"US West (Oregon)","endpoint":"ec2.us-west-2.amazonaws.com","id":"us-west-2","name":"us-west-2","region":"us-west-2"},"sensitive_values":{}}]}}},"configuration":{"provider_config":{"archive":{"name":"archive","full_name":"registry.terraform.io/hashicorp/archive","version_constraint":"\u003e= 2.0.0"},"aws":{"name":"aws","full_name":"registry.terraform.io/hashicorp/aws","version_constraint":"\u003e= 5.0.0","expressions":{"default_tags":[{"tags":{"references":["var.environment","var.project_name"]}}],"region":{"references":["var.aws_region"]}}}},"root_module":{"outputs":{"access_logs_bucket_name":{"expression":{"references":["aws_s3_bucket.access_logs.bucket","aws_s3_bucket.access_logs"]},"description":"Name of the access logs bucket"},"cloudwatch_log_group_name":{"expression":{"references":["aws_cloudwatch_log_group.security_logs.name","aws_cloudwatch_log_group.security_logs"]},"description":"CloudWatch log group name for security logs"},"config_bucket_name":{"expression":{"references":["aws_s3_bucket.config_bucket.bucket","aws_s3_bucket.config_bucket"]},"description":"Name of the AWS Config bucket"},"cross_account_role_arn":{"expression":{"references":["aws_iam_role.cross_account_role.arn","aws_iam_role.cross_account_role"]},"description":"ARN of the cross-account access IAM role"},"guardduty_detector_id":{"expression":{"references":["aws_guardduty_detector.main.id","aws_guardduty_detector.main"]},"description":"GuardDuty detector ID"},"kms_key_arn":{"expression":{"references":["aws_kms_key.security_key.arn","aws_kms_key.security_key"]},"description":"KMS key ARN for encryption"},"kms_key_id":{"expression":{"references":["aws_kms_key.security_key.key_id","aws_kms_key.security_key"]},"description":"KMS key ID for encryption"},"lambda_function_arn":{"expression":{"references":["aws_lambda_function.security_response.arn","aws_lambda_function.security_response"]},"description":"ARN of the security response Lambda function"},"lambda_function_name":{"expression":{"references":["aws_lambda_function.security_response.function_name","aws_lambda_function.security_response"]},"description":"Name of the security response Lambda function"},"secure_bucket_arn":{"expression":{"references":["aws_s3_bucket.secure_bucket.arn","aws_s3_bucket.secure_bucket"]},"description":"ARN of the secure S3 bucket"},"secure_bucket_name":{"expression":{"references":["aws_s3_bucket.secure_bucket.bucket","aws_s3_bucket.secure_bucket"]},"description":"Name of the secure S3 bucket"},"security_hub_account_id":{"expression":{"references":["aws_securityhub_account.main.id","aws_securityhub_account.main"]},"description":"Security Hub account ID"},"security_monitoring_role_arn":{"expression":{"references":["aws_iam_role.security_monitoring_role.arn","aws_iam_role.security_monitoring_role"]},"description":"ARN of the security monitoring IAM role"},"sns_topic_arn":{"expression":{"references":["aws_sns_topic.security_alerts.arn","aws_sns_topic.security_alerts"]},"description":"SNS topic ARN for security alerts"},"step_function_arn":{"expression":{"references":["aws_sfn_state_machine.security_workflow.arn","aws_sfn_state_machine.security_workflow"]},"description":"ARN of the security workflow Step Function"}},"resources":[{"address":"aws_cloudwatch_log_group.security_logs","mode":"managed","type":"aws_cloudwatch_log_group","name":"security_logs","provider_config_key":"aws","expressions":{"kms_key_id":{"references":["aws_kms_key.security_key.arn","aws_kms_key.security_key"]},"name":{"references":["local.name_prefix"]},"retention_in_days":{"constant_value":90},"tags":{"references":["local.common_tags"]}},"schema_version":0},{"address":"aws_cloudwatch_log_metric_filter.iam_actions","mode":"managed","type":"aws_cloudwatch_log_metric_filter","name":"iam_actions","provider_config_key":"aws","expressions":{"log_group_name":{"references":["aws_cloudwatch_log_group.security_logs.name","aws_cloudwatch_log_group.security_logs"]},"metric_transformation":[{"name":{"constant_value":"IAMActions"},"namespace":{"constant_value":"Security/IAM"},"value":{"constant_value":"1"}}],"name":{"references":["local.name_prefix"]},"pattern":{"constant_value":"{ ($.eventName = CreateUser) || ($.eventName = DeleteUser) || ($.eventName = CreateRole) || ($.eventName = DeleteRole) || ($.eventName = AttachUserPolicy) || ($.eventName = DetachUserPolicy) }"}},"schema_version":0},{"address":"aws_cloudwatch_metric_alarm.iam_actions_alarm","mode":"managed","type":"aws_cloudwatch_metric_alarm","name":"iam_actions_alarm","provider_config_key":"aws","expressions":{"alarm_actions":{"references":["aws_sns_topic.security_alerts.arn","aws_sns_topic.security_alerts"]},"alarm_description":{"constant_value":"This metric monitors IAM actions"},"alarm_name":{"references":["local.name_prefix"]},"comparison_operator":{"constant_value":"GreaterThanOrEqualToThreshold"},"evaluation_periods":{"constant_value":"1"},"metric_name":{"constant_value":"IAMActions"},"namespace":{"constant_value":"Security/IAM"},"period":{"constant_value":"300"},"statistic":{"constant_value":"Sum"},"tags":{"references":["local.common_tags"]},"threshold":{"constant_value":"1"}},"schema_version":1},{"address":"aws_config_configuration_recorder.security_recorder","mode":"managed","type":"aws_config_configuration_recorder","name":"security_recorder","provider_config_key":"aws","expressions":{"name":{"references":["local.name_prefix"]},"recording_group":[{"all_supported":{"constant_value":true},"include_global_resource_types":{"constant_value":true}}],"role_arn":{"references":["aws_iam_role.config_role.arn","aws_iam_role.config_role"]}},"schema_version":0},{"address":"aws_config_configuration_recorder_status.security_recorder_status","mode":"managed","type":"aws_config_configuration_recorder_status","name":"security_recorder_status","provider_config_key":"aws","expressions":{"is_enabled":{"constant_value":true},"name":{"references":["aws_config_configuration_recorder.security_recorder.name","aws_config_configuration_recorder.security_recorder"]}},"schema_version":0,"depends_on":["aws_config_delivery_channel.security_delivery_channel"]},{"address":"aws_config_delivery_channel.security_delivery_channel","mode":"managed","type":"aws_config_delivery_channel","name":"security_delivery_channel","provider_config_key":"aws","expressions":{"name":{"references":["local.name_prefix"]},"s3_bucket_name":{"references":["aws_s3_bucket.config_bucket.bucket","aws_s3_bucket.config_bucket"]},"s3_key_prefix":{"constant_value":"config"}},"schema_version":0,"depends_on":["aws_config_configuration_recorder.security_recorder"]},{"address":"aws_guardduty_detector.main","mode":"managed","type":"aws_guardduty_detector","name":"main","provider_config_key":"aws","expressions":{"enable":{"constant_value":true},"tags":{"references":["local.common_tags"]}},"schema_version":0},{"address":"aws_guardduty_detector_feature.eks_audit_logs","mode":"managed","type":"aws_guardduty_detector_feature","name":"eks_audit_logs","provider_config_key":"aws","expressions":{"detector_id":{"references":["aws_guardduty_detector.main.id","aws_guardduty_detector.main"]},"name":{"constant_value":"EKS_AUDIT_LOGS"},"status":{"constant_value":"ENABLED"}},"schema_version":0},{"address":"aws_guardduty_detector_feature.malware_protection","mode":"managed","type":"aws_guardduty_detector_feature","name":"malware_protection","provider_config_key":"aws","expressions":{"detector_id":{"references":["aws_guardduty_detector.main.id","aws_guardduty_detector.main"]},"name":{"constant_value":"EBS_MALWARE_PROTECTION"},"status":{"constant_value":"ENABLED"}},"schema_version":0},{"address":"aws_guardduty_detector_feature.s3_logs","mode":"managed","type":"aws_guardduty_detector_feature","name":"s3_logs","provider_config_key":"aws","expressions":{"detector_id":{"references":["aws_guardduty_detector.main.id","aws_guardduty_detector.main"]},"name":{"constant_value":"S3_DATA_EVENTS"},"status":{"constant_value":"ENABLED"}},"schema_version":0},{"address":"aws_iam_role.config_role","mode":"managed","type":"aws_iam_role","name":"config_role","provider_config_key":"aws","expressions":{"assume_role_policy":{},"name":{"references":["local.name_prefix"]},"tags":{"references":["local.common_tags"]}},"schema_version":0},{"address":"aws_iam_role.cross_account_role","mode":"managed","type":"aws_iam_role","name":"cross_account_role","provider_config_key":"aws","expressions":{"assume_role_policy":{"references":["local.account_id","local.name_prefix"]},"name":{"references":["local.name_prefix"]},"tags":{"references":["local.common_tags"]}},"schema_version":0},{"address":"aws_iam_role.lambda_execution_role","mode":"managed","type":"aws_iam_role","name":"lambda_execution_role","provider_config_key":"aws","expressions":{"assume_role_policy":{},"name":{"references":["local.name_prefix"]},"tags":{"references":["local.common_tags"]}},"schema_version":0},{"address":"aws_iam_role.security_monitoring_role","mode":"managed","type":"aws_iam_role","name":"security_monitoring_role","provider_config_key":"aws","expressions":{"assume_role_policy":{},"name":{"references":["local.name_prefix"]},"tags":{"references":["local.common_tags"]}},"schema_version":0},{"address":"aws_iam_role.step_function_role","mode":"managed","type":"aws_iam_role","name":"step_function_role","provider_config_key":"aws","expressions":{"assume_role_policy":{},"name":{"references":["local.name_prefix"]},"tags":{"references":["local.common_tags"]}},"schema_version":0},{"address":"aws_iam_role_policy.config_s3_policy","mode":"managed","type":"aws_iam_role_policy","name":"config_s3_policy","provider_config_key":"aws","expressions":{"name":{"references":["local.name_prefix"]},"policy":{"references":["aws_s3_bucket.config_bucket.arn","aws_s3_bucket.config_bucket","aws_s3_bucket.config_bucket.arn","aws_s3_bucket.config_bucket"]},"role":{"references":["aws_iam_role.config_role.id","aws_iam_role.config_role"]}},"schema_version":0},{"address":"aws_iam_role_policy.cross_account_policy","mode":"managed","type":"aws_iam_role_policy","name":"cross_account_policy","provider_config_key":"aws","expressions":{"name":{"references":["local.name_prefix"]},"policy":{"references":["aws_s3_bucket.secure_bucket.arn","aws_s3_bucket.secure_bucket"]},"role":{"references":["aws_iam_role.cross_account_role.id","aws_iam_role.cross_account_role"]}},"schema_version":0},{"address":"aws_iam_role_policy.lambda_execution_policy","mode":"managed","type":"aws_iam_role_policy","name":"lambda_execution_policy","provider_config_key":"aws","expressions":{"name":{"references":["local.name_prefix"]},"policy":{},"role":{"references":["aws_iam_role.lambda_execution_role.id","aws_iam_role.lambda_execution_role"]}},"schema_version":0},{"address":"aws_iam_role_policy.security_monitoring_policy","mode":"managed","type":"aws_iam_role_policy","name":"security_monitoring_policy","provider_config_key":"aws","expressions":{"name":{"references":["local.name_prefix"]},"policy":{},"role":{"references":["aws_iam_role.security_monitoring_role.id","aws_iam_role.security_monitoring_role"]}},"schema_version":0},{"address":"aws_iam_role_policy.step_function_policy","mode":"managed","type":"aws_iam_role_policy","name":"step_function_policy","provider_config_key":"aws","expressions":{"name":{"references":["local.name_prefix"]},"policy":{"references":["aws_lambda_function.security_response.arn","aws_lambda_function.security_response"]},"role":{"references":["aws_iam_role.step_function_role.id","aws_iam_role.step_function_role"]}},"schema_version":0},{"address":"aws_iam_role_policy_attachment.config_policy","mode":"managed","type":"aws_iam_role_policy_attachment","name":"config_policy","provider_config_key":"aws","expressions":{"policy_arn":{"constant_value":"arn:aws:iam::aws:policy/service-role/AWS_ConfigRole"},"role":{"references":["aws_iam_role.config_role.name","aws_iam_role.config_role"]}},"schema_version":0},{"address":"aws_kms_alias.security_key_alias","mode":"managed","type":"aws_kms_alias","name":"security_key_alias","provider_config_key":"aws","expressions":{"name":{"references":["local.name_prefix"]},"target_key_id":{"references":["aws_kms_key.security_key.key_id","aws_kms_key.security_key"]}},"schema_version":0},{"address":"aws_kms_key.security_key","mode":"managed","type":"aws_kms_key","name":"security_key","provider_config_key":"aws","expressions":{"deletion_window_in_days":{"constant_value":7},"description":{"constant_value":"KMS key for encrypting sensitive data"},"enable_key_rotation":{"constant_value":true},"policy":{"references":["local.account_id","local.region","local.region","local.account_id"]},"tags":{"references":["local.common_tags"]}},"schema_version":0},{"address":"aws_lambda_function.security_response","mode":"managed","type":"aws_lambda_function","name":"security_response","provider_config_key":"aws","expressions":{"environment":[{"variables":{"references":["aws_sns_topic.security_alerts.arn","aws_sns_topic.security_alerts","aws_kms_key.security_key.key_id","aws_kms_key.security_key"]}}],"filename":{"constant_value":"security_response.zip"},"function_name":{"references":["local.name_prefix"]},"handler":{"constant_value":"index.handler"},"role":{"references":["aws_iam_role.lambda_execution_role.arn","aws_iam_role.lambda_execution_role"]},"runtime":{"constant_value":"python3.9"},"tags":{"references":["local.common_tags"]},"timeout":{"constant_value":300}},"schema_version":0,"depends_on":["data.archive_file.security_response_zip"]},{"address":"aws_s3_bucket.access_logs","mode":"managed","type":"aws_s3_bucket","name":"access_logs","provider_config_key":"aws","expressions":{"bucket":{"references":["local.name_prefix"]},"force_destroy":{"constant_value":true},"tags":{"references":["local.common_tags"]}},"schema_version":0},{"address":"aws_s3_bucket.config_bucket","mode":"managed","type":"aws_s3_bucket","name":"config_bucket","provider_config_key":"aws","expressions":{"bucket":{"references":["local.name_prefix"]},"force_destroy":{"constant_value":true},"tags":{"references":["local.common_tags"]}},"schema_version":0},{"address":"aws_s3_bucket.secure_bucket","mode":"managed","type":"aws_s3_bucket","name":"secure_bucket","provider_config_key":"aws","expressions":{"bucket":{"references":["local.name_prefix"]},"force_destroy":{"constant_value":true},"tags":{"references":["local.common_tags"]}},"schema_version":0},{"address":"aws_s3_bucket_logging.secure_bucket_logging","mode":"managed","type":"aws_s3_bucket_logging","name":"secure_bucket_logging","provider_config_key":"aws","expressions":{"bucket":{"references":["aws_s3_bucket.secure_bucket.id","aws_s3_bucket.secure_bucket"]},"target_bucket":{"references":["aws_s3_bucket.access_logs.id","aws_s3_bucket.access_logs"]},"target_prefix":{"constant_value":"access-logs/"}},"schema_version":0},{"address":"aws_s3_bucket_policy.access_logs_policy","mode":"managed","type":"aws_s3_bucket_policy","name":"access_logs_policy","provider_config_key":"aws","expressions":{"bucket":{"references":["aws_s3_bucket.access_logs.id","aws_s3_bucket.access_logs"]},"policy":{"references":["aws_s3_bucket.access_logs.arn","aws_s3_bucket.access_logs"]}},"schema_version":0},{"address":"aws_s3_bucket_policy.config_bucket_policy","mode":"managed","type":"aws_s3_bucket_policy","name":"config_bucket_policy","provider_config_key":"aws","expressions":{"bucket":{"references":["aws_s3_bucket.config_bucket.id","aws_s3_bucket.config_bucket"]},"policy":{"references":["aws_s3_bucket.config_bucket.arn","aws_s3_bucket.config_bucket","aws_s3_bucket.config_bucket.arn","aws_s3_bucket.config_bucket","aws_s3_bucket.config_bucket.arn","aws_s3_bucket.config_bucket"]}},"schema_version":0},{"address":"aws_s3_bucket_policy.secure_bucket_policy","mode":"managed","type":"aws_s3_bucket_policy","name":"secure_bucket_policy","provider_config_key":"aws","expressions":{"bucket":{"references":["aws_s3_bucket.secure_bucket.id","aws_s3_bucket.secure_bucket"]},"policy":{"references":["aws_s3_bucket.secure_bucket.arn","aws_s3_bucket.secure_bucket","aws_s3_bucket.secure_bucket.arn","aws_s3_bucket.secure_bucket"]}},"schema_version":0},{"address":"aws_s3_bucket_public_access_block.access_logs_pab","mode":"managed","type":"aws_s3_bucket_public_access_block","name":"access_logs_pab","provider_config_key":"aws","expressions":{"block_public_acls":{"constant_value":true},"block_public_policy":{"constant_value":true},"bucket":{"references":["aws_s3_bucket.access_logs.id","aws_s3_bucket.access_logs"]},"ignore_public_acls":{"constant_value":true},"restrict_public_buckets":{"constant_value":true}},"schema_version":0},{"address":"aws_s3_bucket_public_access_block.config_bucket_pab","mode":"managed","type":"aws_s3_bucket_public_access_block","name":"config_bucket_pab","provider_config_key":"aws","expressions":{"block_public_acls":{"constant_value":true},"block_public_policy":{"constant_value":true},"bucket":{"references":["aws_s3_bucket.config_bucket.id","aws_s3_bucket.config_bucket"]},"ignore_public_acls":{"constant_value":true},"restrict_public_buckets":{"constant_value":true}},"schema_version":0},{"address":"aws_s3_bucket_public_access_block.secure_bucket_pab","mode":"managed","type":"aws_s3_bucket_public_access_block","name":"secure_bucket_pab","provider_config_key":"aws","expressions":{"block_public_acls":{"constant_value":true},"block_public_policy":{"constant_value":true},"bucket":{"references":["aws_s3_bucket.secure_bucket.id","aws_s3_bucket.secure_bucket"]},"ignore_public_acls":{"constant_value":true},"restrict_public_buckets":{"constant_value":true}},"schema_version":0},{"address":"aws_s3_bucket_server_side_encryption_configuration.access_logs_encryption","mode":"managed","type":"aws_s3_bucket_server_side_encryption_configuration","name":"access_logs_encryption","provider_config_key":"aws","expressions":{"bucket":{"references":["aws_s3_bucket.access_logs.id","aws_s3_bucket.access_logs"]},"rule":[{"apply_server_side_encryption_by_default":[{"kms_master_key_id":{"references":["aws_kms_key.security_key.arn","aws_kms_key.security_key"]},"sse_algorithm":{"constant_value":"aws:kms"}}],"bucket_key_enabled":{"constant_value":true}}]},"schema_version":0},{"address":"aws_s3_bucket_server_side_encryption_configuration.config_bucket_encryption","mode":"managed","type":"aws_s3_bucket_server_side_encryption_configuration","name":"config_bucket_encryption","provider_config_key":"aws","expressions":{"bucket":{"references":["aws_s3_bucket.config_bucket.id","aws_s3_bucket.config_bucket"]},"rule":[{"apply_server_side_encryption_by_default":[{"kms_master_key_id":{"references":["aws_kms_key.security_key.arn","aws_kms_key.security_key"]},"sse_algorithm":{"constant_value":"aws:kms"}}],"bucket_key_enabled":{"constant_value":true}}]},"schema_version":0},{"address":"aws_s3_bucket_server_side_encryption_configuration.secure_bucket_encryption","mode":"managed","type":"aws_s3_bucket_server_side_encryption_configuration","name":"secure_bucket_encryption","provider_config_key":"aws","expressions":{"bucket":{"references":["aws_s3_bucket.secure_bucket.id","aws_s3_bucket.secure_bucket"]},"rule":[{"apply_server_side_encryption_by_default":[{"kms_master_key_id":{"references":["aws_kms_key.security_key.arn","aws_kms_key.security_key"]},"sse_algorithm":{"constant_value":"aws:kms"}}],"bucket_key_enabled":{"constant_value":true}}]},"schema_version":0},{"address":"aws_s3_bucket_versioning.secure_bucket_versioning","mode":"managed","type":"aws_s3_bucket_versioning","name":"secure_bucket_versioning","provider_config_key":"aws","expressions":{"bucket":{"references":["aws_s3_bucket.secure_bucket.id","aws_s3_bucket.secure_bucket"]},"versioning_configuration":[{"status":{"constant_value":"Enabled"}}]},"schema_version":0},{"address":"aws_securityhub_account.main","mode":"managed","type":"aws_securityhub_account","name":"main","provider_config_key":"aws","schema_version":1},{"address":"aws_securityhub_standards_subscription.aws_foundational","mode":"managed","type":"aws_securityhub_standards_subscription","name":"aws_foundational","provider_config_key":"aws","expressions":{"standards_arn":{"constant_value":"arn:aws:securityhub:us-west-2::standards/aws-foundational-security-best-practices/v/1.0.0"}},"schema_version":0,"depends_on":["aws_securityhub_account.main"]},{"address":"aws_securityhub_standards_subscription.cis","mode":"managed","type":"aws_securityhub_standards_subscription","name":"cis","provider_config_key":"aws","expressions":{"standards_arn":{"constant_value":"arn:aws:securityhub:us-west-2::standards/cis-aws-foundations-benchmark/v/1.4.0"}},"schema_version":0,"depends_on":["aws_securityhub_account.main"]},{"address":"aws_sfn_state_machine.security_workflow","mode":"managed","type":"aws_sfn_state_machine","name":"security_workflow","provider_config_key":"aws","expressions":{"definition":{"references":["aws_lambda_function.security_response.arn","aws_lambda_function.security_response"]},"name":{"references":["local.name_prefix"]},"role_arn":{"references":["aws_iam_role.step_function_role.arn","aws_iam_role.step_function_role"]},"tags":{"references":["local.common_tags"]}},"schema_version":0},{"address":"aws_sns_topic.security_alerts","mode":"managed","type":"aws_sns_topic","name":"security_alerts","provider_config_key":"aws","expressions":{"kms_master_key_id":{"references":["aws_kms_key.security_key.arn","aws_kms_key.security_key"]},"name":{"references":["local.name_prefix"]},"tags":{"references":["local.common_tags"]}},"schema_version":0},{"address":"aws_sns_topic_subscription.security_email","mode":"managed","type":"aws_sns_topic_subscription","name":"security_email","provider_config_key":"aws","expressions":{"endpoint":{"references":["var.notification_email"]},"protocol":{"constant_value":"email"},"topic_arn":{"references":["aws_sns_topic.security_alerts.arn","aws_sns_topic.security_alerts"]}},"schema_version":0},{"address":"data.archive_file.security_response_zip","mode":"data","type":"archive_file","name":"security_response_zip","provider_config_key":"archive","expressions":{"output_path":{"constant_value":"security_response.zip"},"source":[{"content":{"constant_value":"import json\r\nimport boto3\r\nimport os\r\n\r\ndef handler(event, context):\r\n    sns = boto3.client('sns')\r\n    \r\n    # Process security event\r\n    print(f\"Processing security event: {json.dumps(event)}\")\r\n    \r\n    # Send notification\r\n    sns.publish(\r\n        TopicArn=os.environ['SNS_TOPIC_ARN'],\r\n        Subject='Security Alert: Unauthorized Access Attempt',\r\n        Message=f'Security event detected: {json.dumps(event)}'\r\n    )\r\n    \r\n    return {\r\n        'statusCode': 200,\r\n        'body': json.dumps('Security response completed')\r\n    }\r\n"},"filename":{"constant_value":"index.py"}}],"type":{"constant_value":"zip"}},"schema_version":0},{"address":"data.aws_caller_identity.current","mode":"data","type":"aws_caller_identity","name":"current","provider_config_key":"aws","schema_version":0},{"address":"data.aws_region.current","mode":"data","type":"aws_region","name":"current","provider_config_key":"aws","schema_version":0}],"variables":{"aws_region":{"default":"us-west-2","description":"AWS provider region"},"environment":{"default":"production","description":"Environment name"},"environment_suffix":{"default":"dev","description":"Environment suffix for unique resource naming"},"notification_email":{"default":"security@company.com","description":"Email address for security notifications"},"project_name":{"default":"SecureInfrastructure","description":"Project name"}}}},"relevant_attributes":[{"resource":"aws_guardduty_detector.main","attribute":["id"]},{"resource":"aws_iam_role.config_role","attribute":["arn"]},{"resource":"aws_lambda_function.security_response","attribute":["arn"]},{"resource":"aws_lambda_function.security_response","attribute":["function_name"]},{"resource":"aws_config_configuration_recorder.security_recorder","attribute":["name"]},{"resource":"aws_s3_bucket.secure_bucket","attribute":["id"]},{"resource":"data.aws_caller_identity.current","attribute":["account_id"]},{"resource":"data.aws_region.current","attribute":["id"]},{"resource":"aws_iam_role.lambda_execution_role","attribute":["arn"]},{"resource":"aws_s3_bucket.access_logs","attribute":["arn"]},{"resource":"aws_s3_bucket.config_bucket","attribute":["bucket"]},{"resource":"aws_s3_bucket.config_bucket","attribute":["id"]},{"resource":"aws_iam_role.step_function_role","attribute":["arn"]},{"resource":"aws_iam_role.step_function_role","attribute":["id"]},{"resource":"aws_s3_bucket.config_bucket","attribute":["arn"]},{"resource":"aws_kms_key.security_key","attribute":["arn"]},{"resource":"aws_iam_role.config_role","attribute":["id"]},{"resource":"aws_s3_bucket.access_logs","attribute":["id"]},{"resource":"aws_sfn_state_machine.security_workflow","attribute":["arn"]},{"resource":"aws_iam_role.cross_account_role","attribute":["arn"]},{"resource":"aws_cloudwatch_log_group.security_logs","attribute":["name"]},{"resource":"aws_iam_role.lambda_execution_role","attribute":["id"]},{"resource":"aws_kms_key.security_key","attribute":["key_id"]},{"resource":"aws_securityhub_account.main","attribute":["id"]},{"resource":"aws_iam_role.security_monitoring_role","attribute":["arn"]},{"resource":"aws_iam_role.config_role","attribute":["name"]},{"resource":"aws_iam_role.security_monitoring_role","attribute":["id"]},{"resource":"aws_s3_bucket.access_logs","attribute":["bucket"]},{"resource":"aws_s3_bucket.secure_bucket","attribute":["bucket"]},{"resource":"aws_iam_role.cross_account_role","attribute":["id"]},{"resource":"aws_s3_bucket.secure_bucket","attribute":["arn"]},{"resource":"aws_sns_topic.security_alerts","attribute":["arn"]}],"timestamp":"2025-08-14T10:57:27Z","applyable":true,"complete":true,"errored":false}
