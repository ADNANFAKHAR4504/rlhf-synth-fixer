{
  "AWSTemplateFormatVersion": "2010-09-09",
  "Description": "High Availability Payment Processing Infrastructure with Multi-AZ Failover",
  "Parameters": {
    "EnvironmentSuffix": {
      "Type": "String",
      "Description": "Unique suffix for resource names to enable parallel deployments",
      "AllowedPattern": "[a-z0-9-]+",
      "ConstraintDescription": "Must contain only lowercase letters, numbers, and hyphens"
    },
    "AlertEmail": {
      "Type": "String",
      "Description": "Email address for critical alerts",
      "Default": "ops@example.com"
    },
    "DBMasterUsername": {
      "Type": "String",
      "Description": "Master username for Aurora PostgreSQL",
      "Default": "dbadmin",
      "MinLength": 1,
      "MaxLength": 16,
      "AllowedPattern": "[a-zA-Z][a-zA-Z0-9]*"
    },
    "DBMasterPassword": {
      "Type": "String",
      "Description": "Master password for Aurora PostgreSQL",
      "NoEcho": true,
      "MinLength": 8,
      "MaxLength": 41,
      "Default": "TempPassword123!"
    },
    "ContainerImage": {
      "Type": "String",
      "Description": "Docker image for ECS tasks",
      "Default": "nginx:latest"
    },
    "HostedZoneId": {
      "Type": "String",
      "Description": "Route 53 Hosted Zone ID for failover DNS (leave empty to skip Route53 resources)",
      "Default": ""
    },
    "DomainName": {
      "Type": "String",
      "Description": "Domain name for Route 53 records (e.g., api.example.com)",
      "Default": ""
    }
  },
  "Conditions": {
    "CreateRoute53Resources": {
      "Fn::Not": [
        {
          "Fn::Equals": [
            {
              "Ref": "HostedZoneId"
            },
            ""
          ]
        }
      ]
    }
  },
  "Resources": {
