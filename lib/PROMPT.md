You are tasked with creating a secure and compliant AWS infrastructure using Terraform. The environment will be hosted in the AWS us-west-2 region and must adhere to the following security and compliance requirements: 1. All security groups permitting inbound traffic must only allow access from specific IP addresses. 2. All data in S3 buckets must be encrypted at rest with customer-managed keys. 3. Logging must be enabled on all S3 buckets for audit purposes. 4. IAM roles and policies must be designed with least privilege in mind. 5. CloudWatch alarms need to be configured to alert on unauthorized API calls. 6. Enable VPC flow logs to monitor traffic patterns. 7. Use Multi-AZ deployments for RDS instances to ensure high availability. 8. EC2 instances must be launched with the most up-to-date security-patched AMIs. 9. Automate the application of security patches on EC2 instances via Systems Manager. 10. Public access should be blocked for all S3 buckets by default.

Expected Output: Implement your solution within a Terraform configuration file named `main.tf`. Ensure that all constraints are met and that all Terraform configuration follows best practices. The configuration should be fully deployable without any manual intervention. Extensive testing should be conducted to validate compliance with the constraints. The provided tests must pass successfully.
