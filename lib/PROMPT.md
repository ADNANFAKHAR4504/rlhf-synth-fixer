### AWS stack to create a comprehensive security environment
You are an AWS professional. Your task is to design a CDK Stack to create a comprehensive security environment for a new AWS-based application deployment. The deployment should address the following requirements. All IAM roles must include trust policies for allowed principals. All EBS volumes and RDS instances must be encrypted using AWS KMS. You have to ensure public S3 buckets have policies restricting public 'PUT' actions. You have to implement MFA for all IAM users and ensure access keys are rotated regularly (Every 90 days). You should use AWS WAF for Load Balancer protection against web threats. You should sssign read-only S3 permissions to EC2 instance profiles. You ensure CloudTrail logs are securely stored and encrypted. Allow message reception by SNS only from authorised AWS services. Take care to ensure security groups must strictly limit inbound connections to SSH from specified IPs. GuardDuty should be enabled across all regions. The stack should be deployable in us-west-2 and us-east-2 regions, with resources named according to the pattern 'prod-<resource_name>' for production and 'dev-<resource_name>' for development environments. The expected output is a CDK stack with the class name TapStack and a file named tap-stack.ts