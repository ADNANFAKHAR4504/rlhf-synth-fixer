I'm still running into several TypeScript compilation errors after trying to use your code. Here are the specific issues I'm seeing:

also in your file have module import issues.