// Jest Snapshot v1, https://goo.gl/fbAQLP

exports[`TapStack Unit Tests Stack Creation should use default values when props not provided 1`] = `
"{
  "data": {
    "aws_caller_identity": {
      "current": {
      }
    }
  },
  "output": {
    "alb-dns-name": {
      "description": "Application Load Balancer DNS Name",
      "value": "\${aws_alb.ecs_alb_89929666.dns_name}"
    },
    "aws-account-id": {
      "description": "AWS Account ID",
      "value": "\${data.aws_caller_identity.current.account_id}"
    },
    "ecs-cluster-name": {
      "description": "ECS Cluster Name",
      "value": "\${aws_ecs_cluster.ecs_ecs-cluster_CA55365B.name}"
    },
    "ecs-service-name": {
      "description": "ECS Service Name",
      "value": "\${aws_ecs_service.ecs_ecs-service_81A77771.name}"
    },
    "log-group-name": {
      "description": "CloudWatch Log Group Name",
      "value": "\${aws_cloudwatch_log_group.monitoring_monitoring-log-group_D74F9BAB.name}"
    },
    "rds-cluster-endpoint": {
      "description": "RDS Aurora Cluster Endpoint",
      "value": "\${aws_rds_cluster.database_aurora-cluster_BB889960.endpoint}"
    },
    "redis-endpoint": {
      "description": "ElastiCache Redis Primary Endpoint",
      "value": "\${aws_elasticache_replication_group.cache_redis-cluster_7A0A549A.primary_endpoint_address}"
    },
    "vpc-id": {
      "description": "VPC ID",
      "value": "\${aws_vpc.network_vpc_4E8F0223.id}"
    }
  },
  "provider": {
    "aws": [
      {
        "default_tags": [
        ],
        "region": "eu-west-1"
      }
    ]
  },
  "resource": {
    "aws_alb": {
      "ecs_alb_89929666": {
        "enable_deletion_protection": false,
        "internal": false,
        "load_balancer_type": "application",
        "name": "assessment-alb-dev",
        "security_groups": [
          "\${aws_security_group.ecs_alb-sg-module_81158674.id}"
        ],
        "subnets": [
          "\${aws_subnet.network_public-subnet-1_63BED862.id}",
          "\${aws_subnet.network_public-subnet-2_7DE9A83A.id}"
        ],
        "tags": {
          "Name": "assessment-alb-dev"
        }
      }
    },
    "aws_alb_listener": {
      "ecs_alb-listener_021D9154": {
        "default_action": [
          {
            "target_group_arn": "\${aws_alb_target_group.ecs_target-group_D2C353A0.arn}",
            "type": "forward"
          }
        ],
        "load_balancer_arn": "\${aws_alb.ecs_alb_89929666.arn}",
        "port": 80,
        "protocol": "HTTP"
      }
    },
    "aws_alb_target_group": {
      "ecs_target-group_D2C353A0": {
        "health_check": {
          "enabled": true,
          "healthy_threshold": 2,
          "interval": 30,
          "path": "/health",
          "protocol": "HTTP",
          "timeout": 5,
          "unhealthy_threshold": 3
        },
        "name": "assessment-tg-dev",
        "port": 8080,
        "protocol": "HTTP",
        "tags": {
          "Name": "assessment-tg-dev"
        },
        "target_type": "ip",
        "vpc_id": "\${aws_vpc.network_vpc_4E8F0223.id}"
      }
    },
    "aws_cloudwatch_log_group": {
      "ecs_ecs-log-group_1BC7C268": {
        "name": "/ecs/assessment-dev",
        "retention_in_days": 30,
        "tags": {
          "Name": "assessment-ecs-logs-dev"
        }
      },
      "monitoring_monitoring-log-group_D74F9BAB": {
        "name": "/aws/assessment/dev",
        "retention_in_days": 90,
        "tags": {
          "Name": "assessment-monitoring-dev"
        }
      }
    },
    "aws_cloudwatch_metric_alarm": {
      "monitoring_cache-cpu-alarm_4E3A70F8": {
        "alarm_description": "Alert when ElastiCache CPU exceeds 75%",
        "alarm_name": "assessment-cache-cpu-dev",
        "comparison_operator": "GreaterThanThreshold",
        "dimensions": {
          "ReplicationGroupId": "\${aws_elasticache_replication_group.cache_redis-cluster_7A0A549A.id}"
        },
        "evaluation_periods": 2,
        "metric_name": "CPUUtilization",
        "namespace": "AWS/ElastiCache",
        "period": 300,
        "statistic": "Average",
        "tags": {
          "Name": "assessment-cache-cpu-alarm-dev"
        },
        "threshold": 75
      },
      "monitoring_ecs-cpu-alarm_E43DE59D": {
        "alarm_description": "Alert when ECS CPU exceeds 80%",
        "alarm_name": "assessment-ecs-cpu-dev",
        "comparison_operator": "GreaterThanThreshold",
        "dimensions": {
          "ClusterName": "\${aws_ecs_cluster.ecs_ecs-cluster_CA55365B.name}"
        },
        "evaluation_periods": 2,
        "metric_name": "CPUUtilization",
        "namespace": "AWS/ECS",
        "period": 300,
        "statistic": "Average",
        "tags": {
          "Name": "assessment-ecs-cpu-alarm-dev"
        },
        "threshold": 80
      },
      "monitoring_rds-cpu-alarm_66B168C4": {
        "alarm_description": "Alert when RDS CPU exceeds 80%",
        "alarm_name": "assessment-rds-cpu-dev",
        "comparison_operator": "GreaterThanThreshold",
        "dimensions": {
          "DBClusterIdentifier": "\${aws_rds_cluster.database_aurora-cluster_BB889960.id}"
        },
        "evaluation_periods": 2,
        "metric_name": "CPUUtilization",
        "namespace": "AWS/RDS",
        "period": 300,
        "statistic": "Average",
        "tags": {
          "Name": "assessment-rds-cpu-alarm-dev"
        },
        "threshold": 80
      }
    },
    "aws_db_subnet_group": {
      "database_db-subnet-group_25758AB4": {
        "name": "assessment-db-subnet-dev",
        "subnet_ids": [
          "\${aws_subnet.network_private-subnet-1_F0ACDF2C.id}",
          "\${aws_subnet.network_private-subnet-2_1AC61B04.id}"
        ],
        "tags": {
          "Name": "assessment-db-subnet-dev"
        }
      }
    },
    "aws_ecs_cluster": {
      "ecs_ecs-cluster_CA55365B": {
        "name": "assessment-cluster-dev",
        "tags": {
          "Name": "assessment-cluster-dev"
        }
      }
    },
    "aws_ecs_service": {
      "ecs_ecs-service_81A77771": {
        "cluster": "\${aws_ecs_cluster.ecs_ecs-cluster_CA55365B.id}",
        "desired_count": 2,
        "launch_type": "FARGATE",
        "load_balancer": [
          {
            "container_name": "assessment-app",
            "container_port": 8080,
            "target_group_arn": "\${aws_alb_target_group.ecs_target-group_D2C353A0.arn}"
          }
        ],
        "name": "assessment-service-dev",
        "network_configuration": {
          "assign_public_ip": false,
          "security_groups": [
            "\${aws_security_group.network_ecs-sg_EFD222B2.id}"
          ],
          "subnets": [
            "\${aws_subnet.network_private-subnet-1_F0ACDF2C.id}",
            "\${aws_subnet.network_private-subnet-2_1AC61B04.id}"
          ]
        },
        "tags": {
          "Name": "assessment-service-dev"
        },
        "task_definition": "\${aws_ecs_task_definition.ecs_ecs-task-def_DB9BF641.arn}"
      }
    },
    "aws_ecs_task_definition": {
      "ecs_ecs-task-def_DB9BF641": {
        "container_definitions": "[{\\"name\\":\\"assessment-app\\",\\"image\\":\\"nginx:latest\\",\\"essential\\":true,\\"portMappings\\":[{\\"containerPort\\":8080,\\"protocol\\":\\"tcp\\"}],\\"environment\\":[{\\"name\\":\\"DB_ENDPOINT\\",\\"value\\":\\"\${aws_rds_cluster.database_aurora-cluster_BB889960.endpoint}\\"},{\\"name\\":\\"CACHE_ENDPOINT\\",\\"value\\":\\"\${aws_elasticache_replication_group.cache_redis-cluster_7A0A549A.primary_endpoint_address}\\"},{\\"name\\":\\"AWS_REGION\\",\\"value\\":\\"eu-west-1\\"}],\\"secrets\\":[{\\"name\\":\\"DB_PASSWORD\\",\\"valueFrom\\":\\"\${aws_secretsmanager_secret.secrets_db-secret_25C2BD86.arn}:password::\\"}],\\"logConfiguration\\":{\\"logDriver\\":\\"awslogs\\",\\"options\\":{\\"awslogs-group\\":\\"\${aws_cloudwatch_log_group.ecs_ecs-log-group_1BC7C268.name}\\",\\"awslogs-region\\":\\"eu-west-1\\",\\"awslogs-stream-prefix\\":\\"ecs\\"}}}]",
        "cpu": "256",
        "execution_role_arn": "\${aws_iam_role.ecs_ecs-execution-role_C2C378B4.arn}",
        "family": "assessment-task-dev",
        "memory": "512",
        "network_mode": "awsvpc",
        "requires_compatibilities": [
          "FARGATE"
        ],
        "tags": {
          "Name": "assessment-task-dev"
        },
        "task_role_arn": "\${aws_iam_role.ecs_ecs-task-role_12D46AC3.arn}"
      }
    },
    "aws_elasticache_replication_group": {
      "cache_redis-cluster_7A0A549A": {
        "at_rest_encryption_enabled": "true",
        "automatic_failover_enabled": true,
        "description": "Redis cluster for assessment caching",
        "engine": "redis",
        "engine_version": "7.0",
        "maintenance_window": "mon:05:00-mon:07:00",
        "multi_az_enabled": true,
        "node_type": "cache.t4g.micro",
        "num_cache_clusters": 2,
        "parameter_group_name": "default.redis7",
        "port": 6379,
        "replication_group_id": "assessment-cache-dev",
        "security_group_ids": [
          "\${aws_security_group.network_cache-sg_F762F02B.id}"
        ],
        "snapshot_retention_limit": 5,
        "snapshot_window": "03:00-05:00",
        "subnet_group_name": "\${aws_elasticache_subnet_group.cache_cache-subnet-group_F0DD5B93.name}",
        "tags": {
          "Name": "assessment-cache-dev"
        },
        "transit_encryption_enabled": true
      }
    },
    "aws_elasticache_subnet_group": {
      "cache_cache-subnet-group_F0DD5B93": {
        "name": "assessment-cache-subnet-dev",
        "subnet_ids": [
          "\${aws_subnet.network_private-subnet-1_F0ACDF2C.id}",
          "\${aws_subnet.network_private-subnet-2_1AC61B04.id}"
        ],
        "tags": {
          "Name": "assessment-cache-subnet-dev"
        }
      }
    },
    "aws_iam_policy": {
      "ecs_secrets-policy_BFB3BD0D": {
        "name": "assessment-secrets-policy-dev",
        "policy": "{\\"Version\\":\\"2012-10-17\\",\\"Statement\\":[{\\"Effect\\":\\"Allow\\",\\"Action\\":[\\"secretsmanager:GetSecretValue\\",\\"secretsmanager:DescribeSecret\\"],\\"Resource\\":\\"\${aws_secretsmanager_secret.secrets_db-secret_25C2BD86.arn}\\"},{\\"Effect\\":\\"Allow\\",\\"Action\\":[\\"kms:Decrypt\\"],\\"Resource\\":\\"*\\"}]}"
      }
    },
    "aws_iam_role": {
      "ecs_ecs-execution-role_C2C378B4": {
        "assume_role_policy": "{\\"Version\\":\\"2012-10-17\\",\\"Statement\\":[{\\"Effect\\":\\"Allow\\",\\"Principal\\":{\\"Service\\":\\"ecs-tasks.amazonaws.com\\"},\\"Action\\":\\"sts:AssumeRole\\"}]}",
        "name": "assessment-ecs-execution-dev",
        "tags": {
          "Name": "assessment-ecs-execution-dev"
        }
      },
      "ecs_ecs-task-role_12D46AC3": {
        "assume_role_policy": "{\\"Version\\":\\"2012-10-17\\",\\"Statement\\":[{\\"Effect\\":\\"Allow\\",\\"Principal\\":{\\"Service\\":\\"ecs-tasks.amazonaws.com\\"},\\"Action\\":\\"sts:AssumeRole\\"}]}",
        "name": "assessment-ecs-task-dev",
        "tags": {
          "Name": "assessment-ecs-task-dev"
        }
      }
    },
    "aws_iam_role_policy_attachment": {
      "ecs_ecs-execution-policy_54C7BF23": {
        "policy_arn": "arn:aws:iam::aws:policy/service-role/AmazonECSTaskExecutionRolePolicy",
        "role": "\${aws_iam_role.ecs_ecs-execution-role_C2C378B4.name}"
      },
      "ecs_secrets-policy-attachment_B820A7A9": {
        "policy_arn": "\${aws_iam_policy.ecs_secrets-policy_BFB3BD0D.arn}",
        "role": "\${aws_iam_role.ecs_ecs-execution-role_C2C378B4.name}"
      }
    },
    "aws_internet_gateway": {
      "network_igw_5DF1EDA1": {
        "tags": {
          "Name": "assessment-igw-dev"
        },
        "vpc_id": "\${aws_vpc.network_vpc_4E8F0223.id}"
      }
    },
    "aws_rds_cluster": {
      "database_aurora-cluster_BB889960": {
        "backup_retention_period": 7,
        "cluster_identifier": "assessment-db-dev",
        "database_name": "assessments",
        "db_subnet_group_name": "\${aws_db_subnet_group.database_db-subnet-group_25758AB4.name}",
        "engine": "aurora-postgresql",
        "engine_mode": "provisioned",
        "engine_version": "15.3",
        "master_password": "T]HS[q6Ty{l#2pvFF|D32wnzNQSb>:2j",
        "master_username": "dbadmin",
        "preferred_backup_window": "03:00-04:00",
        "preferred_maintenance_window": "mon:04:00-mon:05:00",
        "serverlessv2_scaling_configuration": {
          "max_capacity": 1,
          "min_capacity": 0.5
        },
        "skip_final_snapshot": true,
        "storage_encrypted": true,
        "tags": {
          "Name": "assessment-db-dev"
        },
        "vpc_security_group_ids": [
          "\${aws_security_group.network_db-sg_6721AC19.id}"
        ]
      }
    },
    "aws_rds_cluster_instance": {
      "database_aurora-instance_22C17CAB": {
        "cluster_identifier": "\${aws_rds_cluster.database_aurora-cluster_BB889960.id}",
        "engine": "aurora-postgresql",
        "engine_version": "15.3",
        "identifier": "assessment-db-instance-dev",
        "instance_class": "db.serverless",
        "tags": {
          "Name": "assessment-db-instance-dev"
        }
      }
    },
    "aws_route": {
      "network_public-route_2F172918": {
        "destination_cidr_block": "0.0.0.0/0",
        "gateway_id": "\${aws_internet_gateway.network_igw_5DF1EDA1.id}",
        "route_table_id": "\${aws_route_table.network_public-rt_C8EB1D1E.id}"
      }
    },
    "aws_route_table": {
      "network_public-rt_C8EB1D1E": {
        "tags": {
          "Name": "assessment-public-rt-dev"
        },
        "vpc_id": "\${aws_vpc.network_vpc_4E8F0223.id}"
      }
    },
    "aws_route_table_association": {
      "network_public-rta-1_34A86780": {
        "route_table_id": "\${aws_route_table.network_public-rt_C8EB1D1E.id}",
        "subnet_id": "\${aws_subnet.network_public-subnet-1_63BED862.id}"
      },
      "network_public-rta-2_3DA896D5": {
        "route_table_id": "\${aws_route_table.network_public-rt_C8EB1D1E.id}",
        "subnet_id": "\${aws_subnet.network_public-subnet-2_7DE9A83A.id}"
      }
    },
    "aws_secretsmanager_secret": {
      "secrets_db-secret_25C2BD86": {
        "description": "Database credentials for student assessment system",
        "name": "assessment-db-credentials-dev",
        "tags": {
          "Environment": "dev",
          "Name": "assessment-db-credentials-dev"
        }
      }
    },
    "aws_secretsmanager_secret_version": {
      "secrets_db-secret-version_63B6FCB5": {
        "secret_id": "\${aws_secretsmanager_secret.secrets_db-secret_25C2BD86.id}",
        "secret_string": "{\\"username\\":\\"dbadmin\\",\\"password\\":\\"T]HS[q6Ty{l#2pvFF|D32wnzNQSb>:2j\\",\\"engine\\":\\"postgres\\",\\"host\\":\\"will-be-updated\\",\\"port\\":5432,\\"dbname\\":\\"assessments\\"}"
      }
    },
    "aws_security_group": {
      "ecs_alb-sg-module_81158674": {
        "description": "Security group for ALB",
        "name": "assessment-alb-sg-module-dev",
        "tags": {
          "Name": "assessment-alb-sg-module-dev"
        },
        "vpc_id": "\${aws_vpc.network_vpc_4E8F0223.id}"
      },
      "network_alb-sg_B3FA17EE": {
        "description": "Security group for Application Load Balancer",
        "name": "assessment-alb-sg-dev",
        "tags": {
          "Name": "assessment-alb-sg-dev"
        },
        "vpc_id": "\${aws_vpc.network_vpc_4E8F0223.id}"
      },
      "network_cache-sg_F762F02B": {
        "description": "Security group for ElastiCache Redis",
        "name": "assessment-cache-sg-dev",
        "tags": {
          "Name": "assessment-cache-sg-dev"
        },
        "vpc_id": "\${aws_vpc.network_vpc_4E8F0223.id}"
      },
      "network_db-sg_6721AC19": {
        "description": "Security group for RDS Aurora",
        "name": "assessment-db-sg-dev",
        "tags": {
          "Name": "assessment-db-sg-dev"
        },
        "vpc_id": "\${aws_vpc.network_vpc_4E8F0223.id}"
      },
      "network_ecs-sg_EFD222B2": {
        "description": "Security group for ECS Fargate tasks",
        "name": "assessment-ecs-sg-dev",
        "tags": {
          "Name": "assessment-ecs-sg-dev"
        },
        "vpc_id": "\${aws_vpc.network_vpc_4E8F0223.id}"
      }
    },
    "aws_security_group_rule": {
      "ecs_alb-egress-rule_D5919AE9": {
        "cidr_blocks": [
          "0.0.0.0/0"
        ],
        "from_port": 0,
        "protocol": "-1",
        "security_group_id": "\${aws_security_group.ecs_alb-sg-module_81158674.id}",
        "to_port": 0,
        "type": "egress"
      },
      "ecs_alb-http-ingress_F530A91F": {
        "cidr_blocks": [
          "0.0.0.0/0"
        ],
        "from_port": 80,
        "protocol": "tcp",
        "security_group_id": "\${aws_security_group.ecs_alb-sg-module_81158674.id}",
        "to_port": 80,
        "type": "ingress"
      },
      "network_alb-egress_F82D3602": {
        "cidr_blocks": [
          "0.0.0.0/0"
        ],
        "description": "Allow all outbound",
        "from_port": 0,
        "protocol": "-1",
        "security_group_id": "\${aws_security_group.network_alb-sg_B3FA17EE.id}",
        "to_port": 0,
        "type": "egress"
      },
      "network_alb-ingress-http_F6066C6B": {
        "cidr_blocks": [
          "0.0.0.0/0"
        ],
        "description": "Allow HTTP inbound",
        "from_port": 80,
        "protocol": "tcp",
        "security_group_id": "\${aws_security_group.network_alb-sg_B3FA17EE.id}",
        "to_port": 80,
        "type": "ingress"
      },
      "network_alb-ingress-https_D6FF0F34": {
        "cidr_blocks": [
          "0.0.0.0/0"
        ],
        "description": "Allow HTTPS inbound",
        "from_port": 443,
        "protocol": "tcp",
        "security_group_id": "\${aws_security_group.network_alb-sg_B3FA17EE.id}",
        "to_port": 443,
        "type": "ingress"
      },
      "network_cache-egress_EEEDFB41": {
        "cidr_blocks": [
          "0.0.0.0/0"
        ],
        "description": "Allow all outbound",
        "from_port": 0,
        "protocol": "-1",
        "security_group_id": "\${aws_security_group.network_cache-sg_F762F02B.id}",
        "to_port": 0,
        "type": "egress"
      },
      "network_cache-ingress-ecs_8BC83B1B": {
        "description": "Allow Redis from ECS",
        "from_port": 6379,
        "protocol": "tcp",
        "security_group_id": "\${aws_security_group.network_cache-sg_F762F02B.id}",
        "source_security_group_id": "\${aws_security_group.network_ecs-sg_EFD222B2.id}",
        "to_port": 6379,
        "type": "ingress"
      },
      "network_db-egress_63B7B42D": {
        "cidr_blocks": [
          "0.0.0.0/0"
        ],
        "description": "Allow all outbound",
        "from_port": 0,
        "protocol": "-1",
        "security_group_id": "\${aws_security_group.network_db-sg_6721AC19.id}",
        "to_port": 0,
        "type": "egress"
      },
      "network_db-ingress-ecs_27DD9DD5": {
        "description": "Allow PostgreSQL from ECS",
        "from_port": 5432,
        "protocol": "tcp",
        "security_group_id": "\${aws_security_group.network_db-sg_6721AC19.id}",
        "source_security_group_id": "\${aws_security_group.network_ecs-sg_EFD222B2.id}",
        "to_port": 5432,
        "type": "ingress"
      },
      "network_ecs-egress_2B9227E8": {
        "cidr_blocks": [
          "0.0.0.0/0"
        ],
        "description": "Allow all outbound",
        "from_port": 0,
        "protocol": "-1",
        "security_group_id": "\${aws_security_group.network_ecs-sg_EFD222B2.id}",
        "to_port": 0,
        "type": "egress"
      },
      "network_ecs-ingress-alb_0EBA2504": {
        "description": "Allow traffic from ALB",
        "from_port": 8080,
        "protocol": "tcp",
        "security_group_id": "\${aws_security_group.network_ecs-sg_EFD222B2.id}",
        "source_security_group_id": "\${aws_security_group.network_alb-sg_B3FA17EE.id}",
        "to_port": 8080,
        "type": "ingress"
      }
    },
    "aws_subnet": {
      "network_private-subnet-1_F0ACDF2C": {
        "availability_zone": "eu-west-1a",
        "cidr_block": "10.0.10.0/24",
        "tags": {
          "Name": "assessment-private-1-dev"
        },
        "vpc_id": "\${aws_vpc.network_vpc_4E8F0223.id}"
      },
      "network_private-subnet-2_1AC61B04": {
        "availability_zone": "eu-west-1b",
        "cidr_block": "10.0.11.0/24",
        "tags": {
          "Name": "assessment-private-2-dev"
        },
        "vpc_id": "\${aws_vpc.network_vpc_4E8F0223.id}"
      },
      "network_public-subnet-1_63BED862": {
        "availability_zone": "eu-west-1a",
        "cidr_block": "10.0.1.0/24",
        "map_public_ip_on_launch": true,
        "tags": {
          "Name": "assessment-public-1-dev"
        },
        "vpc_id": "\${aws_vpc.network_vpc_4E8F0223.id}"
      },
      "network_public-subnet-2_7DE9A83A": {
        "availability_zone": "eu-west-1b",
        "cidr_block": "10.0.2.0/24",
        "map_public_ip_on_launch": true,
        "tags": {
          "Name": "assessment-public-2-dev"
        },
        "vpc_id": "\${aws_vpc.network_vpc_4E8F0223.id}"
      }
    },
    "aws_vpc": {
      "network_vpc_4E8F0223": {
        "cidr_block": "10.0.0.0/16",
        "enable_dns_hostnames": true,
        "enable_dns_support": true,
        "tags": {
          "Name": "assessment-vpc-dev"
        }
      }
    }
  },
  "terraform": {
    "backend": {
      "s3": {
        "bucket": "iac-rlhf-tf-states",
        "encrypt": true,
        "key": "dev/TestStack.tfstate",
        "region": "us-east-1"
      }
    },
    "required_providers": {
      "aws": {
        "source": "aws",
        "version": "6.11.0"
      }
    }
  }
}"
`;
