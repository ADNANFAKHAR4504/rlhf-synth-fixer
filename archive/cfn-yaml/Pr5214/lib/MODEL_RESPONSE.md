# model_response

This stack defines a production-ready, multi-AZ, serverless data pipeline and API surface using AWS managed services. It provisions a VPC with public and private subnets across two Availability Zones, an S3 Gateway Endpoint, and conditional Interface Endpoints for CloudWatch Logs and SNS. Two S3 buckets are created: one for ingest and one for artifacts, both versioned, blocked from public access, encrypted with SSE-S3, and configured with lifecycle transitions to Glacier Instant Retrieval after 30 days. Bucket policies enforce TLS and deny unencrypted uploads; access is restricted to the VPC via the S3 Gateway Endpoint.

EventBridge is used to route S3 “Object Created” events to the transform Lambda, eliminating direct S3 notifications and avoiding circular dependencies. The transform Lambda, running inside private subnets and protected by a strict security group, reads JSON from S3 and persists processed records into a DynamoDB table that is encrypted with a KMS CMK. The Lambda uses least-privilege IAM policies for S3, DynamoDB, KMS, and logging, and references a sample Secrets Manager secret encrypted by the CMK. A companion API handler Lambda is fronted by a Regional API Gateway REST API. The `/process` POST endpoint uses Lambda proxy integration, with an explicitly named stage that includes the environment suffix. API Gateway logging is enabled with a dedicated log group.

DynamoDB runs in provisioned mode with Application Auto Scaling policies for both read and write capacity units, using target tracking to maintain the configured utilization percentage. Cognito resources (User Pool, App Client, Identity Pool) provide user management, and an authenticated role allows invoking the API. CloudWatch Log Groups are created with retention for each Lambda and for API Gateway. CloudWatch Alarms monitor Lambda errors and throttles, API 5XX rates, and DynamoDB write throttles; alerts are dispatched to an SNS Topic (KMS-backed) with an email subscription configured via parameterized developer address.

All resources include cost allocation tags and names suffixed with `ENVIRONMENTSUFFIX` to enable parallel environment deployments without naming collisions. Parameters have sensible defaults, enabling immediate stack creation in `us-east-1` while still allowing environment-specific tuning. The template is structured to pass validation and linting, avoids hidden circular dependencies, and adheres to the stated constraints for encryption, least privilege, observability, autoscaling, lifecycle management, and multi-AZ high availability.

