Create a CloudFormation YAML template for a secure web application deployed in us-east-1. The Application Load Balancer distributes traffic to EC2 instances in private subnets across multiple Availability Zones, with Auto Scaling Groups managing instance capacity. S3 buckets are accessed by EC2 instances and Lambda functions through VPC Endpoints to enforce private network connectivity. Lambda functions connect to DynamoDB tables to store application state and are triggered by CloudWatch Events for scheduled security scans. AWS WAF integrates with the Application Load Balancer to filter malicious requests before they reach backend instances. CloudTrail sends API logs to an encrypted S3 bucket which triggers Lambda functions to process and analyze security events. AWS Config monitors resource configurations and publishes compliance findings to SNS topics that notify Lambda functions to remediate drift. IAM roles attached to EC2 instances grant specific permissions to read from S3, write to DynamoDB, and publish to CloudWatch Logs. Security Groups restrict EC2 inbound traffic to only the Application Load Balancer while Lambda functions communicate with DynamoDB through security group rules allowing HTTPS on port 443. The template must be valid CloudFormation YAML that passes cfn-lint validation and deploys successfully in LocalStack.
