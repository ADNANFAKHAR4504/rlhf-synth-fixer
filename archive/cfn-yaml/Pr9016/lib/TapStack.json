{
    "AWSTemplateFormatVersion": "2010-09-09",
    "Description": "Production-ready infrastructure with EC2, S3, IAM, and security configurations - Region-locked to us-west-2",
    "Metadata": {
        "AWS::CloudFormation::Interface": {
            "ParameterGroups": [
                {
                    "Label": {
                        "default": "Network Configuration"
                    },
                    "Parameters": [
                        "AllowedSSHIP"
                    ]
                },
                {
                    "Label": {
                        "default": "Compute Configuration"
                    },
                    "Parameters": [
                        "InstanceType"
                    ]
                },
                {
                    "Label": {
                        "default": "Storage Configuration"
                    },
                    "Parameters": [
                        "S3BucketNameSuffix"
                    ]
                }
            ],
            "ParameterLabels": {
                "AllowedSSHIP": {
                    "default": "Allowed SSH IP Address"
                },
                "InstanceType": {
                    "default": "EC2 Instance Type"
                },
                "S3BucketNameSuffix": {
                    "default": "S3 Bucket Name Suffix"
                }
            }
        }
    },
    "Parameters": {
        "AllowedSSHIP": {
            "Description": "IP address allowed to SSH to the EC2 instance (e.g., 203.0.113.0/32)",
            "Type": "String",
            "AllowedPattern": "^(([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.){3}([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])(\\/([0-9]|[1-2][0-9]|3[0-2]))$",
            "ConstraintDescription": "Must be a valid IP CIDR range of the form x.x.x.x/x",
            "Default": "10.0.0.1/32"
        },
        "InstanceType": {
            "Description": "EC2 instance type for production workload",
            "Type": "String",
            "Default": "t3.micro",
            "AllowedValues": [
                "t3.micro",
                "t3.small",
                "t3.medium",
                "t3.large"
            ],
            "ConstraintDescription": "Must be a valid EC2 instance type (t3.micro or higher)"
        },
        "S3BucketNameSuffix": {
            "Description": "Suffix for S3 bucket name to ensure global uniqueness",
            "Type": "String",
            "Default": "prod-data",
            "AllowedPattern": "^[a-z0-9][a-z0-9-]*[a-z0-9]$",
            "ConstraintDescription": "Must contain only lowercase letters, numbers, and hyphens",
            "MinLength": 3,
            "MaxLength": 20
        },
        "LatestAmiId": {
            "Type": "AWS::SSM::Parameter::Value<AWS::EC2::Image::Id>",
            "Default": "/aws/service/ami-amazon-linux-latest/amzn2-ami-hvm-x86_64-gp2",
            "Description": "Latest Amazon Linux 2 AMI ID from SSM Parameter Store"
        }
    },
    "Rules": {
        "RegionRule": {
            "Assertions": [
                {
                    "Assert": {
                        "Fn::Equals": [
                            {
                                "Ref": "AWS::Region"
                            },
                            "us-west-2"
                        ]
                    },
                    "AssertDescription": "This stack can only be deployed in us-west-2 region for production compliance"
                }
            ]
        }
    },
    "Resources": {
        "ProdS3Bucket": {
            "Type": "AWS::S3::Bucket",
            "Properties": {
                "BucketName": {
                    "Fn::Sub": "prod-data-${AWS::AccountId}-${S3BucketNameSuffix}"
                },
                "VersioningConfiguration": {
                    "Status": "Enabled"
                },
                "BucketEncryption": {
                    "ServerSideEncryptionConfiguration": [
                        {
                            "ServerSideEncryptionByDefault": {
                                "SSEAlgorithm": "AES256"
                            }
                        }
                    ]
                },
                "PublicAccessBlockConfiguration": {
                    "BlockPublicAcls": true,
                    "BlockPublicPolicy": true,
                    "IgnorePublicAcls": true,
                    "RestrictPublicBuckets": true
                },
                "LifecycleConfiguration": {
                    "Rules": [
                        {
                            "Id": "DeleteOldVersions",
                            "Status": "Enabled",
                            "NoncurrentVersionExpirationInDays": 90
                        },
                        {
                            "Id": "TransitionToIA",
                            "Status": "Enabled",
                            "Transitions": [
                                {
                                    "StorageClass": "STANDARD_IA",
                                    "TransitionInDays": 30
                                }
                            ]
                        }
                    ]
                },
                "Tags": [
                    {
                        "Key": "Environment",
                        "Value": "Production"
                    },
                    {
                        "Key": "Name",
                        "Value": "ProdS3Bucket"
                    },
                    {
                        "Key": "ManagedBy",
                        "Value": "CloudFormation"
                    },
                    {
                        "Key": "iac-rlhf-amazon",
                        "Value": "true"
                    },
                    {
                        "Key": "Region",
                        "Value": "us-west-2"
                    }
                ]
            }
        },
        "ProdS3BucketPolicy": {
            "Type": "AWS::S3::BucketPolicy",
            "Properties": {
                "Bucket": {
                    "Ref": "ProdS3Bucket"
                },
                "PolicyDocument": {
                    "Statement": [
                        {
                            "Sid": "DenyInsecureConnections",
                            "Effect": "Deny",
                            "Principal": "*",
                            "Action": "s3:*",
                            "Resource": [
                                {
                                    "Fn::GetAtt": [
                                        "ProdS3Bucket",
                                        "Arn"
                                    ]
                                },
                                {
                                    "Fn::Sub": "${ProdS3Bucket.Arn}/*"
                                }
                            ],
                            "Condition": {
                                "Bool": {
                                    "aws:SecureTransport": false
                                }
                            }
                        }
                    ]
                }
            }
        },
        "ProdEC2Role": {
            "Type": "AWS::IAM::Role",
            "Properties": {
                "RoleName": {
                    "Fn::Sub": "ProdEC2Role-${AWS::StackName}"
                },
                "AssumeRolePolicyDocument": {
                    "Version": "2012-10-17",
                    "Statement": [
                        {
                            "Effect": "Allow",
                            "Principal": {
                                "Service": [
                                    "ec2.amazonaws.com"
                                ]
                            },
                            "Action": [
                                "sts:AssumeRole"
                            ]
                        }
                    ]
                },
                "ManagedPolicyArns": [
                    "arn:aws:iam::aws:policy/CloudWatchAgentServerPolicy",
                    "arn:aws:iam::aws:policy/AmazonSSMManagedInstanceCore"
                ],
                "Policies": [
                    {
                        "PolicyName": "ProdS3ReadOnlyPolicy",
                        "PolicyDocument": {
                            "Version": "2012-10-17",
                            "Statement": [
                                {
                                    "Sid": "S3BucketReadAccess",
                                    "Effect": "Allow",
                                    "Action": [
                                        "s3:GetObject",
                                        "s3:GetObjectVersion",
                                        "s3:GetObjectVersionTagging",
                                        "s3:GetObjectTagging",
                                        "s3:ListBucket",
                                        "s3:ListBucketVersions",
                                        "s3:GetBucketLocation",
                                        "s3:GetBucketVersioning"
                                    ],
                                    "Resource": [
                                        {
                                            "Fn::GetAtt": [
                                                "ProdS3Bucket",
                                                "Arn"
                                            ]
                                        },
                                        {
                                            "Fn::Sub": "${ProdS3Bucket.Arn}/*"
                                        }
                                    ]
                                },
                                {
                                    "Sid": "S3GeneralReadAccess",
                                    "Effect": "Allow",
                                    "Action": [
                                        "s3:ListAllMyBuckets",
                                        "s3:GetBucketLocation"
                                    ],
                                    "Resource": "*"
                                }
                            ]
                        }
                    }
                ],
                "Tags": [
                    {
                        "Key": "Environment",
                        "Value": "Production"
                    },
                    {
                        "Key": "Name",
                        "Value": "ProdEC2Role"
                    },
                    {
                        "Key": "ManagedBy",
                        "Value": "CloudFormation"
                    },
                    {
                        "Key": "iac-rlhf-amazon",
                        "Value": "true"
                    }
                ]
            }
        },
        "ProdEC2InstanceProfile": {
            "Type": "AWS::IAM::InstanceProfile",
            "Properties": {
                "InstanceProfileName": {
                    "Fn::Sub": "ProdEC2InstanceProfile-${AWS::StackName}"
                },
                "Roles": [
                    {
                        "Ref": "ProdEC2Role"
                    }
                ]
            }
        },
        "ProdKeyPair": {
            "Type": "AWS::EC2::KeyPair",
            "Properties": {
                "KeyName": {
                    "Fn::Sub": "prod-keypair-${AWS::StackName}"
                },
                "KeyType": "rsa",
                "Tags": [
                    {
                        "Key": "Environment",
                        "Value": "Production"
                    },
                    {
                        "Key": "Name",
                        "Value": "ProdKeyPair"
                    },
                    {
                        "Key": "ManagedBy",
                        "Value": "CloudFormation"
                    },
                    {
                        "Key": "iac-rlhf-amazon",
                        "Value": "true"
                    }
                ]
            }
        },
        "ProdVPC": {
            "Type": "AWS::EC2::VPC",
            "Properties": {
                "CidrBlock": "10.0.0.0/16",
                "EnableDnsSupport": true,
                "EnableDnsHostnames": true,
                "Tags": [
                    {
                        "Key": "Environment",
                        "Value": "Production"
                    },
                    {
                        "Key": "Name",
                        "Value": "ProdVPC"
                    },
                    {
                        "Key": "ManagedBy",
                        "Value": "CloudFormation"
                    },
                    {
                        "Key": "iac-rlhf-amazon",
                        "Value": "true"
                    }
                ]
            }
        },
        "ProdInternetGateway": {
            "Type": "AWS::EC2::InternetGateway",
            "Properties": {
                "Tags": [
                    {
                        "Key": "Environment",
                        "Value": "Production"
                    },
                    {
                        "Key": "Name",
                        "Value": "ProdInternetGateway"
                    },
                    {
                        "Key": "ManagedBy",
                        "Value": "CloudFormation"
                    },
                    {
                        "Key": "iac-rlhf-amazon",
                        "Value": "true"
                    }
                ]
            }
        },
        "ProdVPCGatewayAttachment": {
            "Type": "AWS::EC2::VPCGatewayAttachment",
            "Properties": {
                "VpcId": {
                    "Ref": "ProdVPC"
                },
                "InternetGatewayId": {
                    "Ref": "ProdInternetGateway"
                }
            }
        },
        "ProdPublicSubnet": {
            "Type": "AWS::EC2::Subnet",
            "Properties": {
                "VpcId": {
                    "Ref": "ProdVPC"
                },
                "CidrBlock": "10.0.1.0/24",
                "AvailabilityZone": {
                    "Fn::Select": [
                        0,
                        {
                            "Fn::GetAZs": ""
                        }
                    ]
                },
                "MapPublicIpOnLaunch": true,
                "Tags": [
                    {
                        "Key": "Environment",
                        "Value": "Production"
                    },
                    {
                        "Key": "Name",
                        "Value": "ProdPublicSubnet"
                    },
                    {
                        "Key": "ManagedBy",
                        "Value": "CloudFormation"
                    },
                    {
                        "Key": "iac-rlhf-amazon",
                        "Value": "true"
                    }
                ]
            }
        },
        "ProdPublicRouteTable": {
            "Type": "AWS::EC2::RouteTable",
            "Properties": {
                "VpcId": {
                    "Ref": "ProdVPC"
                },
                "Tags": [
                    {
                        "Key": "Environment",
                        "Value": "Production"
                    },
                    {
                        "Key": "Name",
                        "Value": "ProdPublicRouteTable"
                    },
                    {
                        "Key": "ManagedBy",
                        "Value": "CloudFormation"
                    },
                    {
                        "Key": "iac-rlhf-amazon",
                        "Value": "true"
                    }
                ]
            }
        },
        "ProdPublicRoute": {
            "Type": "AWS::EC2::Route",
            "Properties": {
                "RouteTableId": {
                    "Ref": "ProdPublicRouteTable"
                },
                "DestinationCidrBlock": "0.0.0.0/0",
                "GatewayId": {
                    "Ref": "ProdInternetGateway"
                }
            }
        },
        "ProdSubnetRouteTableAssociation": {
            "Type": "AWS::EC2::SubnetRouteTableAssociation",
            "Properties": {
                "SubnetId": {
                    "Ref": "ProdPublicSubnet"
                },
                "RouteTableId": {
                    "Ref": "ProdPublicRouteTable"
                }
            }
        },
        "ProdSecurityGroup": {
            "Type": "AWS::EC2::SecurityGroup",
            "Properties": {
                "GroupName": {
                    "Fn::Sub": "ProdSecurityGroup-${AWS::StackName}"
                },
                "GroupDescription": "Production security group for EC2 instance with restricted SSH access from specific IP",
                "VpcId": {
                    "Ref": "ProdVPC"
                },
                "SecurityGroupIngress": [
                    {
                        "IpProtocol": "tcp",
                        "FromPort": 22,
                        "ToPort": 22,
                        "CidrIp": {
                            "Ref": "AllowedSSHIP"
                        },
                        "Description": "SSH access from specified IP address only"
                    }
                ],
                "SecurityGroupEgress": [
                    {
                        "IpProtocol": "tcp",
                        "FromPort": 443,
                        "ToPort": 443,
                        "CidrIp": "0.0.0.0/0",
                        "Description": "HTTPS outbound for AWS services and updates"
                    },
                    {
                        "IpProtocol": "tcp",
                        "FromPort": 80,
                        "ToPort": 80,
                        "CidrIp": "0.0.0.0/0",
                        "Description": "HTTP outbound for package repository access"
                    },
                    {
                        "IpProtocol": "tcp",
                        "FromPort": 53,
                        "ToPort": 53,
                        "CidrIp": "0.0.0.0/0",
                        "Description": "DNS resolution"
                    },
                    {
                        "IpProtocol": "udp",
                        "FromPort": 53,
                        "ToPort": 53,
                        "CidrIp": "0.0.0.0/0",
                        "Description": "DNS resolution UDP"
                    }
                ],
                "Tags": [
                    {
                        "Key": "Environment",
                        "Value": "Production"
                    },
                    {
                        "Key": "Name",
                        "Value": "ProdSecurityGroup"
                    },
                    {
                        "Key": "ManagedBy",
                        "Value": "CloudFormation"
                    },
                    {
                        "Key": "iac-rlhf-amazon",
                        "Value": "true"
                    }
                ]
            }
        },
        "ProdEC2Instance": {
            "Type": "AWS::EC2::Instance",
            "Properties": {
                "ImageId": {
                    "Ref": "LatestAmiId"
                },
                "InstanceType": {
                    "Ref": "InstanceType"
                },
                "KeyName": {
                    "Ref": "ProdKeyPair"
                },
                "IamInstanceProfile": {
                    "Ref": "ProdEC2InstanceProfile"
                },
                "SubnetId": {
                    "Ref": "ProdPublicSubnet"
                },
                "SecurityGroupIds": [
                    {
                        "Fn::GetAtt": [
                            "ProdSecurityGroup",
                            "GroupId"
                        ]
                    }
                ],
                "BlockDeviceMappings": [
                    {
                        "DeviceName": "/dev/xvda",
                        "Ebs": {
                            "VolumeType": "gp3",
                            "VolumeSize": 20,
                            "Encrypted": true,
                            "DeleteOnTermination": true,
                            "Iops": 3000
                        }
                    }
                ],
                "Monitoring": true,
                "UserData": {
                    "Fn::Base64": {
                        "Fn::Sub": "#!/bin/bash -xe\n# Log all output for debugging\nexec > >(tee /var/log/user-data.log|logger -t user-data -s 2>/dev/console) 2>&1\n\n# Update system packages\nyum update -y\n\n# Install essential tools\nyum install -y aws-cli amazon-cloudwatch-agent amazon-ssm-agent jq\n\n# Enable and start SSM agent for Session Manager access\nsystemctl enable amazon-ssm-agent\nsystemctl start amazon-ssm-agent\n\n# Create application directory structure\nmkdir -p /opt/prod-app/{data,logs,config}\n\n# Configure AWS CLI with region\naws configure set region ${AWS::Region}\naws configure set output json\n\n# Verify S3 bucket access\necho \"Testing S3 read access to ${ProdS3Bucket}\"\nif aws s3 ls s3://${ProdS3Bucket}/ --region ${AWS::Region}; then\n    echo \"SUCCESS: S3 bucket access verified\" > /opt/prod-app/s3-test.txt\nelse\n    echo \"ERROR: Cannot access S3 bucket\" > /opt/prod-app/s3-test.txt\nfi\n\n# Create detailed status file\ncat > /opt/prod-app/status.txt << EOF\nProduction EC2 Instance Status Report\n=====================================\nInitialization Time: $(date)\nInstance ID: $(ec2-metadata --instance-id | cut -d \" \" -f 2)\nInstance Type: $(ec2-metadata --instance-type | cut -d \" \" -f 2)\nAvailability Zone: $(ec2-metadata --availability-zone | cut -d \" \" -f 2)\nRegion: ${AWS::Region}\nS3 Bucket: ${ProdS3Bucket}\nIAM Role: ${ProdEC2Role}\nStack Name: ${AWS::StackName}\nEnvironment: Production\nEOF\n\n# Set up CloudWatch logs\ncat > /opt/aws/amazon-cloudwatch-agent/etc/cloudwatch-config.json << EOF\n{\n  \"logs\": {\n    \"logs_collected\": {\n      \"files\": {\n        \"collect_list\": [\n          {\n            \"file_path\": \"/var/log/messages\",\n            \"log_group_name\": \"/aws/ec2/prod/system\",\n            \"log_stream_name\": \"{instance_id}\"\n          }\n        ]\n      }\n    }\n  }\n}\nEOF\n\n# Start CloudWatch agent\n/opt/aws/amazon-cloudwatch-agent/bin/amazon-cloudwatch-agent-ctl \\\n  -a fetch-config \\\n  -m ec2 \\\n  -c file:/opt/aws/amazon-cloudwatch-agent/etc/cloudwatch-config.json \\\n  -s\n\n# Send CloudFormation success signal\n/opt/aws/bin/cfn-signal -e $? --stack ${AWS::StackName} --resource ProdEC2Instance --region ${AWS::Region}\n"
                    }
                },
                "Tags": [
                    {
                        "Key": "Environment",
                        "Value": "Production"
                    },
                    {
                        "Key": "Name",
                        "Value": "ProdEC2Instance"
                    },
                    {
                        "Key": "ManagedBy",
                        "Value": "CloudFormation"
                    },
                    {
                        "Key": "iac-rlhf-amazon",
                        "Value": "true"
                    },
                    {
                        "Key": "Backup",
                        "Value": "Daily"
                    },
                    {
                        "Key": "OS",
                        "Value": "AmazonLinux2"
                    }
                ]
            },
            "CreationPolicy": {
                "ResourceSignal": {
                    "Timeout": "PT15M"
                }
            }
        },
        "ProdEC2CPUAlarm": {
            "Type": "AWS::CloudWatch::Alarm",
            "Properties": {
                "AlarmName": {
                    "Fn::Sub": "ProdEC2-HighCPU-${AWS::StackName}"
                },
                "AlarmDescription": "Alert when CPU utilization exceeds 80% for 5 minutes",
                "MetricName": "CPUUtilization",
                "Namespace": "AWS/EC2",
                "Statistic": "Average",
                "Period": 300,
                "EvaluationPeriods": 1,
                "Threshold": 80,
                "ComparisonOperator": "GreaterThanThreshold",
                "Dimensions": [
                    {
                        "Name": "InstanceId",
                        "Value": {
                            "Ref": "ProdEC2Instance"
                        }
                    }
                ],
                "TreatMissingData": "notBreaching",
                "Tags": [
                    {
                        "Key": "Environment",
                        "Value": "Production"
                    },
                    {
                        "Key": "Name",
                        "Value": "ProdEC2CPUAlarm"
                    },
                    {
                        "Key": "ManagedBy",
                        "Value": "CloudFormation"
                    },
                    {
                        "Key": "iac-rlhf-amazon",
                        "Value": "true"
                    }
                ]
            }
        },
        "ProdEC2DiskAlarm": {
            "Type": "AWS::CloudWatch::Alarm",
            "Properties": {
                "AlarmName": {
                    "Fn::Sub": "ProdEC2-LowDiskSpace-${AWS::StackName}"
                },
                "AlarmDescription": "Alert when disk usage exceeds 85%",
                "MetricName": "DiskSpaceUtilization",
                "Namespace": "CWAgent",
                "Statistic": "Average",
                "Period": 300,
                "EvaluationPeriods": 2,
                "Threshold": 85,
                "ComparisonOperator": "GreaterThanThreshold",
                "Dimensions": [
                    {
                        "Name": "InstanceId",
                        "Value": {
                            "Ref": "ProdEC2Instance"
                        }
                    },
                    {
                        "Name": "ImageId",
                        "Value": {
                            "Ref": "LatestAmiId"
                        }
                    },
                    {
                        "Name": "InstanceType",
                        "Value": {
                            "Ref": "InstanceType"
                        }
                    },
                    {
                        "Name": "Path",
                        "Value": "/"
                    },
                    {
                        "Name": "FileSystemType",
                        "Value": "xfs"
                    }
                ],
                "TreatMissingData": "notBreaching",
                "Tags": [
                    {
                        "Key": "Environment",
                        "Value": "Production"
                    },
                    {
                        "Key": "Name",
                        "Value": "ProdEC2DiskAlarm"
                    },
                    {
                        "Key": "ManagedBy",
                        "Value": "CloudFormation"
                    },
                    {
                        "Key": "iac-rlhf-amazon",
                        "Value": "true"
                    }
                ]
            }
        }
    },
    "Outputs": {
        "S3BucketName": {
            "Description": "Name of the production S3 bucket with versioning enabled",
            "Value": {
                "Ref": "ProdS3Bucket"
            },
            "Export": {
                "Name": {
                    "Fn::Sub": "${AWS::StackName}-ProdS3BucketName"
                }
            }
        },
        "EC2InstancePublicDNS": {
            "Description": "Public DNS name of the EC2 instance for external access",
            "Value": {
                "Fn::GetAtt": [
                    "ProdEC2Instance",
                    "PublicDnsName"
                ]
            },
            "Export": {
                "Name": {
                    "Fn::Sub": "${AWS::StackName}-ProdEC2PublicDNS"
                }
            }
        },
        "S3BucketArn": {
            "Description": "ARN of the production S3 bucket for IAM policy references",
            "Value": {
                "Fn::GetAtt": [
                    "ProdS3Bucket",
                    "Arn"
                ]
            },
            "Export": {
                "Name": {
                    "Fn::Sub": "${AWS::StackName}-ProdS3BucketArn"
                }
            }
        },
        "S3BucketDomainName": {
            "Description": "Domain name of the S3 bucket for direct access",
            "Value": {
                "Fn::GetAtt": [
                    "ProdS3Bucket",
                    "DomainName"
                ]
            },
            "Export": {
                "Name": {
                    "Fn::Sub": "${AWS::StackName}-ProdS3BucketDomain"
                }
            }
        },
        "EC2InstanceId": {
            "Description": "Instance ID of the production EC2 instance",
            "Value": {
                "Ref": "ProdEC2Instance"
            },
            "Export": {
                "Name": {
                    "Fn::Sub": "${AWS::StackName}-ProdEC2InstanceId"
                }
            }
        },
        "EC2InstancePublicIP": {
            "Description": "Public IP address of the EC2 instance",
            "Value": {
                "Fn::GetAtt": [
                    "ProdEC2Instance",
                    "PublicIp"
                ]
            },
            "Export": {
                "Name": {
                    "Fn::Sub": "${AWS::StackName}-ProdEC2PublicIP"
                }
            }
        },
        "EC2InstancePrivateIP": {
            "Description": "Private IP address of the EC2 instance for VPC internal communication",
            "Value": {
                "Fn::GetAtt": [
                    "ProdEC2Instance",
                    "PrivateIp"
                ]
            },
            "Export": {
                "Name": {
                    "Fn::Sub": "${AWS::StackName}-ProdEC2PrivateIP"
                }
            }
        },
        "EC2InstanceAvailabilityZone": {
            "Description": "Availability Zone where the EC2 instance is deployed",
            "Value": {
                "Fn::GetAtt": [
                    "ProdEC2Instance",
                    "AvailabilityZone"
                ]
            },
            "Export": {
                "Name": {
                    "Fn::Sub": "${AWS::StackName}-ProdEC2AZ"
                }
            }
        },
        "IAMRoleArn": {
            "Description": "ARN of the IAM role attached to EC2 instance",
            "Value": {
                "Fn::GetAtt": [
                    "ProdEC2Role",
                    "Arn"
                ]
            },
            "Export": {
                "Name": {
                    "Fn::Sub": "${AWS::StackName}-ProdEC2RoleArn"
                }
            }
        },
        "IAMRoleName": {
            "Description": "Name of the IAM role for reference in policies",
            "Value": {
                "Ref": "ProdEC2Role"
            },
            "Export": {
                "Name": {
                    "Fn::Sub": "${AWS::StackName}-ProdEC2RoleName"
                }
            }
        },
        "SecurityGroupId": {
            "Description": "Security Group ID for the EC2 instance",
            "Value": {
                "Fn::GetAtt": [
                    "ProdSecurityGroup",
                    "GroupId"
                ]
            },
            "Export": {
                "Name": {
                    "Fn::Sub": "${AWS::StackName}-ProdSecurityGroupId"
                }
            }
        },
        "SSHCommand": {
            "Description": "Complete SSH connection command for administrative access",
            "Value": {
                "Fn::Sub": "ssh -i ~/.ssh/${ProdKeyPair}.pem ec2-user@${ProdEC2Instance.PublicDnsName}"
            }
        },
        "SessionManagerURL": {
            "Description": "AWS Session Manager URL for browser-based access",
            "Value": {
                "Fn::Sub": "https://${AWS::Region}.console.aws.amazon.com/systems-manager/session-manager/${ProdEC2Instance}?region=${AWS::Region}"
            }
        },
        "S3BucketURL": {
            "Description": "S3 bucket console URL for management",
            "Value": {
                "Fn::Sub": "https://s3.console.aws.amazon.com/s3/buckets/${ProdS3Bucket}?region=${AWS::Region}"
            }
        },
        "StackRegion": {
            "Description": "AWS Region where the stack is deployed (must be us-west-2)",
            "Value": {
                "Ref": "AWS::Region"
            }
        },
        "CloudWatchDashboardURL": {
            "Description": "URL to CloudWatch dashboard for monitoring",
            "Value": {
                "Fn::Sub": "https://${AWS::Region}.console.aws.amazon.com/cloudwatch/home?region=${AWS::Region}#dashboards:"
            }
        },
        "DeploymentTimestamp": {
            "Description": "Timestamp when the stack was created or last updated",
            "Value": {
                "Ref": "AWS::StackId"
            }
        }
    }
}