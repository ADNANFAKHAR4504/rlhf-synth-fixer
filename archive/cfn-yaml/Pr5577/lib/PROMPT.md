Create a secure and scalable AWS infrastructure using CloudFormation in YAML format that follows best security and compliance practices. The architecture should include IAM roles for service-specific permissions instead of using root credentials and ensure all EC2 instances run within a properly configured VPC. Encrypt all S3 buckets using AWS KMS and apply lifecycle policies to manage storage efficiently. Configure RDS instances to be private and encrypted, and deploy an application load balancer with SSL termination along with ELB logging and EC2 detailed monitoring enabled. Integrate CloudTrail across all regions for auditing, use AWS Config to track configuration changes, and connect Lambda functions to the VPC while managing configuration through environment variables and Secrets Manager for secure secret rotation. Ensure CloudFront distributions serve content over HTTPS only, and apply GuardDuty for threat detection and AWS WAF for web application protection. Implement Auto Scaling groups for EC2 instances to handle varying workloads and restrict SSH access using key pairs. Establish multi-region redundancy for critical services, and ensure all unused resources are cleaned up automatically. The output should be a validated CloudFormation YAML template named secure-infra-template.yaml that deploys successfully and meets all listed security requirements.
