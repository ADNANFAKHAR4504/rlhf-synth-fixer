Our fintech startup is preparing to launch a payment processing platform. As the lead infrastructure engineer, you've been tasked with establishing a production ready network foundation in AWS that will support the company's three tier application architecture while meeting stringent security and compliance requirements for financial services.

The infrastructure needs to be deployed with a VPC using the 10.0.0.0/16 CIDR block to accommodate future growth. Your network design must span three availability zones to ensure high availability and fault tolerance. The public facing tier will host your web servers in three public subnets using 10.0.1.0/24, 10.0.2.0/24, and 10.0.3.0/24, each mapped to a different availability zone. These subnets require direct internet access through an Internet Gateway for serving customer traffic.

The application and database tiers will reside in private subnets with 10.0.11.0/24, 10.0.12.0/24, and 10.0.13.0/24 that mirror the availability zone distribution of the public subnets. While these resources shouldn't be directly accessible from the internet, they still need outbound connectivity for software updates and third party API integrations. To achieve this, you'll need to deploy NAT Gateways in each public subnet, ensuring that private resources in each availability zone have redundant paths for outbound traffic through their zone specific NAT Gateway.

You need to implement two distinct security groups: one for the web tier that permits HTTPS traffic on port 443 from any source with unrestricted outbound connectivity, and another for the database tier that restricts MySQL access on port 3306 exclusively to resources within the VPC CIDR range. The routing configuration must ensure that public subnets route internet bound traffic with destination 0.0.0.0/0 through the Internet Gateway, while private subnets route their internet bound traffic through their respective zone specific NAT Gateways.

All resources must be tagged with Environment=Production, Project=FinTech and Owner set to the stack name. The naming convention for gateways should follow the pattern StackName-ResourceType-AZ to maintain consistency across the infrastructure. Your CloudFormation template should use intrinsic functions for dynamic resource referencing and must export critical resource IDs.

Create a single comprehensive CloudFormation YAML template that implements this entire network architecture, ensuring all dependencies are properly defined and the template passes AWS CloudFormation validation. The template should be production ready with DNS hostnames and DNS resolution enabled on the VPC to support service discovery and private hosted zones.
