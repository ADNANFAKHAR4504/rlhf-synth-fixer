Create a CloudFormation template in YAML format that sets up a complete secure production environment in the US East Virginia region spanning two availability zones. The template needs to establish a VPC with CIDR block ten dot zero dot zero dot zero slash sixteen containing both public and private subnets in each availability zone following the naming pattern project dash environment dash subnet dash type. Configure IAM roles and policies that enforce least privilege access principles and restrict SSH access to specific IP addresses only through security groups. All data must be encrypted both at rest using AWS KMS with automatic key rotation enabled and in transit. Set up an autoscaling group that maintains a minimum of three EC2 instances at all times to handle variable loads with CloudWatch alarms monitoring for any unexpected scaling events. Deploy an Application Load Balancer to distribute HTTP and HTTPS traffic across the EC2 instances in multiple availability zones. Create RDS database instances with multi availability zone configuration for high availability. Enable CloudTrail to track and audit all API calls across the AWS account with logs stored in an encrypted S3 bucket that has versioning enabled. Implement AWS Config rules to continuously monitor and detect any non compliant resources. Store all sensitive configuration data securely using AWS Systems Manager Parameter Store. Set up CloudFront for caching static content from S3. Ensure Lambda functions use encrypted environment variables. Provision a bastion host for secure administrative access. Configure automatic daily backups for all critical resources. Apply consistent resource tagging across all components using Environment Owner and Project tags. Include a patch management policy for EC2 instances. The final template must pass CloudFormation validation and deploy successfully without any errors while meeting all AWS security and compliance best practices.