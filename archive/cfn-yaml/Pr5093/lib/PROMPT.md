Create a secure and scalable AWS infrastructure using CloudFormation in YAML format for a production environment in the us-east-1 region. The setup should include a custom VPC with two public and two private subnets distributed across different availability zones. Configure security groups to allow HTTP and HTTPS traffic only on public subnets and restrict SSH access to a specific range of IP addresses. Implement IAM roles for EC2 instances following the principle of least privilege and ensure all IAM users have Multi-Factor Authentication enabled. Enable detailed monitoring for all EC2 instances and configure an Auto Scaling Group with a minimum of two and a maximum of six instances to handle variable workloads. Store all logs in an S3 bucket with versioning enabled and a lifecycle policy to delete logs older than thirty days. Ensure all RDS data is encrypted using AWS KMS, and tag all security-related resources with Environment:Prod. The output should be a validated CloudFormation YAML template that meets AWS best practices and is ready for deployment in a production environment.
