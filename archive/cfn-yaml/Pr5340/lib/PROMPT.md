Create a secure AWS infrastructure using CloudFormation in YAML format focusing on strong identity and access management and resource-level security. The architecture should include a VPC with public and private subnets across two availability zones and deploy EC2 instances using the latest Amazon Linux 2 as t2.micro with CloudWatch logging enabled. Configure an RDS instance with automatic backups retained for at least seven days and ensure all data at rest in S3 buckets is encrypted with versioning enabled. Use AWS Managed Policies to implement IAM roles and policies that follow the principle of least privilege and enforce Multi-Factor Authentication for all IAM users with console access. Implement a CloudTrail trail to capture management events and store logs securely in an S3 bucket. Restrict S3 bucket access to specific IP addresses and configure an Application Load Balancer with an SSL certificate from AWS Certificate Manager. Use AWS Config Rules to monitor compliance across resources and ensure all EC2 instances have SSH access limited to a predefined IP range. The final output should be a validated CloudFormation YAML template that deploys all resources in the us-east-1 region according to AWS best practices and corporate compliance requirements.
