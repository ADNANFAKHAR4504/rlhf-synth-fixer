Create a single CloudFormation template that provisions the complete AWS infrastructure for Meridian Financial Services, a company currently migrating their legacy Oracle based transaction processing system to a containerized architecture on AWS. The company processes millions of financial transactions daily and requires a zero-downtime migration strategy that maintains operations during their peak business hours.

Your CloudFormation template must establish a Multi-AZ infrastructure that deploys the containerized application using ECS Fargate with specific resource allocations of 2 vCPU and 4 GB memory per task. The networking foundation should consist of a VPC spanning three availability zones, with three public subnets hosting an Application Load Balancer and three private subnets containing the ECS tasks and an Aurora PostgreSQL Multi-AZ cluster. Configure NAT Gateways in each availability zone to provide outbound internet connectivity for the private resources while maintaining network isolation. The Application Load Balancer must perform health checks against the '/health' endpoint and distribute traffic only to healthy container instances.

For the database tier, provision an Aurora PostgreSQL cluster with Multi-AZ configuration, implementing custom parameter groups that optimize max_connections and shared_buffers for the expected transaction volume. The database credentials must be stored in AWS Secrets Manager with automatic rotation every 30 days, and the ECS tasks should retrieve these credentials at runtime using IAM roles with least-privilege permissions. Implement automated backup replication to a separate AWS account for disaster recovery compliance, ensuring that the backup retention meets the regulatory requirements.

Security configurations must include customer managed KMS keys for encrypting CloudWatch Logs, which need a 7 year retention policy to meet audit requirements. Define security groups that enforce strict network segmentation, permitting only essential ports between the application and database tiers while restricting database communication to private subnets. The ECS task definitions must specify that containers run as non root users to satisfy security scanning requirements. Implement Auto Scaling for the ECS service with target tracking on CPU utilization at 70% to handle variable transaction loads, and configure an SNS topic for operational alerts that notifies the DevOps team via email subscriptions.

The template should utilize CloudFormation parameters for environment specific values such as environment name, cost center codes and data classification levels, ensuring all resources are tagged appropriately for compliance tracking. Include CloudFormation outputs that expose critical endpoints and Implement rollback triggers based on the health of critical resources to ensure safe deployments and automatic rollback if issues are detected during stack creation or updates. The entire infrastructure must support blue-green deployment patterns for future application updates without service interruption, maintaining the financial services company's commitment to continuous availability during their digital transformation journey.