Create a CloudFormation YAML template that provisions a secure and compliant AWS infrastructure in the us-east-1 region, ensuring all resources follow production security standards. The environment must include EC2 instances that use IAM roles with only the minimal required permissions and store all sensitive information such as passwords in AWS Systems Manager Parameter Store for secure retrieval. Configure S3 buckets with server access logging directed to a dedicated non-public logging bucket. Enable AWS CloudTrail to record all account activity with a minimum retention period of ninety days. Build a custom VPC spanning two availability zones with both public and private subnets, and deploy NAT Gateways in the public subnets to provide internet access for private resources. Use an Application Load Balancer with SSL termination for secure inbound traffic handling. Ensure all EBS volumes are encrypted and enable detailed monitoring for all EC2 instances. Define security groups using least privilege rules and activate AWS Config to monitor compliance against defined security controls. Set up a Systems Manager maintenance window to regularly apply patches to EC2 instances and deploy an RDS PostgreSQL database with encryption and automatic backups enabled. The output should be a CloudFormation YAML file named secure_infrastructure.yml that successfully deploys a fully functional, secure, and compliant AWS environment.
