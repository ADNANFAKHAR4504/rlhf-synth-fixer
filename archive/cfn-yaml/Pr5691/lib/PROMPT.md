Design a secure AWS VPC architecture using CloudFormation in YAML that creates a VPC with the CIDR block 10.0.0.0/16, containing two public subnets and two private subnets across different availability zones. Configure an Internet Gateway for public access and a NAT Gateway in one of the public subnets to allow outbound traffic from private instances. Set up route tables to ensure proper routing between subnets and gateways. Create security groups that allow SSH access only from a specific IP range and launch an EC2 instance in a private subnet with an IAM role granting limited permissions to access S3 while denying other unnecessary services. Enable CloudTrail to capture all API activity within the VPC and store the logs securely in an S3 bucket with access logging enabled. Ensure all resources are tagged with Environment: Production and that the architecture follows AWS best practices for cost efficiency, availability, and security. The output should be a valid and deployable CloudFormation YAML template that meets all the specified requirements.
