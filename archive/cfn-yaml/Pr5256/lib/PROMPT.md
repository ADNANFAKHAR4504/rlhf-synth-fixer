Create a CloudFormation YAML template that defines a fully automated, multi-environment CI/CD pipeline for a containerized microservices application. The solution should use only native AWS services, including CodePipeline for orchestration, CodeBuild for Docker image builds and unit tests, and CodeDeploy for ECS Blue/Green deployments. The pipeline must connect to a GitHub repository using an OAuth token stored in Secrets Manager, automatically trigger on code commits, and include a manual approval stage between staging and production via SNS notifications.

Each environment—development, staging, and production—should be parameterized and support deployment across multiple AWS accounts and regions (primarily **us-east-1** with replication to **eu-west-1**). Build artifacts should be stored in versioned S3 buckets with encryption enabled and lifecycle policies for cost optimization. Implement CloudWatch alarms to handle rollback on deployment failures and Lambda functions for custom validation steps.

Ensure IAM roles follow the principle of least privilege, all resources have proper encryption, and VPC endpoints are configured to prevent dependency on internet gateways. Use CloudFormation conditions for environment-specific configurations, and configure CloudWatch Logs with a 30-day retention policy. The end result should be a production-ready YAML CloudFormation template that provides a secure, scalable, and automated CI/CD pipeline for containerized workloads.
