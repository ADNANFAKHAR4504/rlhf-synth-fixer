I need one CloudFormation template in YAML, nothing else. Please reply with a single fenced code block that contains the file lib/tapstack.yaml. No placeholders—use safe defaults—and aim for clean cfn-lint/CloudFormation validation.

I’m including the exact requirements block below. Don’t edit it; treat it as the source of truth.

Environment: You are tasked with setting up a secure infrastructure for a web application using AWS CloudFormation. The environment requires a complex security configuration due to compliance requirements. Your tasks include: 1. Use AWS CloudFormation to define the security configuration; 2. Ensure all IAM roles have the least privilege necessary; 3. Enable logging for all AWS services used in the stack; 4. Create an S3 bucket with versioning and server-side encryption enabled; 5. Configure VPC with at least two public and two private subnets; 6. Ensure Security Groups allow only necessary inbound/outbound traffic; 7. Implement an AWS IAM Policy that restricts users from deleting CloudTrail logs; 8. Set up AWS Config to monitor changes in security settings; 9. Enable AWS Security Hub for the account to gather security insights; 10. Define a KMS key policy that grants access only to necessary services and roles; 11. Use CloudFormation Parameter Store to manage sensitive configuration values; 12. Include CloudWatch Alarms for monitoring unauthorized access attempts; 13. Ensure all Lambda functions have execution roles defined.\nExpected output: A YAML CloudFormation template implementing all of the above security configurations. The template should validate successfully with AWS CloudFormation, and all implemented features should positively affect the security posture of the environment. Include test cases to ensure compliance and the effectiveness of security settings. 

Constraints Items: Use AWS CloudFormation to define the security configuration. | Ensure all IAM roles have the least privilege necessary. | Enable logging for all AWS services used in the stack. | Create an S3 bucket with versioning and server-side encryption enabled. | Configure VPC with at least two public and two private subnets. | Ensure Security Groups allow only necessary inbound/outbound traffic. | Implement an AWS IAM Policy that restricts users from deleting CloudTrail logs. | Set up AWS Config to monitor changes in security settings. | Enable AWS Security Hub for the account to gather security insights. | Define a KMS key policy that grants access only to necessary services and roles. | Use CloudFormation Parameter Store to manage sensitive configuration values. | Include CloudWatch Alarms for monitoring unauthorized access attempts. | Ensure all Lambda functions have execution roles defined.

Proposed Statement: The infrastructure will be deployed in the us-west-2 region. All resources should follow the naming convention of <resource-type>-<project-name>-<environment>. Use AWS CloudFormation templates written in YAML format.


A couple practical notes so the output is usable right away:

Put the usual top-level sections in the YAML: AWSTemplateFormatVersion, Description, Parameters, Conditions, Resources, and Outputs.

Keep IAM “least privilege,” avoid named IAM (no RoleName/UserName), and make the stack configurable via parameters like project/env, CIDRs, and toggles for Security Hub / AWS Config.

Please stick to one output: a single fenced YAML block that represents lib/tapstack.yaml.