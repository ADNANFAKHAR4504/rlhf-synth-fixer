Create a CloudFormation YAML template to deploy a secure and highly available web application in the us-east-1 region following AWS best security practices. The architecture should use AWS IAM to manage access through roles and policies that follow the principle of least privilege and enforce Multi-Factor Authentication for all IAM users. All resources must be tagged with Environment:Production. Ensure all S3 buckets use server-side encryption and access them only through VPC Endpoints to prevent public exposure. Deploy AWS WAF to protect the web application from common attacks and enable AWS CloudTrail to record all API activities. Use AWS Config Rules to monitor configuration compliance and detect resource drift. Configure Lambda functions with dedicated least-privilege IAM roles and attach the minimum necessary permissions. Deploy an Application Load Balancer to distribute traffic across multiple Availability Zones, ensuring fault tolerance through Auto Scaling Groups for EC2 instances. Set up DynamoDB with point-in-time recovery for backup resilience and define Security Groups with tightly controlled inbound and outbound traffic rules. The final CloudFormation YAML template must be valid, pass cfn-lint checks, and fully deploy all resources securely in a production AWS environment.
