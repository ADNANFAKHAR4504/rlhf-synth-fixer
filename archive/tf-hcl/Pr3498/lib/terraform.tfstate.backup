{
  "version": 4,
  "terraform_version": "1.5.7",
  "serial": 54,
  "lineage": "89a423ea-5ebb-19dd-4565-7253b266fb9a",
  "outputs": {
    "cloudtrail_arn": {
      "value": "arn:aws:cloudtrail:us-east-1:342597974367:trail/security-monitoring-trail-synth78029461",
      "type": "string"
    },
    "cloudtrail_bucket": {
      "value": "security-cloudtrail-logs-synth78029461-342597974367",
      "type": "string"
    },
    "guardduty_detector_id": {
      "value": "9db057715ebe4b86bae37035cdc0985e",
      "type": "string"
    },
    "kms_key_id": {
      "value": "3ee92177-ce64-4479-9a75-ee6cd897b841",
      "type": "string"
    },
    "lambda_function_name": {
      "value": "security-custom-rules-processor-synth78029461",
      "type": "string"
    },
    "log_group_name": {
      "value": "/aws/security/events-synth78029461",
      "type": "string"
    },
    "security_hub_arn": {
      "value": "arn:aws:securityhub:us-east-1:342597974367:hub/default",
      "type": "string"
    },
    "security_team_role_arn": {
      "value": "arn:aws:iam::342597974367:role/SecurityTeamRole-synth78029461",
      "type": "string"
    },
    "sns_topic_arn": {
      "value": "arn:aws:sns:us-east-1:342597974367:security-monitoring-alerts-synth78029461",
      "type": "string"
    }
  },
  "resources": [
    {
      "mode": "data",
      "type": "archive_file",
      "name": "lambda_zip",
      "provider": "provider[\"registry.terraform.io/hashicorp/archive\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "exclude_symlink_directories": null,
            "excludes": null,
            "id": "5724720b4d6f8aecba09a66a64220b3b09775d3b",
            "output_base64sha256": "2GNl2kQkz9X3BLxMzNjGklXyQi7gBrkc1GfUyal5Ww4=",
            "output_base64sha512": "czQuMQEJRK08qLHfx1WTwuaFrUeVDBJFJW70eIhHWPeXuggK/VrlNw2taX1/KSP0PzrTaxqRDkXl2mHvLwjywQ==",
            "output_file_mode": null,
            "output_md5": "bf7d0b09f62d5feb33ae1be1c5a7cd4c",
            "output_path": "/tmp/lambda_function.zip",
            "output_sha": "5724720b4d6f8aecba09a66a64220b3b09775d3b",
            "output_sha256": "d86365da4424cfd5f704bc4cccd8c69255f2422ee006b91cd467d4c9a9795b0e",
            "output_sha512": "73342e31010944ad3ca8b1dfc75593c2e685ad47950c1245256ef478884758f797ba080afd5ae5370dad697d7f2923f43f3ad36b1a910e45e5da61ef2f08f2c1",
            "output_size": 1602,
            "source": [
              {
                "content": "import json\nimport boto3\nimport os\nfrom datetime import datetime\n\nsns = boto3.client('sns')\nlogs = boto3.client('logs')\n\ndef handler(event, context):\n    \"\"\"\n    Process security findings and add custom tags based on patterns\n    \"\"\"\n    print(f\"Processing event: {json.dumps(event)}\")\n\n    try:\n        # Parse the incoming security event\n        if 'detail' in event:\n            detail = event['detail']\n\n            # Extract finding details\n            findings = detail.get('findings', [detail])\n\n            for finding in findings:\n                # Add custom tags based on event patterns\n                custom_tags = analyze_finding(finding)\n\n                # Enrich the finding with custom tags\n                enriched_finding = {\n                    **finding,\n                    'CustomTags': custom_tags,\n                    'ProcessedAt': datetime.utcnow().isoformat()\n                }\n\n                # Log enriched finding\n                log_finding(enriched_finding)\n\n                # Send critical findings to SNS\n                if is_critical(finding):\n                    notify_security_team(enriched_finding)\n\n        return {\n            'statusCode': 200,\n            'body': json.dumps('Successfully processed security finding')\n        }\n\n    except Exception as e:\n        print(f\"Error processing event: {str(e)}\")\n        return {\n            'statusCode': 500,\n            'body': json.dumps(f'Error: {str(e)}')\n        }\n\ndef analyze_finding(finding):\n    \"\"\"\n    Analyze finding and return custom tags\n    \"\"\"\n    tags = []\n\n    # Check for specific patterns\n    title = finding.get('Title', '').lower()\n    description = finding.get('Description', '').lower()\n\n    if 'root' in title or 'root' in description:\n        tags.append('ROOT_ACTIVITY')\n\n    if 'public' in title or 'exposed' in description:\n        tags.append('PUBLIC_EXPOSURE')\n\n    if 'cryptocurrency' in description or 'mining' in description:\n        tags.append('CRYPTO_MINING')\n\n    if 'malware' in title or 'malware' in description:\n        tags.append('MALWARE_DETECTED')\n\n    if 'unauthorized' in title or 'suspicious' in description:\n        tags.append('SUSPICIOUS_ACTIVITY')\n\n    # Add severity-based tags\n    severity = finding.get('Severity', {})\n    if isinstance(severity, dict):\n        label = severity.get('Label', '')\n    else:\n        label = str(severity)\n\n    if label in ['CRITICAL', 'HIGH']:\n        tags.append('IMMEDIATE_ACTION')\n\n    return tags\n\ndef is_critical(finding):\n    \"\"\"\n    Determine if finding requires immediate notification\n    \"\"\"\n    severity = finding.get('Severity', {})\n    if isinstance(severity, dict):\n        label = severity.get('Label', '')\n        normalized = severity.get('Normalized', 0)\n    else:\n        label = str(severity)\n        normalized = 0\n\n    return label in ['CRITICAL', 'HIGH'] or normalized \u003e= 70\n\ndef log_finding(finding):\n    \"\"\"\n    Log enriched finding to CloudWatch\n    \"\"\"\n    log_group = os.environ.get('LOG_GROUP', '/aws/security/events')\n\n    try:\n        logs.put_log_events(\n            logGroupName=log_group,\n            logStreamName='custom-rules-processor',\n            logEvents=[\n                {\n                    'timestamp': int(datetime.utcnow().timestamp() * 1000),\n                    'message': json.dumps(finding)\n                }\n            ]\n        )\n    except Exception as e:\n        print(f\"Error logging to CloudWatch: {str(e)}\")\n\ndef notify_security_team(finding):\n    \"\"\"\n    Send notification to security team via SNS\n    \"\"\"\n    sns_topic = os.environ.get('SNS_TOPIC')\n\n    if not sns_topic:\n        print(\"SNS topic not configured\")\n        return\n\n    message = {\n        'Title': finding.get('Title', 'Security Finding'),\n        'Description': finding.get('Description', 'No description'),\n        'Severity': finding.get('Severity', {}),\n        'CustomTags': finding.get('CustomTags', []),\n        'Resources': finding.get('Resources', []),\n        'ProcessedAt': finding.get('ProcessedAt')\n    }\n\n    try:\n        sns.publish(\n            TopicArn=sns_topic,\n            Subject=f\"[CRITICAL] Security Alert: {finding.get('Title', 'Security Finding')}\",\n            Message=json.dumps(message, indent=2),\n            MessageAttributes={\n                'severity': {\n                    'DataType': 'String',\n                    'StringValue': finding.get('Severity', {}).get('Label', 'UNKNOWN')\n                }\n            }\n        )\n        print(f\"Notification sent for finding: {finding.get('Id', 'unknown')}\")\n    except Exception as e:\n        print(f\"Error sending SNS notification: {str(e)}\")",
                "filename": "index.py"
              }
            ],
            "source_content": null,
            "source_content_filename": null,
            "source_dir": null,
            "source_file": null,
            "type": "zip"
          },
          "sensitive_attributes": []
        }
      ]
    },
    {
      "mode": "data",
      "type": "aws_caller_identity",
      "name": "current",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "account_id": "342597974367",
            "arn": "arn:aws:iam::342597974367:user/mayank.sethi",
            "id": "342597974367",
            "user_id": "AIDAU7RDOHFP2MZ572UQ5"
          },
          "sensitive_attributes": []
        }
      ]
    },
    {
      "mode": "data",
      "type": "aws_guardduty_detector",
      "name": "existing",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "index_key": 0,
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:guardduty:us-east-1:342597974367:detector/9db057715ebe4b86bae37035cdc0985e",
            "features": [
              {
                "additional_configuration": [],
                "name": "CLOUD_TRAIL",
                "status": "ENABLED"
              },
              {
                "additional_configuration": [],
                "name": "DNS_LOGS",
                "status": "ENABLED"
              },
              {
                "additional_configuration": [],
                "name": "FLOW_LOGS",
                "status": "ENABLED"
              },
              {
                "additional_configuration": [],
                "name": "S3_DATA_EVENTS",
                "status": "ENABLED"
              },
              {
                "additional_configuration": [],
                "name": "EKS_AUDIT_LOGS",
                "status": "ENABLED"
              },
              {
                "additional_configuration": [],
                "name": "EBS_MALWARE_PROTECTION",
                "status": "ENABLED"
              },
              {
                "additional_configuration": [],
                "name": "RDS_LOGIN_EVENTS",
                "status": "DISABLED"
              },
              {
                "additional_configuration": [
                  {
                    "name": "EKS_ADDON_MANAGEMENT",
                    "status": "DISABLED"
                  }
                ],
                "name": "EKS_RUNTIME_MONITORING",
                "status": "DISABLED"
              },
              {
                "additional_configuration": [],
                "name": "LAMBDA_NETWORK_LOGS",
                "status": "DISABLED"
              },
              {
                "additional_configuration": [
                  {
                    "name": "EKS_ADDON_MANAGEMENT",
                    "status": "DISABLED"
                  },
                  {
                    "name": "ECS_FARGATE_AGENT_MANAGEMENT",
                    "status": "DISABLED"
                  },
                  {
                    "name": "EC2_AGENT_MANAGEMENT",
                    "status": "DISABLED"
                  }
                ],
                "name": "RUNTIME_MONITORING",
                "status": "DISABLED"
              }
            ],
            "finding_publishing_frequency": "FIFTEEN_MINUTES",
            "id": "9db057715ebe4b86bae37035cdc0985e",
            "region": "us-east-1",
            "service_role_arn": "arn:aws:iam::342597974367:role/aws-service-role/guardduty.amazonaws.com/AWSServiceRoleForAmazonGuardDuty",
            "status": "ENABLED",
            "tags": {
              "Environment": "production",
              "ManagedBy": "Terraform",
              "Owner": "education-platform-team",
              "Project": "online-education-platform"
            }
          },
          "sensitive_attributes": []
        }
      ]
    },
    {
      "mode": "data",
      "type": "aws_iam_policy_document",
      "name": "cloudtrail_bucket_policy",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "id": "1945917767",
            "json": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"AWSCloudTrailAclCheck\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"s3:GetBucketAcl\",\n      \"Resource\": \"arn:aws:s3:::security-cloudtrail-logs-synth78029461-342597974367\",\n      \"Principal\": {\n        \"Service\": \"cloudtrail.amazonaws.com\"\n      }\n    },\n    {\n      \"Sid\": \"AWSCloudTrailWrite\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"s3:PutObject\",\n      \"Resource\": \"arn:aws:s3:::security-cloudtrail-logs-synth78029461-342597974367/*\",\n      \"Principal\": {\n        \"Service\": \"cloudtrail.amazonaws.com\"\n      },\n      \"Condition\": {\n        \"StringEquals\": {\n          \"s3:x-amz-acl\": \"bucket-owner-full-control\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"SecurityTeamAccess\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"s3:ListBucket\",\n        \"s3:GetObject\"\n      ],\n      \"Resource\": [\n        \"arn:aws:s3:::security-cloudtrail-logs-synth78029461-342597974367/*\",\n        \"arn:aws:s3:::security-cloudtrail-logs-synth78029461-342597974367\"\n      ],\n      \"Principal\": {\n        \"AWS\": \"arn:aws:iam::342597974367:role/SecurityTeamRole-synth78029461\"\n      }\n    }\n  ]\n}",
            "minified_json": "{\"Version\":\"2012-10-17\",\"Statement\":[{\"Sid\":\"AWSCloudTrailAclCheck\",\"Effect\":\"Allow\",\"Action\":\"s3:GetBucketAcl\",\"Resource\":\"arn:aws:s3:::security-cloudtrail-logs-synth78029461-342597974367\",\"Principal\":{\"Service\":\"cloudtrail.amazonaws.com\"}},{\"Sid\":\"AWSCloudTrailWrite\",\"Effect\":\"Allow\",\"Action\":\"s3:PutObject\",\"Resource\":\"arn:aws:s3:::security-cloudtrail-logs-synth78029461-342597974367/*\",\"Principal\":{\"Service\":\"cloudtrail.amazonaws.com\"},\"Condition\":{\"StringEquals\":{\"s3:x-amz-acl\":\"bucket-owner-full-control\"}}},{\"Sid\":\"SecurityTeamAccess\",\"Effect\":\"Allow\",\"Action\":[\"s3:ListBucket\",\"s3:GetObject\"],\"Resource\":[\"arn:aws:s3:::security-cloudtrail-logs-synth78029461-342597974367/*\",\"arn:aws:s3:::security-cloudtrail-logs-synth78029461-342597974367\"],\"Principal\":{\"AWS\":\"arn:aws:iam::342597974367:role/SecurityTeamRole-synth78029461\"}}]}",
            "override_json": null,
            "override_policy_documents": null,
            "policy_id": null,
            "source_json": null,
            "source_policy_documents": null,
            "statement": [
              {
                "actions": [
                  "s3:GetBucketAcl"
                ],
                "condition": [],
                "effect": "Allow",
                "not_actions": [],
                "not_principals": [],
                "not_resources": [],
                "principals": [
                  {
                    "identifiers": [
                      "cloudtrail.amazonaws.com"
                    ],
                    "type": "Service"
                  }
                ],
                "resources": [
                  "arn:aws:s3:::security-cloudtrail-logs-synth78029461-342597974367"
                ],
                "sid": "AWSCloudTrailAclCheck"
              },
              {
                "actions": [
                  "s3:PutObject"
                ],
                "condition": [
                  {
                    "test": "StringEquals",
                    "values": [
                      "bucket-owner-full-control"
                    ],
                    "variable": "s3:x-amz-acl"
                  }
                ],
                "effect": "Allow",
                "not_actions": [],
                "not_principals": [],
                "not_resources": [],
                "principals": [
                  {
                    "identifiers": [
                      "cloudtrail.amazonaws.com"
                    ],
                    "type": "Service"
                  }
                ],
                "resources": [
                  "arn:aws:s3:::security-cloudtrail-logs-synth78029461-342597974367/*"
                ],
                "sid": "AWSCloudTrailWrite"
              },
              {
                "actions": [
                  "s3:GetObject",
                  "s3:ListBucket"
                ],
                "condition": [],
                "effect": "Allow",
                "not_actions": [],
                "not_principals": [],
                "not_resources": [],
                "principals": [
                  {
                    "identifiers": [
                      "arn:aws:iam::342597974367:role/SecurityTeamRole-synth78029461"
                    ],
                    "type": "AWS"
                  }
                ],
                "resources": [
                  "arn:aws:s3:::security-cloudtrail-logs-synth78029461-342597974367",
                  "arn:aws:s3:::security-cloudtrail-logs-synth78029461-342597974367/*"
                ],
                "sid": "SecurityTeamAccess"
              }
            ],
            "version": "2012-10-17"
          },
          "sensitive_attributes": []
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_cloudtrail",
      "name": "main",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 1,
          "attributes": {
            "advanced_event_selector": [],
            "arn": "arn:aws:cloudtrail:us-east-1:342597974367:trail/security-monitoring-trail-synth78029461",
            "cloud_watch_logs_group_arn": "arn:aws:logs:us-east-1:342597974367:log-group:/aws/cloudtrail/security-synth78029461:*",
            "cloud_watch_logs_role_arn": "arn:aws:iam::342597974367:role/CloudTrailCloudWatchRole-synth78029461",
            "enable_log_file_validation": true,
            "enable_logging": true,
            "event_selector": [
              {
                "data_resource": [],
                "exclude_management_event_sources": null,
                "include_management_events": true,
                "read_write_type": "All"
              }
            ],
            "home_region": "us-east-1",
            "id": "arn:aws:cloudtrail:us-east-1:342597974367:trail/security-monitoring-trail-synth78029461",
            "include_global_service_events": true,
            "insight_selector": [],
            "is_multi_region_trail": true,
            "is_organization_trail": false,
            "kms_key_id": "arn:aws:kms:us-east-1:342597974367:key/3ee92177-ce64-4479-9a75-ee6cd897b841",
            "name": "security-monitoring-trail-synth78029461",
            "region": "us-east-1",
            "s3_bucket_name": "security-cloudtrail-logs-synth78029461-342597974367",
            "s3_key_prefix": "",
            "sns_topic_arn": "",
            "sns_topic_name": "",
            "tags": {
              "Environment": "production",
              "ManagedBy": "Terraform",
              "Name": "security-monitoring-trail-synth78029461",
              "Owner": "SecurityTeam",
              "Purpose": "Security Monitoring"
            },
            "tags_all": {
              "Environment": "production",
              "ManagedBy": "Terraform",
              "Name": "security-monitoring-trail-synth78029461",
              "Owner": "SecurityTeam",
              "Purpose": "Security Monitoring"
            }
          },
          "sensitive_attributes": [],
          "private": "eyJzY2hlbWFfdmVyc2lvbiI6IjEifQ==",
          "dependencies": [
            "aws_cloudwatch_log_group.cloudtrail",
            "aws_iam_role.cloudtrail_cloudwatch",
            "aws_kms_key.security_key",
            "aws_s3_bucket.cloudtrail_logs",
            "aws_s3_bucket_policy.cloudtrail_logs"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_cloudwatch_event_rule",
      "name": "cloudtrail_api_events",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 1,
          "attributes": {
            "arn": "arn:aws:events:us-east-1:342597974367:rule/cloudtrail-sensitive-api-calls-synth78029461",
            "description": "Monitor sensitive API calls",
            "event_bus_name": "default",
            "event_pattern": "{\"detail\":{\"eventName\":[\"DeleteBucket\",\"DeleteTrail\",\"StopLogging\",\"UpdateTrail\",\"PutBucketPolicy\",\"DeleteBucketPolicy\",\"CreateAccessKey\",\"DeleteAccessKey\"]},\"detail-type\":[\"AWS API Call via CloudTrail\"],\"source\":[\"aws.cloudtrail\"]}",
            "force_destroy": false,
            "id": "cloudtrail-sensitive-api-calls-synth78029461",
            "is_enabled": true,
            "name": "cloudtrail-sensitive-api-calls-synth78029461",
            "name_prefix": "",
            "region": "us-east-1",
            "role_arn": "",
            "schedule_expression": "",
            "state": "ENABLED",
            "tags": {
              "Environment": "production",
              "ManagedBy": "Terraform",
              "Name": "cloudtrail-api-events-rule",
              "Owner": "SecurityTeam",
              "Purpose": "Security Monitoring"
            },
            "tags_all": {
              "Environment": "production",
              "ManagedBy": "Terraform",
              "Name": "cloudtrail-api-events-rule",
              "Owner": "SecurityTeam",
              "Purpose": "Security Monitoring"
            }
          },
          "sensitive_attributes": [],
          "private": "eyJzY2hlbWFfdmVyc2lvbiI6IjEifQ=="
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_cloudwatch_event_rule",
      "name": "guardduty_findings",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 1,
          "attributes": {
            "arn": "arn:aws:events:us-east-1:342597974367:rule/guardduty-high-severity-findings-synth78029461",
            "description": "Capture high severity GuardDuty findings",
            "event_bus_name": "default",
            "event_pattern": "{\"detail\":{\"severity\":[{\"numeric\":[\"\u003e=\",7]}]},\"detail-type\":[\"GuardDuty Finding\"],\"source\":[\"aws.guardduty\"]}",
            "force_destroy": false,
            "id": "guardduty-high-severity-findings-synth78029461",
            "is_enabled": true,
            "name": "guardduty-high-severity-findings-synth78029461",
            "name_prefix": "",
            "region": "us-east-1",
            "role_arn": "",
            "schedule_expression": "",
            "state": "ENABLED",
            "tags": {
              "Environment": "production",
              "ManagedBy": "Terraform",
              "Name": "guardduty-findings-rule-synth78029461",
              "Owner": "SecurityTeam",
              "Purpose": "Security Monitoring"
            },
            "tags_all": {
              "Environment": "production",
              "ManagedBy": "Terraform",
              "Name": "guardduty-findings-rule-synth78029461",
              "Owner": "SecurityTeam",
              "Purpose": "Security Monitoring"
            }
          },
          "sensitive_attributes": [],
          "private": "eyJzY2hlbWFfdmVyc2lvbiI6IjEifQ=="
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_cloudwatch_event_rule",
      "name": "security_hub_findings",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 1,
          "attributes": {
            "arn": "arn:aws:events:us-east-1:342597974367:rule/security-hub-critical-findings-synth78029461",
            "description": "Capture critical Security Hub findings",
            "event_bus_name": "default",
            "event_pattern": "{\"detail\":{\"findings\":{\"Severity\":{\"Label\":[\"CRITICAL\",\"HIGH\"]}}},\"detail-type\":[\"Security Hub Findings - Imported\"],\"source\":[\"aws.securityhub\"]}",
            "force_destroy": false,
            "id": "security-hub-critical-findings-synth78029461",
            "is_enabled": true,
            "name": "security-hub-critical-findings-synth78029461",
            "name_prefix": "",
            "region": "us-east-1",
            "role_arn": "",
            "schedule_expression": "",
            "state": "ENABLED",
            "tags": {
              "Environment": "production",
              "ManagedBy": "Terraform",
              "Name": "security-hub-findings-rule-synth78029461",
              "Owner": "SecurityTeam",
              "Purpose": "Security Monitoring"
            },
            "tags_all": {
              "Environment": "production",
              "ManagedBy": "Terraform",
              "Name": "security-hub-findings-rule-synth78029461",
              "Owner": "SecurityTeam",
              "Purpose": "Security Monitoring"
            }
          },
          "sensitive_attributes": [],
          "private": "eyJzY2hlbWFfdmVyc2lvbiI6IjEifQ=="
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_cloudwatch_event_target",
      "name": "cloudtrail_sns",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 1,
          "attributes": {
            "appsync_target": [],
            "arn": "arn:aws:sns:us-east-1:342597974367:security-monitoring-alerts-synth78029461",
            "batch_target": [],
            "dead_letter_config": [],
            "ecs_target": [],
            "event_bus_name": "default",
            "force_destroy": false,
            "http_target": [],
            "id": "cloudtrail-sensitive-api-calls-synth78029461-SendToSNS",
            "input": "",
            "input_path": "",
            "input_transformer": [],
            "kinesis_target": [],
            "redshift_target": [],
            "region": "us-east-1",
            "retry_policy": [],
            "role_arn": "",
            "rule": "cloudtrail-sensitive-api-calls-synth78029461",
            "run_command_targets": [],
            "sagemaker_pipeline_target": [],
            "sqs_target": [],
            "target_id": "SendToSNS"
          },
          "sensitive_attributes": [],
          "private": "eyJzY2hlbWFfdmVyc2lvbiI6IjEifQ==",
          "dependencies": [
            "aws_cloudwatch_event_rule.cloudtrail_api_events",
            "aws_kms_key.security_key",
            "aws_sns_topic.security_alerts",
            "data.aws_caller_identity.current"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_cloudwatch_event_target",
      "name": "guardduty_sns",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 1,
          "attributes": {
            "appsync_target": [],
            "arn": "arn:aws:sns:us-east-1:342597974367:security-monitoring-alerts-synth78029461",
            "batch_target": [],
            "dead_letter_config": [],
            "ecs_target": [],
            "event_bus_name": "default",
            "force_destroy": false,
            "http_target": [],
            "id": "guardduty-high-severity-findings-synth78029461-SendToSNS",
            "input": "",
            "input_path": "",
            "input_transformer": [
              {
                "input_paths": {
                  "accountId": "$.account",
                  "description": "$.detail.description",
                  "region": "$.region",
                  "severity": "$.detail.severity",
                  "time": "$.time",
                  "type": "$.detail.type"
                },
                "input_template": "{\"accountId\":\"\\u003caccountId\\u003e\",\"description\":\"\\u003cdescription\\u003e\",\"region\":\"\\u003cregion\\u003e\",\"severity\":\"\\u003cseverity\\u003e\",\"time\":\"\\u003ctime\\u003e\",\"type\":\"\\u003ctype\\u003e\"}"
              }
            ],
            "kinesis_target": [],
            "redshift_target": [],
            "region": "us-east-1",
            "retry_policy": [],
            "role_arn": "",
            "rule": "guardduty-high-severity-findings-synth78029461",
            "run_command_targets": [],
            "sagemaker_pipeline_target": [],
            "sqs_target": [],
            "target_id": "SendToSNS"
          },
          "sensitive_attributes": [],
          "private": "eyJzY2hlbWFfdmVyc2lvbiI6IjEifQ==",
          "dependencies": [
            "aws_cloudwatch_event_rule.guardduty_findings",
            "aws_kms_key.security_key",
            "aws_sns_topic.security_alerts",
            "data.aws_caller_identity.current"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_cloudwatch_event_target",
      "name": "security_hub_lambda",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 1,
          "attributes": {
            "appsync_target": [],
            "arn": "arn:aws:lambda:us-east-1:342597974367:function:security-custom-rules-processor-synth78029461",
            "batch_target": [],
            "dead_letter_config": [],
            "ecs_target": [],
            "event_bus_name": "default",
            "force_destroy": false,
            "http_target": [],
            "id": "security-hub-critical-findings-synth78029461-ProcessWithLambda",
            "input": "",
            "input_path": "",
            "input_transformer": [],
            "kinesis_target": [],
            "redshift_target": [],
            "region": "us-east-1",
            "retry_policy": [],
            "role_arn": "",
            "rule": "security-hub-critical-findings-synth78029461",
            "run_command_targets": [],
            "sagemaker_pipeline_target": [],
            "sqs_target": [],
            "target_id": "ProcessWithLambda"
          },
          "sensitive_attributes": [],
          "private": "eyJzY2hlbWFfdmVyc2lvbiI6IjEifQ==",
          "dependencies": [
            "aws_cloudwatch_event_rule.security_hub_findings",
            "aws_cloudwatch_log_group.security_events",
            "aws_iam_role.lambda_execution",
            "aws_kms_key.security_key",
            "aws_lambda_function.custom_rules_processor",
            "aws_sns_topic.security_alerts",
            "data.archive_file.lambda_zip",
            "data.aws_caller_identity.current"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_cloudwatch_event_target",
      "name": "security_hub_sns",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 1,
          "attributes": {
            "appsync_target": [],
            "arn": "arn:aws:sns:us-east-1:342597974367:security-monitoring-alerts-synth78029461",
            "batch_target": [],
            "dead_letter_config": [],
            "ecs_target": [],
            "event_bus_name": "default",
            "force_destroy": false,
            "http_target": [],
            "id": "security-hub-critical-findings-synth78029461-SendToSNS",
            "input": "",
            "input_path": "",
            "input_transformer": [],
            "kinesis_target": [],
            "redshift_target": [],
            "region": "us-east-1",
            "retry_policy": [],
            "role_arn": "",
            "rule": "security-hub-critical-findings-synth78029461",
            "run_command_targets": [],
            "sagemaker_pipeline_target": [],
            "sqs_target": [],
            "target_id": "SendToSNS"
          },
          "sensitive_attributes": [],
          "private": "eyJzY2hlbWFfdmVyc2lvbiI6IjEifQ==",
          "dependencies": [
            "aws_cloudwatch_event_rule.security_hub_findings",
            "aws_kms_key.security_key",
            "aws_sns_topic.security_alerts",
            "data.aws_caller_identity.current"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_cloudwatch_log_group",
      "name": "cloudtrail",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:logs:us-east-1:342597974367:log-group:/aws/cloudtrail/security-synth78029461",
            "id": "/aws/cloudtrail/security-synth78029461",
            "kms_key_id": "arn:aws:kms:us-east-1:342597974367:key/3ee92177-ce64-4479-9a75-ee6cd897b841",
            "log_group_class": "STANDARD",
            "name": "/aws/cloudtrail/security-synth78029461",
            "name_prefix": "",
            "region": "us-east-1",
            "retention_in_days": 180,
            "skip_destroy": false,
            "tags": {
              "Environment": "production",
              "ManagedBy": "Terraform",
              "Name": "cloudtrail-log-group-synth78029461",
              "Owner": "SecurityTeam",
              "Purpose": "Security Monitoring"
            },
            "tags_all": {
              "Environment": "production",
              "ManagedBy": "Terraform",
              "Name": "cloudtrail-log-group-synth78029461",
              "Owner": "SecurityTeam",
              "Purpose": "Security Monitoring"
            }
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "aws_kms_key.security_key",
            "data.aws_caller_identity.current"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_cloudwatch_log_group",
      "name": "security_events",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:logs:us-east-1:342597974367:log-group:/aws/security/events-synth78029461",
            "id": "/aws/security/events-synth78029461",
            "kms_key_id": "arn:aws:kms:us-east-1:342597974367:key/3ee92177-ce64-4479-9a75-ee6cd897b841",
            "log_group_class": "STANDARD",
            "name": "/aws/security/events-synth78029461",
            "name_prefix": "",
            "region": "us-east-1",
            "retention_in_days": 180,
            "skip_destroy": false,
            "tags": {
              "Environment": "production",
              "ManagedBy": "Terraform",
              "Name": "security-events-log-group-synth78029461",
              "Owner": "SecurityTeam",
              "Purpose": "Security Monitoring"
            },
            "tags_all": {
              "Environment": "production",
              "ManagedBy": "Terraform",
              "Name": "security-events-log-group-synth78029461",
              "Owner": "SecurityTeam",
              "Purpose": "Security Monitoring"
            }
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "aws_kms_key.security_key",
            "data.aws_caller_identity.current"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_cloudwatch_log_stream",
      "name": "custom_rules",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:logs:us-east-1:342597974367:log-group:/aws/security/events-synth78029461:log-stream:custom-rules-processor",
            "id": "custom-rules-processor",
            "log_group_name": "/aws/security/events-synth78029461",
            "name": "custom-rules-processor",
            "region": "us-east-1"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "aws_cloudwatch_log_group.security_events",
            "aws_kms_key.security_key",
            "data.aws_caller_identity.current"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_cloudwatch_log_stream",
      "name": "guardduty",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:logs:us-east-1:342597974367:log-group:/aws/security/events-synth78029461:log-stream:guardduty-findings",
            "id": "guardduty-findings",
            "log_group_name": "/aws/security/events-synth78029461",
            "name": "guardduty-findings",
            "region": "us-east-1"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "aws_cloudwatch_log_group.security_events",
            "aws_kms_key.security_key",
            "data.aws_caller_identity.current"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_cloudwatch_log_stream",
      "name": "security_hub",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:logs:us-east-1:342597974367:log-group:/aws/security/events-synth78029461:log-stream:security-hub-findings",
            "id": "security-hub-findings",
            "log_group_name": "/aws/security/events-synth78029461",
            "name": "security-hub-findings",
            "region": "us-east-1"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "aws_cloudwatch_log_group.security_events",
            "aws_kms_key.security_key",
            "data.aws_caller_identity.current"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_iam_role",
      "name": "cloudtrail_cloudwatch",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:iam::342597974367:role/CloudTrailCloudWatchRole-synth78029461",
            "assume_role_policy": "{\"Statement\":[{\"Action\":\"sts:AssumeRole\",\"Effect\":\"Allow\",\"Principal\":{\"Service\":\"cloudtrail.amazonaws.com\"}}],\"Version\":\"2012-10-17\"}",
            "create_date": "2025-10-03T14:12:02Z",
            "description": "",
            "force_detach_policies": false,
            "id": "CloudTrailCloudWatchRole-synth78029461",
            "inline_policy": [
              {
                "name": "CloudTrailCloudWatchPolicy",
                "policy": "{\"Version\":\"2012-10-17\",\"Statement\":[{\"Action\":[\"logs:CreateLogStream\",\"logs:PutLogEvents\"],\"Effect\":\"Allow\",\"Resource\":\"arn:aws:logs:us-east-1:342597974367:log-group:/aws/cloudtrail/security-synth78029461:*\"}]}"
              }
            ],
            "managed_policy_arns": [],
            "max_session_duration": 3600,
            "name": "CloudTrailCloudWatchRole-synth78029461",
            "name_prefix": "",
            "path": "/",
            "permissions_boundary": "",
            "tags": {
              "Environment": "production",
              "ManagedBy": "Terraform",
              "Name": "cloudtrail-cloudwatch-role",
              "Owner": "SecurityTeam",
              "Purpose": "Security Monitoring"
            },
            "tags_all": {
              "Environment": "production",
              "ManagedBy": "Terraform",
              "Name": "cloudtrail-cloudwatch-role",
              "Owner": "SecurityTeam",
              "Purpose": "Security Monitoring"
            },
            "unique_id": "AROAU7RDOHFPRRJCUYXJP"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA=="
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_iam_role",
      "name": "lambda_execution",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:iam::342597974367:role/CustomRulesLambdaExecutionRole-synth78029461",
            "assume_role_policy": "{\"Statement\":[{\"Action\":\"sts:AssumeRole\",\"Effect\":\"Allow\",\"Principal\":{\"Service\":\"lambda.amazonaws.com\"}}],\"Version\":\"2012-10-17\"}",
            "create_date": "2025-10-03T14:12:02Z",
            "description": "",
            "force_detach_policies": false,
            "id": "CustomRulesLambdaExecutionRole-synth78029461",
            "inline_policy": [
              {
                "name": "CustomRulesProcessorPolicy",
                "policy": "{\"Version\":\"2012-10-17\",\"Statement\":[{\"Action\":[\"logs:CreateLogGroup\",\"logs:CreateLogStream\",\"logs:PutLogEvents\"],\"Effect\":\"Allow\",\"Resource\":\"arn:aws:logs:us-east-1:342597974367:*\"},{\"Action\":[\"sns:Publish\"],\"Effect\":\"Allow\",\"Resource\":\"arn:aws:sns:us-east-1:342597974367:security-monitoring-alerts-synth78029461\"},{\"Action\":[\"kms:Decrypt\",\"kms:GenerateDataKey\"],\"Effect\":\"Allow\",\"Resource\":\"arn:aws:kms:us-east-1:342597974367:key/3ee92177-ce64-4479-9a75-ee6cd897b841\"}]}"
              }
            ],
            "managed_policy_arns": [
              "arn:aws:iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"
            ],
            "max_session_duration": 3600,
            "name": "CustomRulesLambdaExecutionRole-synth78029461",
            "name_prefix": "",
            "path": "/",
            "permissions_boundary": "",
            "tags": {
              "Environment": "production",
              "ManagedBy": "Terraform",
              "Name": "lambda-execution-role-synth78029461",
              "Owner": "SecurityTeam",
              "Purpose": "Security Monitoring"
            },
            "tags_all": {
              "Environment": "production",
              "ManagedBy": "Terraform",
              "Name": "lambda-execution-role-synth78029461",
              "Owner": "SecurityTeam",
              "Purpose": "Security Monitoring"
            },
            "unique_id": "AROAU7RDOHFPXK7ROT3Z5"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA=="
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_iam_role",
      "name": "security_team",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:iam::342597974367:role/SecurityTeamRole-synth78029461",
            "assume_role_policy": "{\"Statement\":[{\"Action\":\"sts:AssumeRole\",\"Condition\":{\"Bool\":{\"aws:MultiFactorAuthPresent\":\"true\"}},\"Effect\":\"Allow\",\"Principal\":{\"AWS\":\"arn:aws:iam::342597974367:root\"}}],\"Version\":\"2012-10-17\"}",
            "create_date": "2025-10-03T14:12:02Z",
            "description": "",
            "force_detach_policies": false,
            "id": "SecurityTeamRole-synth78029461",
            "inline_policy": [
              {
                "name": "SecurityTeamPolicy",
                "policy": "{\"Version\":\"2012-10-17\",\"Statement\":[{\"Action\":[\"securityhub:Get*\",\"securityhub:List*\",\"securityhub:Describe*\",\"guardduty:Get*\",\"guardduty:List*\",\"cloudtrail:Get*\",\"cloudtrail:Describe*\",\"cloudtrail:LookupEvents\",\"logs:Get*\",\"logs:Describe*\",\"logs:FilterLogEvents\",\"s3:GetObject\",\"s3:ListBucket\",\"sns:Get*\",\"sns:List*\",\"events:List*\",\"events:Describe*\",\"lambda:Get*\",\"lambda:List*\",\"kms:Decrypt\",\"kms:DescribeKey\"],\"Effect\":\"Allow\",\"Resource\":\"*\"}]}"
              }
            ],
            "managed_policy_arns": [],
            "max_session_duration": 3600,
            "name": "SecurityTeamRole-synth78029461",
            "name_prefix": "",
            "path": "/",
            "permissions_boundary": "",
            "tags": {
              "Environment": "production",
              "ManagedBy": "Terraform",
              "Name": "security-team-role-synth78029461",
              "Owner": "SecurityTeam",
              "Purpose": "Security Monitoring"
            },
            "tags_all": {
              "Environment": "production",
              "ManagedBy": "Terraform",
              "Name": "security-team-role-synth78029461",
              "Owner": "SecurityTeam",
              "Purpose": "Security Monitoring"
            },
            "unique_id": "AROAU7RDOHFPYIGNMTFJZ"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "data.aws_caller_identity.current"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_iam_role_policy",
      "name": "cloudtrail_cloudwatch_policy",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "id": "CloudTrailCloudWatchRole-synth78029461:CloudTrailCloudWatchPolicy",
            "name": "CloudTrailCloudWatchPolicy",
            "name_prefix": "",
            "policy": "{\"Version\":\"2012-10-17\",\"Statement\":[{\"Action\":[\"logs:CreateLogStream\",\"logs:PutLogEvents\"],\"Effect\":\"Allow\",\"Resource\":\"arn:aws:logs:us-east-1:342597974367:log-group:/aws/cloudtrail/security-synth78029461:*\"}]}",
            "role": "CloudTrailCloudWatchRole-synth78029461"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "aws_cloudwatch_log_group.cloudtrail",
            "aws_iam_role.cloudtrail_cloudwatch",
            "aws_kms_key.security_key",
            "data.aws_caller_identity.current"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_iam_role_policy",
      "name": "lambda_custom_policy",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "id": "CustomRulesLambdaExecutionRole-synth78029461:CustomRulesProcessorPolicy",
            "name": "CustomRulesProcessorPolicy",
            "name_prefix": "",
            "policy": "{\"Version\":\"2012-10-17\",\"Statement\":[{\"Action\":[\"logs:CreateLogGroup\",\"logs:CreateLogStream\",\"logs:PutLogEvents\"],\"Effect\":\"Allow\",\"Resource\":\"arn:aws:logs:us-east-1:342597974367:*\"},{\"Action\":[\"sns:Publish\"],\"Effect\":\"Allow\",\"Resource\":\"arn:aws:sns:us-east-1:342597974367:security-monitoring-alerts-synth78029461\"},{\"Action\":[\"kms:Decrypt\",\"kms:GenerateDataKey\"],\"Effect\":\"Allow\",\"Resource\":\"arn:aws:kms:us-east-1:342597974367:key/3ee92177-ce64-4479-9a75-ee6cd897b841\"}]}",
            "role": "CustomRulesLambdaExecutionRole-synth78029461"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "aws_iam_role.lambda_execution",
            "aws_kms_key.security_key",
            "aws_sns_topic.security_alerts",
            "data.aws_caller_identity.current"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_iam_role_policy",
      "name": "security_team_policy",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "id": "SecurityTeamRole-synth78029461:SecurityTeamPolicy",
            "name": "SecurityTeamPolicy",
            "name_prefix": "",
            "policy": "{\"Version\":\"2012-10-17\",\"Statement\":[{\"Action\":[\"securityhub:Get*\",\"securityhub:List*\",\"securityhub:Describe*\",\"guardduty:Get*\",\"guardduty:List*\",\"cloudtrail:Get*\",\"cloudtrail:Describe*\",\"cloudtrail:LookupEvents\",\"logs:Get*\",\"logs:Describe*\",\"logs:FilterLogEvents\",\"s3:GetObject\",\"s3:ListBucket\",\"sns:Get*\",\"sns:List*\",\"events:List*\",\"events:Describe*\",\"lambda:Get*\",\"lambda:List*\",\"kms:Decrypt\",\"kms:DescribeKey\"],\"Effect\":\"Allow\",\"Resource\":\"*\"}]}",
            "role": "SecurityTeamRole-synth78029461"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "aws_iam_role.security_team",
            "data.aws_caller_identity.current"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_iam_role_policy_attachment",
      "name": "lambda_basic",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "id": "CustomRulesLambdaExecutionRole-synth78029461/arn:aws:iam::aws:policy/service-role/AWSLambdaBasicExecutionRole",
            "policy_arn": "arn:aws:iam::aws:policy/service-role/AWSLambdaBasicExecutionRole",
            "role": "CustomRulesLambdaExecutionRole-synth78029461"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "aws_iam_role.lambda_execution"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_kms_alias",
      "name": "security_key_alias",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:kms:us-east-1:342597974367:alias/security-monitoring-synth78029461",
            "id": "alias/security-monitoring-synth78029461",
            "name": "alias/security-monitoring-synth78029461",
            "name_prefix": "",
            "region": "us-east-1",
            "target_key_arn": "arn:aws:kms:us-east-1:342597974367:key/3ee92177-ce64-4479-9a75-ee6cd897b841",
            "target_key_id": "3ee92177-ce64-4479-9a75-ee6cd897b841"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "aws_kms_key.security_key",
            "data.aws_caller_identity.current"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_kms_key",
      "name": "security_key",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:kms:us-east-1:342597974367:key/3ee92177-ce64-4479-9a75-ee6cd897b841",
            "bypass_policy_lockout_safety_check": false,
            "custom_key_store_id": "",
            "customer_master_key_spec": "SYMMETRIC_DEFAULT",
            "deletion_window_in_days": 7,
            "description": "KMS key for security monitoring platform",
            "enable_key_rotation": true,
            "id": "3ee92177-ce64-4479-9a75-ee6cd897b841",
            "is_enabled": true,
            "key_id": "3ee92177-ce64-4479-9a75-ee6cd897b841",
            "key_usage": "ENCRYPT_DECRYPT",
            "multi_region": false,
            "policy": "{\"Statement\":[{\"Action\":\"kms:*\",\"Effect\":\"Allow\",\"Principal\":{\"AWS\":\"arn:aws:iam::342597974367:root\"},\"Resource\":\"*\",\"Sid\":\"Enable IAM User Permissions\"},{\"Action\":[\"kms:Encrypt\",\"kms:Decrypt\",\"kms:ReEncrypt*\",\"kms:GenerateDataKey*\",\"kms:CreateGrant\",\"kms:DescribeKey\"],\"Condition\":{\"ArnLike\":{\"kms:EncryptionContext:aws:logs:arn\":\"arn:aws:logs:us-east-1:342597974367:*\"}},\"Effect\":\"Allow\",\"Principal\":{\"Service\":\"logs.us-east-1.amazonaws.com\"},\"Resource\":\"*\",\"Sid\":\"Allow CloudWatch Logs\"},{\"Action\":[\"kms:GenerateDataKey*\",\"kms:DescribeKey\"],\"Condition\":{\"StringLike\":{\"kms:EncryptionContext:aws:cloudtrail:arn\":\"arn:aws:cloudtrail:*:342597974367:trail/*\"}},\"Effect\":\"Allow\",\"Principal\":{\"Service\":\"cloudtrail.amazonaws.com\"},\"Resource\":\"*\",\"Sid\":\"Allow CloudTrail\"},{\"Action\":\"kms:Decrypt\",\"Condition\":{\"Null\":{\"kms:EncryptionContext:aws:cloudtrail:arn\":\"false\"}},\"Effect\":\"Allow\",\"Principal\":{\"Service\":\"cloudtrail.amazonaws.com\"},\"Resource\":\"*\",\"Sid\":\"Allow CloudTrail to decrypt logs\"}],\"Version\":\"2012-10-17\"}",
            "region": "us-east-1",
            "rotation_period_in_days": 365,
            "tags": {
              "Environment": "production",
              "ManagedBy": "Terraform",
              "Name": "security-monitoring-kms-key-synth78029461",
              "Owner": "SecurityTeam",
              "Purpose": "Security Monitoring"
            },
            "tags_all": {
              "Environment": "production",
              "ManagedBy": "Terraform",
              "Name": "security-monitoring-kms-key-synth78029461",
              "Owner": "SecurityTeam",
              "Purpose": "Security Monitoring"
            },
            "timeouts": null,
            "xks_key_id": ""
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxMjAwMDAwMDAwMDB9fQ==",
          "dependencies": [
            "data.aws_caller_identity.current"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_lambda_function",
      "name": "custom_rules_processor",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "architectures": [
              "x86_64"
            ],
            "arn": "arn:aws:lambda:us-east-1:342597974367:function:security-custom-rules-processor-synth78029461",
            "code_sha256": "2GNl2kQkz9X3BLxMzNjGklXyQi7gBrkc1GfUyal5Ww4=",
            "code_signing_config_arn": "",
            "dead_letter_config": [],
            "description": "",
            "environment": [
              {
                "variables": {
                  "LOG_GROUP": "/aws/security/events-synth78029461",
                  "SNS_TOPIC": "arn:aws:sns:us-east-1:342597974367:security-monitoring-alerts-synth78029461"
                }
              }
            ],
            "ephemeral_storage": [
              {
                "size": 512
              }
            ],
            "file_system_config": [],
            "filename": "/tmp/lambda_function.zip",
            "function_name": "security-custom-rules-processor-synth78029461",
            "handler": "index.handler",
            "id": "security-custom-rules-processor-synth78029461",
            "image_config": [],
            "image_uri": "",
            "invoke_arn": "arn:aws:apigateway:us-east-1:lambda:path/2015-03-31/functions/arn:aws:lambda:us-east-1:342597974367:function:security-custom-rules-processor-synth78029461/invocations",
            "kms_key_arn": "",
            "last_modified": "2025-10-03T14:14:33.874+0000",
            "layers": [],
            "logging_config": [
              {
                "application_log_level": "",
                "log_format": "Text",
                "log_group": "/aws/lambda/security-custom-rules-processor-synth78029461",
                "system_log_level": ""
              }
            ],
            "memory_size": 256,
            "package_type": "Zip",
            "publish": false,
            "qualified_arn": "arn:aws:lambda:us-east-1:342597974367:function:security-custom-rules-processor-synth78029461:$LATEST",
            "qualified_invoke_arn": "arn:aws:apigateway:us-east-1:lambda:path/2015-03-31/functions/arn:aws:lambda:us-east-1:342597974367:function:security-custom-rules-processor-synth78029461:$LATEST/invocations",
            "region": "us-east-1",
            "replace_security_groups_on_destroy": null,
            "replacement_security_group_ids": null,
            "reserved_concurrent_executions": -1,
            "role": "arn:aws:iam::342597974367:role/CustomRulesLambdaExecutionRole-synth78029461",
            "runtime": "python3.11",
            "s3_bucket": null,
            "s3_key": null,
            "s3_object_version": null,
            "signing_job_arn": "",
            "signing_profile_version_arn": "",
            "skip_destroy": false,
            "snap_start": [],
            "source_code_hash": "2GNl2kQkz9X3BLxMzNjGklXyQi7gBrkc1GfUyal5Ww4=",
            "source_code_size": 1602,
            "source_kms_key_arn": "",
            "tags": {
              "Environment": "production",
              "ManagedBy": "Terraform",
              "Name": "custom-rules-processor-synth78029461",
              "Owner": "SecurityTeam",
              "Purpose": "Security Monitoring"
            },
            "tags_all": {
              "Environment": "production",
              "ManagedBy": "Terraform",
              "Name": "custom-rules-processor-synth78029461",
              "Owner": "SecurityTeam",
              "Purpose": "Security Monitoring"
            },
            "timeout": 60,
            "timeouts": null,
            "tracing_config": [
              {
                "mode": "PassThrough"
              }
            ],
            "version": "$LATEST",
            "vpc_config": []
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjo2MDAwMDAwMDAwMDAsImRlbGV0ZSI6NjAwMDAwMDAwMDAwLCJ1cGRhdGUiOjYwMDAwMDAwMDAwMH19",
          "dependencies": [
            "aws_cloudwatch_log_group.security_events",
            "aws_iam_role.lambda_execution",
            "aws_kms_key.security_key",
            "aws_sns_topic.security_alerts",
            "data.archive_file.lambda_zip",
            "data.aws_caller_identity.current"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_lambda_permission",
      "name": "allow_eventbridge",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "action": "lambda:InvokeFunction",
            "event_source_token": null,
            "function_name": "security-custom-rules-processor-synth78029461",
            "function_url_auth_type": null,
            "id": "AllowExecutionFromEventBridge",
            "principal": "events.amazonaws.com",
            "principal_org_id": null,
            "qualifier": "",
            "region": "us-east-1",
            "source_account": null,
            "source_arn": "arn:aws:events:us-east-1:342597974367:rule/security-hub-critical-findings-synth78029461",
            "statement_id": "AllowExecutionFromEventBridge",
            "statement_id_prefix": ""
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "aws_cloudwatch_event_rule.security_hub_findings",
            "aws_cloudwatch_log_group.security_events",
            "aws_iam_role.lambda_execution",
            "aws_kms_key.security_key",
            "aws_lambda_function.custom_rules_processor",
            "aws_sns_topic.security_alerts",
            "data.archive_file.lambda_zip",
            "data.aws_caller_identity.current"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_s3_bucket",
      "name": "cloudtrail_logs",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "acceleration_status": "",
            "acl": null,
            "arn": "arn:aws:s3:::security-cloudtrail-logs-synth78029461-342597974367",
            "bucket": "security-cloudtrail-logs-synth78029461-342597974367",
            "bucket_domain_name": "security-cloudtrail-logs-synth78029461-342597974367.s3.amazonaws.com",
            "bucket_prefix": "",
            "bucket_region": "us-east-1",
            "bucket_regional_domain_name": "security-cloudtrail-logs-synth78029461-342597974367.s3.us-east-1.amazonaws.com",
            "cors_rule": [],
            "force_destroy": true,
            "grant": [
              {
                "id": "5e11009481664687bf1ec517a9c41894392b4a057b0b19eeaaf7779a17ba0490",
                "permissions": [
                  "FULL_CONTROL"
                ],
                "type": "CanonicalUser",
                "uri": ""
              }
            ],
            "hosted_zone_id": "Z3AQBSTGFYJSTF",
            "id": "security-cloudtrail-logs-synth78029461-342597974367",
            "lifecycle_rule": [
              {
                "abort_incomplete_multipart_upload_days": 0,
                "enabled": true,
                "expiration": [
                  {
                    "date": "",
                    "days": 2555,
                    "expired_object_delete_marker": false
                  }
                ],
                "id": "transition-to-glacier",
                "noncurrent_version_expiration": [],
                "noncurrent_version_transition": [],
                "prefix": "",
                "tags": {},
                "transition": [
                  {
                    "date": "",
                    "days": 90,
                    "storage_class": "GLACIER"
                  }
                ]
              }
            ],
            "logging": [],
            "object_lock_configuration": [],
            "object_lock_enabled": false,
            "policy": "{\"Statement\":[{\"Action\":\"s3:GetBucketAcl\",\"Effect\":\"Allow\",\"Principal\":{\"Service\":\"cloudtrail.amazonaws.com\"},\"Resource\":\"arn:aws:s3:::security-cloudtrail-logs-synth78029461-342597974367\",\"Sid\":\"AWSCloudTrailAclCheck\"},{\"Action\":\"s3:PutObject\",\"Condition\":{\"StringEquals\":{\"s3:x-amz-acl\":\"bucket-owner-full-control\"}},\"Effect\":\"Allow\",\"Principal\":{\"Service\":\"cloudtrail.amazonaws.com\"},\"Resource\":\"arn:aws:s3:::security-cloudtrail-logs-synth78029461-342597974367/*\",\"Sid\":\"AWSCloudTrailWrite\"},{\"Action\":[\"s3:ListBucket\",\"s3:GetObject\"],\"Effect\":\"Allow\",\"Principal\":{\"AWS\":\"arn:aws:iam::342597974367:role/SecurityTeamRole-synth78029461\"},\"Resource\":[\"arn:aws:s3:::security-cloudtrail-logs-synth78029461-342597974367/*\",\"arn:aws:s3:::security-cloudtrail-logs-synth78029461-342597974367\"],\"Sid\":\"SecurityTeamAccess\"}],\"Version\":\"2012-10-17\"}",
            "region": "us-east-1",
            "replication_configuration": [],
            "request_payer": "BucketOwner",
            "server_side_encryption_configuration": [
              {
                "rule": [
                  {
                    "apply_server_side_encryption_by_default": [
                      {
                        "kms_master_key_id": "arn:aws:kms:us-east-1:342597974367:key/3ee92177-ce64-4479-9a75-ee6cd897b841",
                        "sse_algorithm": "aws:kms"
                      }
                    ],
                    "bucket_key_enabled": false
                  }
                ]
              }
            ],
            "tags": {
              "Environment": "production",
              "ManagedBy": "Terraform",
              "Name": "CloudTrail Logs Bucket-synth78029461",
              "Owner": "SecurityTeam",
              "Purpose": "Security Monitoring"
            },
            "tags_all": {
              "Environment": "production",
              "ManagedBy": "Terraform",
              "Name": "CloudTrail Logs Bucket-synth78029461",
              "Owner": "SecurityTeam",
              "Purpose": "Security Monitoring"
            },
            "timeouts": null,
            "versioning": [
              {
                "enabled": true,
                "mfa_delete": false
              }
            ],
            "website": [],
            "website_domain": null,
            "website_endpoint": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxMjAwMDAwMDAwMDAwLCJkZWxldGUiOjM2MDAwMDAwMDAwMDAsInJlYWQiOjEyMDAwMDAwMDAwMDAsInVwZGF0ZSI6MTIwMDAwMDAwMDAwMH19",
          "dependencies": [
            "data.aws_caller_identity.current"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_s3_bucket_lifecycle_configuration",
      "name": "cloudtrail_logs",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 1,
          "attributes": {
            "bucket": "security-cloudtrail-logs-synth78029461-342597974367",
            "expected_bucket_owner": "",
            "id": "security-cloudtrail-logs-synth78029461-342597974367",
            "region": "us-east-1",
            "rule": [
              {
                "abort_incomplete_multipart_upload": [],
                "expiration": [
                  {
                    "date": null,
                    "days": 2555,
                    "expired_object_delete_marker": false
                  }
                ],
                "filter": [
                  {
                    "and": [],
                    "object_size_greater_than": null,
                    "object_size_less_than": null,
                    "prefix": "",
                    "tag": []
                  }
                ],
                "id": "transition-to-glacier",
                "noncurrent_version_expiration": [],
                "noncurrent_version_transition": [],
                "prefix": "",
                "status": "Enabled",
                "transition": [
                  {
                    "date": null,
                    "days": 90,
                    "storage_class": "GLACIER"
                  }
                ]
              }
            ],
            "timeouts": null,
            "transition_default_minimum_object_size": "all_storage_classes_128K"
          },
          "sensitive_attributes": [],
          "dependencies": [
            "aws_s3_bucket.cloudtrail_logs",
            "data.aws_caller_identity.current"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_s3_bucket_policy",
      "name": "cloudtrail_logs",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "bucket": "security-cloudtrail-logs-synth78029461-342597974367",
            "id": "security-cloudtrail-logs-synth78029461-342597974367",
            "policy": "{\"Statement\":[{\"Action\":\"s3:GetBucketAcl\",\"Effect\":\"Allow\",\"Principal\":{\"Service\":\"cloudtrail.amazonaws.com\"},\"Resource\":\"arn:aws:s3:::security-cloudtrail-logs-synth78029461-342597974367\",\"Sid\":\"AWSCloudTrailAclCheck\"},{\"Action\":\"s3:PutObject\",\"Condition\":{\"StringEquals\":{\"s3:x-amz-acl\":\"bucket-owner-full-control\"}},\"Effect\":\"Allow\",\"Principal\":{\"Service\":\"cloudtrail.amazonaws.com\"},\"Resource\":\"arn:aws:s3:::security-cloudtrail-logs-synth78029461-342597974367/*\",\"Sid\":\"AWSCloudTrailWrite\"},{\"Action\":[\"s3:ListBucket\",\"s3:GetObject\"],\"Effect\":\"Allow\",\"Principal\":{\"AWS\":\"arn:aws:iam::342597974367:role/SecurityTeamRole-synth78029461\"},\"Resource\":[\"arn:aws:s3:::security-cloudtrail-logs-synth78029461-342597974367/*\",\"arn:aws:s3:::security-cloudtrail-logs-synth78029461-342597974367\"],\"Sid\":\"SecurityTeamAccess\"}],\"Version\":\"2012-10-17\"}",
            "region": "us-east-1"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "aws_iam_role.security_team",
            "aws_s3_bucket.cloudtrail_logs",
            "data.aws_caller_identity.current",
            "data.aws_iam_policy_document.cloudtrail_bucket_policy"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_s3_bucket_public_access_block",
      "name": "cloudtrail_logs",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "block_public_acls": true,
            "block_public_policy": true,
            "bucket": "security-cloudtrail-logs-synth78029461-342597974367",
            "id": "security-cloudtrail-logs-synth78029461-342597974367",
            "ignore_public_acls": true,
            "region": "us-east-1",
            "restrict_public_buckets": true,
            "skip_destroy": null
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "aws_s3_bucket.cloudtrail_logs",
            "data.aws_caller_identity.current"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_s3_bucket_server_side_encryption_configuration",
      "name": "cloudtrail_logs",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "bucket": "security-cloudtrail-logs-synth78029461-342597974367",
            "expected_bucket_owner": "",
            "id": "security-cloudtrail-logs-synth78029461-342597974367",
            "region": "us-east-1",
            "rule": [
              {
                "apply_server_side_encryption_by_default": [
                  {
                    "kms_master_key_id": "arn:aws:kms:us-east-1:342597974367:key/3ee92177-ce64-4479-9a75-ee6cd897b841",
                    "sse_algorithm": "aws:kms"
                  }
                ],
                "bucket_key_enabled": false
              }
            ]
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "aws_kms_key.security_key",
            "aws_s3_bucket.cloudtrail_logs",
            "data.aws_caller_identity.current"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_s3_bucket_versioning",
      "name": "cloudtrail_logs",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "bucket": "security-cloudtrail-logs-synth78029461-342597974367",
            "expected_bucket_owner": "",
            "id": "security-cloudtrail-logs-synth78029461-342597974367",
            "mfa": null,
            "region": "us-east-1",
            "versioning_configuration": [
              {
                "mfa_delete": "",
                "status": "Enabled"
              }
            ]
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "aws_s3_bucket.cloudtrail_logs",
            "data.aws_caller_identity.current"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_securityhub_account",
      "name": "main",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 1,
          "attributes": {
            "arn": "arn:aws:securityhub:us-east-1:342597974367:hub/default",
            "auto_enable_controls": true,
            "control_finding_generator": "SECURITY_CONTROL",
            "enable_default_standards": true,
            "id": "342597974367",
            "region": "us-east-1"
          },
          "sensitive_attributes": [],
          "private": "eyJzY2hlbWFfdmVyc2lvbiI6IjEifQ=="
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_securityhub_finding_aggregator",
      "name": "main",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "id": "arn:aws:securityhub:us-east-1:342597974367:finding-aggregator/e4ccd535-3380-a69b-a3ea-209135de44c1",
            "linking_mode": "ALL_REGIONS",
            "region": "us-east-1",
            "specified_regions": null
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "aws_securityhub_account.main"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_securityhub_product_subscription",
      "name": "guardduty",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:securityhub:us-east-1:342597974367:product-subscription/aws/guardduty",
            "id": "arn:aws:securityhub:us-east-1::product/aws/guardduty,arn:aws:securityhub:us-east-1:342597974367:product-subscription/aws/guardduty",
            "product_arn": "arn:aws:securityhub:us-east-1::product/aws/guardduty",
            "region": "us-east-1"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "aws_securityhub_account.main"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_securityhub_standards_subscription",
      "name": "foundational",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "id": "arn:aws:securityhub:us-east-1:342597974367:subscription/aws-foundational-security-best-practices/v/1.0.0",
            "region": "us-east-1",
            "standards_arn": "arn:aws:securityhub:us-east-1::standards/aws-foundational-security-best-practices/v/1.0.0",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAsImRlbGV0ZSI6MTgwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "aws_securityhub_account.main"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_sns_topic",
      "name": "security_alerts",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "application_failure_feedback_role_arn": "",
            "application_success_feedback_role_arn": "",
            "application_success_feedback_sample_rate": 0,
            "archive_policy": "",
            "arn": "arn:aws:sns:us-east-1:342597974367:security-monitoring-alerts-synth78029461",
            "beginning_archive_time": "",
            "content_based_deduplication": false,
            "delivery_policy": "",
            "display_name": "",
            "fifo_throughput_scope": "",
            "fifo_topic": false,
            "firehose_failure_feedback_role_arn": "",
            "firehose_success_feedback_role_arn": "",
            "firehose_success_feedback_sample_rate": 0,
            "http_failure_feedback_role_arn": "",
            "http_success_feedback_role_arn": "",
            "http_success_feedback_sample_rate": 0,
            "id": "arn:aws:sns:us-east-1:342597974367:security-monitoring-alerts-synth78029461",
            "kms_master_key_id": "3ee92177-ce64-4479-9a75-ee6cd897b841",
            "lambda_failure_feedback_role_arn": "",
            "lambda_success_feedback_role_arn": "",
            "lambda_success_feedback_sample_rate": 0,
            "name": "security-monitoring-alerts-synth78029461",
            "name_prefix": "",
            "owner": "342597974367",
            "policy": "{\"Id\":\"security-alerts-policy\",\"Statement\":[{\"Action\":\"SNS:Publish\",\"Effect\":\"Allow\",\"Principal\":{\"Service\":\"events.amazonaws.com\"},\"Resource\":\"arn:aws:sns:us-east-1:342597974367:security-monitoring-alerts-synth78029461\",\"Sid\":\"AllowEventBridgePublish\"}],\"Version\":\"2012-10-17\"}",
            "region": "us-east-1",
            "signature_version": 0,
            "sqs_failure_feedback_role_arn": "",
            "sqs_success_feedback_role_arn": "",
            "sqs_success_feedback_sample_rate": 0,
            "tags": {
              "Environment": "production",
              "ManagedBy": "Terraform",
              "Name": "security-alerts-topic-synth78029461",
              "Owner": "SecurityTeam",
              "Purpose": "Security Monitoring"
            },
            "tags_all": {
              "Environment": "production",
              "ManagedBy": "Terraform",
              "Name": "security-alerts-topic-synth78029461",
              "Owner": "SecurityTeam",
              "Purpose": "Security Monitoring"
            },
            "tracing_config": ""
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "aws_kms_key.security_key",
            "data.aws_caller_identity.current"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_sns_topic_policy",
      "name": "security_alerts",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:sns:us-east-1:342597974367:security-monitoring-alerts-synth78029461",
            "id": "arn:aws:sns:us-east-1:342597974367:security-monitoring-alerts-synth78029461",
            "owner": "342597974367",
            "policy": "{\"Id\":\"security-alerts-policy\",\"Statement\":[{\"Action\":\"SNS:Publish\",\"Effect\":\"Allow\",\"Principal\":{\"Service\":\"events.amazonaws.com\"},\"Resource\":\"arn:aws:sns:us-east-1:342597974367:security-monitoring-alerts-synth78029461\",\"Sid\":\"AllowEventBridgePublish\"}],\"Version\":\"2012-10-17\"}",
            "region": "us-east-1"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "aws_kms_key.security_key",
            "aws_sns_topic.security_alerts",
            "data.aws_caller_identity.current"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_sns_topic_subscription",
      "name": "security_email",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:sns:us-east-1:342597974367:security-monitoring-alerts-synth78029461:4f8ec537-fa9b-414d-81ec-2afe94392a6b",
            "confirmation_timeout_in_minutes": 1,
            "confirmation_was_authenticated": false,
            "delivery_policy": "",
            "endpoint": "security@example.com",
            "endpoint_auto_confirms": false,
            "filter_policy": "{\"severity\":[\"HIGH\",\"CRITICAL\"]}",
            "filter_policy_scope": "MessageAttributes",
            "id": "arn:aws:sns:us-east-1:342597974367:security-monitoring-alerts-synth78029461:4f8ec537-fa9b-414d-81ec-2afe94392a6b",
            "owner_id": "342597974367",
            "pending_confirmation": true,
            "protocol": "email",
            "raw_message_delivery": false,
            "redrive_policy": "",
            "region": "us-east-1",
            "replay_policy": "",
            "subscription_role_arn": "",
            "topic_arn": "arn:aws:sns:us-east-1:342597974367:security-monitoring-alerts-synth78029461"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "aws_kms_key.security_key",
            "aws_sns_topic.security_alerts",
            "data.aws_caller_identity.current"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "random_id",
      "name": "bucket_suffix",
      "provider": "provider[\"registry.terraform.io/hashicorp/random\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "b64_std": "AGsDj0Z9Mg8=",
            "b64_url": "AGsDj0Z9Mg8",
            "byte_length": 8,
            "dec": "30121736405856783",
            "hex": "006b038f467d320f",
            "id": "AGsDj0Z9Mg8",
            "keepers": null,
            "prefix": null
          },
          "sensitive_attributes": []
        }
      ]
    }
  ],
  "check_results": null
}
