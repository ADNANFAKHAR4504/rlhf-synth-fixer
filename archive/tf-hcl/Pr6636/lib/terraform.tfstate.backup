{
  "version": 4,
  "terraform_version": "1.9.0",
  "serial": 29,
  "lineage": "94a1735a-6738-7158-42b5-c7ebe6ca5bcd",
  "outputs": {
    "application_data_key_arn": {
      "value": "arn:aws:kms:us-east-1:342597974367:key/4f82cc60-ede2-4ddc-a06f-1339b60028f2",
      "type": "string"
    },
    "application_data_key_id": {
      "value": "4f82cc60-ede2-4ddc-a06f-1339b60028f2",
      "type": "string"
    },
    "auditor_role_arn": {
      "value": "arn:aws:iam::342597974367:role/auditor-test-101912422",
      "type": "string"
    },
    "devops_role_arn": {
      "value": "arn:aws:iam::342597974367:role/devops-test-101912422",
      "type": "string"
    },
    "ecs_service_role_arn": {
      "value": "arn:aws:iam::342597974367:role/ecs-service-role-test-101912422",
      "type": "string"
    },
    "external_id": {
      "value": "X8Adi7PeKq4BvLqRmLSEiTcGP30jKhP1",
      "type": "string",
      "sensitive": true
    },
    "iam_activity_log_group_name": {
      "value": "/aws/iam/activity-test-101912422",
      "type": "string"
    },
    "infrastructure_secrets_key_arn": {
      "value": "arn:aws:kms:us-east-1:342597974367:key/95d55c5d-dc47-4264-9f54-5bbbf191bb63",
      "type": "string"
    },
    "infrastructure_secrets_key_id": {
      "value": "95d55c5d-dc47-4264-9f54-5bbbf191bb63",
      "type": "string"
    },
    "permission_boundary_arn": {
      "value": "arn:aws:iam::342597974367:policy/permission-boundary-test-101912422",
      "type": "string"
    },
    "rds_service_role_arn": {
      "value": "arn:aws:iam::342597974367:role/rds-service-role-test-101912422",
      "type": "string"
    },
    "security_admin_role_arn": {
      "value": "arn:aws:iam::342597974367:role/security-admin-test-101912422",
      "type": "string"
    },
    "terraform_state_key_arn": {
      "value": "arn:aws:kms:us-east-1:342597974367:key/7500d6b1-db06-416a-ac7f-d9fb0ede7a03",
      "type": "string"
    },
    "terraform_state_key_id": {
      "value": "7500d6b1-db06-416a-ac7f-d9fb0ede7a03",
      "type": "string"
    }
  },
  "resources": [
    {
      "mode": "data",
      "type": "aws_caller_identity",
      "name": "current",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "account_id": "342597974367",
            "arn": "arn:aws:iam::342597974367:user/iac-synth-deploy",
            "id": "342597974367",
            "user_id": "AIDAU7RDOHFP6S4NLVPKQ"
          },
          "sensitive_attributes": []
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_iam_policy",
      "name": "auditor",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:iam::342597974367:policy/auditor-policy-test-101912422",
            "attachment_count": 0,
            "description": "Auditor read-only policy",
            "id": "arn:aws:iam::342597974367:policy/auditor-policy-test-101912422",
            "name": "auditor-policy-test-101912422",
            "name_prefix": "",
            "path": "/",
            "policy": "{\"Statement\":[{\"Action\":[\"iam:Get*\",\"iam:List*\",\"kms:Describe*\",\"kms:Get*\",\"kms:List*\",\"logs:Describe*\",\"logs:Get*\",\"logs:FilterLogEvents\",\"cloudtrail:LookupEvents\",\"cloudtrail:Get*\",\"cloudtrail:Describe*\"],\"Effect\":\"Allow\",\"Resource\":\"*\",\"Sid\":\"AllowReadOnlyAccess\"},{\"Effect\":\"Deny\",\"NotAction\":[\"iam:Get*\",\"iam:List*\",\"kms:Describe*\",\"kms:Get*\",\"kms:List*\",\"logs:Describe*\",\"logs:Get*\",\"logs:FilterLogEvents\"],\"Resource\":\"*\",\"Sid\":\"DenyAllWriteOperations\"}],\"Version\":\"2012-10-17\"}",
            "policy_id": "ANPAU7RDOHFP2RFRXL5VA",
            "tags": {
              "CostCenter": "Security-001",
              "Environment": "Test",
              "ManagedBy": "Terraform",
              "Name": "auditor-policy-test-101912422",
              "Owner": "SecurityTeam"
            },
            "tags_all": {
              "CostCenter": "Security-001",
              "Environment": "Test",
              "ManagedBy": "Terraform",
              "Name": "auditor-policy-test-101912422",
              "Owner": "SecurityTeam"
            }
          },
          "sensitive_attributes": [],
          "private": "bnVsbA=="
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_iam_policy",
      "name": "devops",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:iam::342597974367:policy/devops-policy-test-101912422",
            "attachment_count": 0,
            "description": "DevOps policy with business hours restrictions",
            "id": "arn:aws:iam::342597974367:policy/devops-policy-test-101912422",
            "name": "devops-policy-test-101912422",
            "name_prefix": "",
            "path": "/",
            "policy": "{\"Statement\":[{\"Action\":[\"ec2:*\",\"s3:*\",\"rds:*\",\"ecs:*\",\"cloudwatch:*\",\"logs:*\",\"kms:Decrypt\",\"kms:Encrypt\",\"kms:GenerateDataKey\"],\"Effect\":\"Allow\",\"Resource\":\"*\",\"Sid\":\"AllowDevOpsOperationsDuringBusinessHours\"},{\"Action\":[\"rds:DeleteDBInstance\",\"rds:DeleteDBCluster\",\"ec2:TerminateInstances\",\"s3:DeleteBucket\"],\"Condition\":{\"StringNotLike\":{\"aws:RequestedRegion\":\"us-east-1\"}},\"Effect\":\"Deny\",\"Resource\":\"*\",\"Sid\":\"DenySensitiveOperationsOutsideBusinessHours\"}],\"Version\":\"2012-10-17\"}",
            "policy_id": "ANPAU7RDOHFPQAJRZQ6DF",
            "tags": {
              "CostCenter": "Security-001",
              "Environment": "Test",
              "ManagedBy": "Terraform",
              "Name": "devops-policy-test-101912422",
              "Owner": "SecurityTeam"
            },
            "tags_all": {
              "CostCenter": "Security-001",
              "Environment": "Test",
              "ManagedBy": "Terraform",
              "Name": "devops-policy-test-101912422",
              "Owner": "SecurityTeam"
            }
          },
          "sensitive_attributes": [],
          "private": "bnVsbA=="
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_iam_policy",
      "name": "permission_boundary",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:iam::342597974367:policy/permission-boundary-test-101912422",
            "attachment_count": 0,
            "description": "Permission boundary restricting access to us-east-1 region",
            "id": "arn:aws:iam::342597974367:policy/permission-boundary-test-101912422",
            "name": "permission-boundary-test-101912422",
            "name_prefix": "",
            "path": "/",
            "policy": "{\"Statement\":[{\"Action\":\"*\",\"Condition\":{\"StringNotEquals\":{\"aws:RequestedRegion\":\"us-east-1\"}},\"Effect\":\"Deny\",\"Resource\":\"*\",\"Sid\":\"RestrictToUSEast1\"}],\"Version\":\"2012-10-17\"}",
            "policy_id": "ANPAU7RDOHFPQRQDSDLEU",
            "tags": {
              "CostCenter": "Security-001",
              "Environment": "Test",
              "ManagedBy": "Terraform",
              "Name": "permission-boundary-test-101912422",
              "Owner": "SecurityTeam"
            },
            "tags_all": {
              "CostCenter": "Security-001",
              "Environment": "Test",
              "ManagedBy": "Terraform",
              "Name": "permission-boundary-test-101912422",
              "Owner": "SecurityTeam"
            }
          },
          "sensitive_attributes": [],
          "private": "bnVsbA=="
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_iam_policy",
      "name": "security_admin",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:iam::342597974367:policy/security-admin-policy-test-101912422",
            "attachment_count": 0,
            "description": "SecurityAdmin policy with business hours restrictions",
            "id": "arn:aws:iam::342597974367:policy/security-admin-policy-test-101912422",
            "name": "security-admin-policy-test-101912422",
            "name_prefix": "",
            "path": "/",
            "policy": "{\"Statement\":[{\"Action\":[\"iam:*\",\"kms:*\",\"logs:*\",\"sts:*\"],\"Effect\":\"Allow\",\"Resource\":\"*\",\"Sid\":\"AllowSecurityOperationsDuringBusinessHours\"},{\"Action\":[\"iam:DeleteRole\",\"iam:DeleteRolePolicy\",\"iam:DeletePolicy\",\"iam:DeleteUser\",\"kms:ScheduleKeyDeletion\",\"kms:DisableKey\"],\"Condition\":{\"StringNotLike\":{\"aws:RequestedRegion\":\"us-east-1\"}},\"Effect\":\"Deny\",\"Resource\":\"*\",\"Sid\":\"DenySensitiveOperationsOutsideBusinessHours\"}],\"Version\":\"2012-10-17\"}",
            "policy_id": "ANPAU7RDOHFP54WIUHK5N",
            "tags": {
              "CostCenter": "Security-001",
              "Environment": "Test",
              "ManagedBy": "Terraform",
              "Name": "security-admin-policy-test-101912422",
              "Owner": "SecurityTeam"
            },
            "tags_all": {
              "CostCenter": "Security-001",
              "Environment": "Test",
              "ManagedBy": "Terraform",
              "Name": "security-admin-policy-test-101912422",
              "Owner": "SecurityTeam"
            }
          },
          "sensitive_attributes": [],
          "private": "bnVsbA=="
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_iam_role",
      "name": "auditor",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:iam::342597974367:role/auditor-test-101912422",
            "assume_role_policy": "{\"Statement\":[{\"Action\":\"sts:AssumeRole\",\"Condition\":{\"Bool\":{\"aws:MultiFactorAuthPresent\":\"true\"},\"StringEquals\":{\"sts:ExternalId\":\"X8Adi7PeKq4BvLqRmLSEiTcGP30jKhP1\"}},\"Effect\":\"Allow\",\"Principal\":{\"AWS\":[\"arn:aws:iam::342597974367:root\"]},\"Sid\":\"AssumeRoleWithMFA\"}],\"Version\":\"2012-10-17\"}",
            "create_date": "2025-11-17T05:37:39Z",
            "description": "Auditor role with MFA enforcement and read-only access",
            "force_detach_policies": false,
            "id": "auditor-test-101912422",
            "inline_policy": [],
            "managed_policy_arns": [],
            "max_session_duration": 3600,
            "name": "auditor-test-101912422",
            "name_prefix": "",
            "path": "/",
            "permissions_boundary": "arn:aws:iam::342597974367:policy/permission-boundary-test-101912422",
            "tags": {
              "CostCenter": "Security-001",
              "Environment": "Test",
              "ManagedBy": "Terraform",
              "Name": "auditor-test-101912422",
              "Owner": "SecurityTeam",
              "Role": "Auditor",
              "SessionName": "auditor-session"
            },
            "tags_all": {
              "CostCenter": "Security-001",
              "Environment": "Test",
              "ManagedBy": "Terraform",
              "Name": "auditor-test-101912422",
              "Owner": "SecurityTeam",
              "Role": "Auditor",
              "SessionName": "auditor-session"
            },
            "unique_id": "AROAU7RDOHFPULLTNIYUV"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "aws_iam_policy.permission_boundary",
            "data.aws_caller_identity.current",
            "random_string.external_id"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_iam_role",
      "name": "devops",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:iam::342597974367:role/devops-test-101912422",
            "assume_role_policy": "{\"Statement\":[{\"Action\":\"sts:AssumeRole\",\"Condition\":{\"Bool\":{\"aws:MultiFactorAuthPresent\":\"true\"},\"StringEquals\":{\"sts:ExternalId\":\"X8Adi7PeKq4BvLqRmLSEiTcGP30jKhP1\"}},\"Effect\":\"Allow\",\"Principal\":{\"AWS\":[\"arn:aws:iam::342597974367:root\"]},\"Sid\":\"AssumeRoleWithMFA\"}],\"Version\":\"2012-10-17\"}",
            "create_date": "2025-11-17T05:37:38Z",
            "description": "DevOps role with MFA enforcement",
            "force_detach_policies": false,
            "id": "devops-test-101912422",
            "inline_policy": [],
            "managed_policy_arns": [],
            "max_session_duration": 3600,
            "name": "devops-test-101912422",
            "name_prefix": "",
            "path": "/",
            "permissions_boundary": "arn:aws:iam::342597974367:policy/permission-boundary-test-101912422",
            "tags": {
              "CostCenter": "Security-001",
              "Environment": "Test",
              "ManagedBy": "Terraform",
              "Name": "devops-test-101912422",
              "Owner": "SecurityTeam",
              "Role": "DevOps",
              "SessionName": "devops-session"
            },
            "tags_all": {
              "CostCenter": "Security-001",
              "Environment": "Test",
              "ManagedBy": "Terraform",
              "Name": "devops-test-101912422",
              "Owner": "SecurityTeam",
              "Role": "DevOps",
              "SessionName": "devops-session"
            },
            "unique_id": "AROAU7RDOHFP3LXCYCD6Q"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "aws_iam_policy.permission_boundary",
            "data.aws_caller_identity.current",
            "random_string.external_id"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_iam_role",
      "name": "ecs_service_role",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:iam::342597974367:role/ecs-service-role-test-101912422",
            "assume_role_policy": "{\"Statement\":[{\"Action\":\"sts:AssumeRole\",\"Effect\":\"Allow\",\"Principal\":{\"Service\":\"ecs.amazonaws.com\"}}],\"Version\":\"2012-10-17\"}",
            "create_date": "2025-11-17T05:37:38Z",
            "description": "ECS service-linked role with custom permission boundary",
            "force_detach_policies": false,
            "id": "ecs-service-role-test-101912422",
            "inline_policy": [],
            "managed_policy_arns": [],
            "max_session_duration": 3600,
            "name": "ecs-service-role-test-101912422",
            "name_prefix": "",
            "path": "/",
            "permissions_boundary": "arn:aws:iam::342597974367:policy/permission-boundary-test-101912422",
            "tags": {
              "CostCenter": "Security-001",
              "Environment": "Test",
              "ManagedBy": "Terraform",
              "Name": "ecs-service-role-test-101912422",
              "Owner": "SecurityTeam",
              "Service": "ECS"
            },
            "tags_all": {
              "CostCenter": "Security-001",
              "Environment": "Test",
              "ManagedBy": "Terraform",
              "Name": "ecs-service-role-test-101912422",
              "Owner": "SecurityTeam",
              "Service": "ECS"
            },
            "unique_id": "AROAU7RDOHFPXOEIGSH7V"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "aws_iam_policy.permission_boundary"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_iam_role",
      "name": "rds_service_role",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:iam::342597974367:role/rds-service-role-test-101912422",
            "assume_role_policy": "{\"Statement\":[{\"Action\":\"sts:AssumeRole\",\"Effect\":\"Allow\",\"Principal\":{\"Service\":\"rds.amazonaws.com\"}}],\"Version\":\"2012-10-17\"}",
            "create_date": "2025-11-17T05:37:39Z",
            "description": "RDS service-linked role with custom permission boundary",
            "force_detach_policies": false,
            "id": "rds-service-role-test-101912422",
            "inline_policy": [],
            "managed_policy_arns": [],
            "max_session_duration": 3600,
            "name": "rds-service-role-test-101912422",
            "name_prefix": "",
            "path": "/",
            "permissions_boundary": "arn:aws:iam::342597974367:policy/permission-boundary-test-101912422",
            "tags": {
              "CostCenter": "Security-001",
              "Environment": "Test",
              "ManagedBy": "Terraform",
              "Name": "rds-service-role-test-101912422",
              "Owner": "SecurityTeam",
              "Service": "RDS"
            },
            "tags_all": {
              "CostCenter": "Security-001",
              "Environment": "Test",
              "ManagedBy": "Terraform",
              "Name": "rds-service-role-test-101912422",
              "Owner": "SecurityTeam",
              "Service": "RDS"
            },
            "unique_id": "AROAU7RDOHFPXKPZ5EUOK"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "aws_iam_policy.permission_boundary"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_iam_role",
      "name": "security_admin",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:iam::342597974367:role/security-admin-test-101912422",
            "assume_role_policy": "{\"Statement\":[{\"Action\":\"sts:AssumeRole\",\"Condition\":{\"Bool\":{\"aws:MultiFactorAuthPresent\":\"true\"},\"StringEquals\":{\"sts:ExternalId\":\"X8Adi7PeKq4BvLqRmLSEiTcGP30jKhP1\"}},\"Effect\":\"Allow\",\"Principal\":{\"AWS\":[\"arn:aws:iam::342597974367:root\"]},\"Sid\":\"AssumeRoleWithMFA\"}],\"Version\":\"2012-10-17\"}",
            "create_date": "2025-11-17T05:37:38Z",
            "description": "SecurityAdmin role with MFA enforcement",
            "force_detach_policies": false,
            "id": "security-admin-test-101912422",
            "inline_policy": [],
            "managed_policy_arns": [],
            "max_session_duration": 3600,
            "name": "security-admin-test-101912422",
            "name_prefix": "",
            "path": "/",
            "permissions_boundary": "arn:aws:iam::342597974367:policy/permission-boundary-test-101912422",
            "tags": {
              "CostCenter": "Security-001",
              "Environment": "Test",
              "ManagedBy": "Terraform",
              "Name": "security-admin-test-101912422",
              "Owner": "SecurityTeam",
              "Role": "SecurityAdmin",
              "SessionName": "security-admin-session"
            },
            "tags_all": {
              "CostCenter": "Security-001",
              "Environment": "Test",
              "ManagedBy": "Terraform",
              "Name": "security-admin-test-101912422",
              "Owner": "SecurityTeam",
              "Role": "SecurityAdmin",
              "SessionName": "security-admin-session"
            },
            "unique_id": "AROAU7RDOHFPYBYG755D3"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "aws_iam_policy.permission_boundary",
            "data.aws_caller_identity.current",
            "random_string.external_id"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_iam_role_policy_attachment",
      "name": "auditor",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "id": "auditor-test-101912422/arn:aws:iam::342597974367:policy/auditor-policy-test-101912422",
            "policy_arn": "arn:aws:iam::342597974367:policy/auditor-policy-test-101912422",
            "role": "auditor-test-101912422"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "aws_iam_policy.auditor",
            "aws_iam_policy.permission_boundary",
            "aws_iam_role.auditor",
            "data.aws_caller_identity.current",
            "random_string.external_id"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_iam_role_policy_attachment",
      "name": "devops",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "id": "devops-test-101912422/arn:aws:iam::342597974367:policy/devops-policy-test-101912422",
            "policy_arn": "arn:aws:iam::342597974367:policy/devops-policy-test-101912422",
            "role": "devops-test-101912422"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "aws_iam_policy.devops",
            "aws_iam_policy.permission_boundary",
            "aws_iam_role.devops",
            "data.aws_caller_identity.current",
            "random_string.external_id"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_iam_role_policy_attachment",
      "name": "ecs_service_role",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "id": "ecs-service-role-test-101912422/arn:aws:iam::aws:policy/service-role/AmazonECSTaskExecutionRolePolicy",
            "policy_arn": "arn:aws:iam::aws:policy/service-role/AmazonECSTaskExecutionRolePolicy",
            "role": "ecs-service-role-test-101912422"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "aws_iam_policy.permission_boundary",
            "aws_iam_role.ecs_service_role"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_iam_role_policy_attachment",
      "name": "rds_monitoring",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "id": "rds-service-role-test-101912422/arn:aws:iam::aws:policy/service-role/AmazonRDSEnhancedMonitoringRole",
            "policy_arn": "arn:aws:iam::aws:policy/service-role/AmazonRDSEnhancedMonitoringRole",
            "role": "rds-service-role-test-101912422"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "aws_iam_policy.permission_boundary",
            "aws_iam_role.rds_service_role"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_iam_role_policy_attachment",
      "name": "security_admin",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "id": "security-admin-test-101912422/arn:aws:iam::342597974367:policy/security-admin-policy-test-101912422",
            "policy_arn": "arn:aws:iam::342597974367:policy/security-admin-policy-test-101912422",
            "role": "security-admin-test-101912422"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "aws_iam_policy.permission_boundary",
            "aws_iam_policy.security_admin",
            "aws_iam_role.security_admin",
            "data.aws_caller_identity.current",
            "random_string.external_id"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_kms_alias",
      "name": "application_data",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:kms:us-east-1:342597974367:alias/application-data-test-101912422",
            "id": "alias/application-data-test-101912422",
            "name": "alias/application-data-test-101912422",
            "name_prefix": "",
            "region": "us-east-1",
            "target_key_arn": "arn:aws:kms:us-east-1:342597974367:key/4f82cc60-ede2-4ddc-a06f-1339b60028f2",
            "target_key_id": "4f82cc60-ede2-4ddc-a06f-1339b60028f2"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "aws_kms_key.application_data"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_kms_alias",
      "name": "infrastructure_secrets",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:kms:us-east-1:342597974367:alias/infrastructure-secrets-test-101912422",
            "id": "alias/infrastructure-secrets-test-101912422",
            "name": "alias/infrastructure-secrets-test-101912422",
            "name_prefix": "",
            "region": "us-east-1",
            "target_key_arn": "arn:aws:kms:us-east-1:342597974367:key/95d55c5d-dc47-4264-9f54-5bbbf191bb63",
            "target_key_id": "95d55c5d-dc47-4264-9f54-5bbbf191bb63"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "aws_kms_key.infrastructure_secrets"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_kms_alias",
      "name": "terraform_state",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:kms:us-east-1:342597974367:alias/terraform-state-test-101912422",
            "id": "alias/terraform-state-test-101912422",
            "name": "alias/terraform-state-test-101912422",
            "name_prefix": "",
            "region": "us-east-1",
            "target_key_arn": "arn:aws:kms:us-east-1:342597974367:key/7500d6b1-db06-416a-ac7f-d9fb0ede7a03",
            "target_key_id": "7500d6b1-db06-416a-ac7f-d9fb0ede7a03"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "aws_kms_key.terraform_state"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_kms_key",
      "name": "application_data",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:kms:us-east-1:342597974367:key/4f82cc60-ede2-4ddc-a06f-1339b60028f2",
            "bypass_policy_lockout_safety_check": false,
            "custom_key_store_id": "",
            "customer_master_key_spec": "SYMMETRIC_DEFAULT",
            "deletion_window_in_days": 7,
            "description": "KMS key for application data encryption-test-101912422",
            "enable_key_rotation": true,
            "id": "4f82cc60-ede2-4ddc-a06f-1339b60028f2",
            "is_enabled": true,
            "key_id": "4f82cc60-ede2-4ddc-a06f-1339b60028f2",
            "key_usage": "ENCRYPT_DECRYPT",
            "multi_region": false,
            "policy": "{\"Id\":\"key-default-1\",\"Statement\":[{\"Action\":\"kms:*\",\"Effect\":\"Allow\",\"Principal\":{\"AWS\":\"arn:aws:iam::342597974367:root\"},\"Resource\":\"*\",\"Sid\":\"Enable IAM User Permissions\"}],\"Version\":\"2012-10-17\"}",
            "region": "us-east-1",
            "rotation_period_in_days": 365,
            "tags": {
              "CostCenter": "Security-001",
              "Environment": "Test",
              "ManagedBy": "Terraform",
              "Name": "application-data-key-test-101912422",
              "Owner": "SecurityTeam",
              "Purpose": "ApplicationData"
            },
            "tags_all": {
              "CostCenter": "Security-001",
              "Environment": "Test",
              "ManagedBy": "Terraform",
              "Name": "application-data-key-test-101912422",
              "Owner": "SecurityTeam",
              "Purpose": "ApplicationData"
            },
            "timeouts": null,
            "xks_key_id": ""
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxMjAwMDAwMDAwMDB9fQ=="
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_kms_key",
      "name": "infrastructure_secrets",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:kms:us-east-1:342597974367:key/95d55c5d-dc47-4264-9f54-5bbbf191bb63",
            "bypass_policy_lockout_safety_check": false,
            "custom_key_store_id": "",
            "customer_master_key_spec": "SYMMETRIC_DEFAULT",
            "deletion_window_in_days": 7,
            "description": "KMS key for infrastructure secrets-test-101912422",
            "enable_key_rotation": true,
            "id": "95d55c5d-dc47-4264-9f54-5bbbf191bb63",
            "is_enabled": true,
            "key_id": "95d55c5d-dc47-4264-9f54-5bbbf191bb63",
            "key_usage": "ENCRYPT_DECRYPT",
            "multi_region": false,
            "policy": "{\"Id\":\"key-default-1\",\"Statement\":[{\"Action\":\"kms:*\",\"Effect\":\"Allow\",\"Principal\":{\"AWS\":\"arn:aws:iam::342597974367:root\"},\"Resource\":\"*\",\"Sid\":\"Enable IAM User Permissions\"}],\"Version\":\"2012-10-17\"}",
            "region": "us-east-1",
            "rotation_period_in_days": 365,
            "tags": {
              "CostCenter": "Security-001",
              "Environment": "Test",
              "ManagedBy": "Terraform",
              "Name": "infrastructure-secrets-key-test-101912422",
              "Owner": "SecurityTeam",
              "Purpose": "InfrastructureSecrets"
            },
            "tags_all": {
              "CostCenter": "Security-001",
              "Environment": "Test",
              "ManagedBy": "Terraform",
              "Name": "infrastructure-secrets-key-test-101912422",
              "Owner": "SecurityTeam",
              "Purpose": "InfrastructureSecrets"
            },
            "timeouts": null,
            "xks_key_id": ""
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxMjAwMDAwMDAwMDB9fQ=="
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_kms_key",
      "name": "terraform_state",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:kms:us-east-1:342597974367:key/7500d6b1-db06-416a-ac7f-d9fb0ede7a03",
            "bypass_policy_lockout_safety_check": false,
            "custom_key_store_id": "",
            "customer_master_key_spec": "SYMMETRIC_DEFAULT",
            "deletion_window_in_days": 7,
            "description": "KMS key for Terraform state encryption-test-101912422",
            "enable_key_rotation": true,
            "id": "7500d6b1-db06-416a-ac7f-d9fb0ede7a03",
            "is_enabled": true,
            "key_id": "7500d6b1-db06-416a-ac7f-d9fb0ede7a03",
            "key_usage": "ENCRYPT_DECRYPT",
            "multi_region": false,
            "policy": "{\"Id\":\"key-default-1\",\"Statement\":[{\"Action\":\"kms:*\",\"Effect\":\"Allow\",\"Principal\":{\"AWS\":\"arn:aws:iam::342597974367:root\"},\"Resource\":\"*\",\"Sid\":\"Enable IAM User Permissions\"}],\"Version\":\"2012-10-17\"}",
            "region": "us-east-1",
            "rotation_period_in_days": 365,
            "tags": {
              "CostCenter": "Security-001",
              "Environment": "Test",
              "ManagedBy": "Terraform",
              "Name": "terraform-state-key-test-101912422",
              "Owner": "SecurityTeam",
              "Purpose": "TerraformState"
            },
            "tags_all": {
              "CostCenter": "Security-001",
              "Environment": "Test",
              "ManagedBy": "Terraform",
              "Name": "terraform-state-key-test-101912422",
              "Owner": "SecurityTeam",
              "Purpose": "TerraformState"
            },
            "timeouts": null,
            "xks_key_id": ""
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxMjAwMDAwMDAwMDB9fQ=="
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_kms_key_policy",
      "name": "application_data",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "bypass_policy_lockout_safety_check": false,
            "id": "4f82cc60-ede2-4ddc-a06f-1339b60028f2",
            "key_id": "4f82cc60-ede2-4ddc-a06f-1339b60028f2",
            "policy": "{\"Statement\":[{\"Action\":\"kms:*\",\"Effect\":\"Allow\",\"Principal\":{\"AWS\":\"arn:aws:iam::342597974367:root\"},\"Resource\":\"*\",\"Sid\":\"Enable IAM User Permissions\"},{\"Action\":[\"kms:Decrypt\",\"kms:Encrypt\",\"kms:GenerateDataKey\",\"kms:DescribeKey\"],\"Effect\":\"Allow\",\"Principal\":{\"AWS\":[\"arn:aws:iam::342597974367:role/security-admin-test-101912422\",\"arn:aws:iam::342597974367:role/devops-test-101912422\"]},\"Resource\":\"*\",\"Sid\":\"Allow SecurityAdmin and DevOps roles to use the key\"},{\"Action\":[\"kms:DescribeKey\",\"kms:GetKeyPolicy\",\"kms:GetKeyRotationStatus\"],\"Effect\":\"Allow\",\"Principal\":{\"AWS\":\"arn:aws:iam::342597974367:role/auditor-test-101912422\"},\"Resource\":\"*\",\"Sid\":\"Allow Auditor role to describe key\"}],\"Version\":\"2012-10-17\"}",
            "region": "us-east-1"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "aws_iam_policy.permission_boundary",
            "aws_iam_role.auditor",
            "aws_iam_role.devops",
            "aws_iam_role.security_admin",
            "aws_kms_key.application_data",
            "data.aws_caller_identity.current",
            "random_string.external_id"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_kms_key_policy",
      "name": "infrastructure_secrets",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "bypass_policy_lockout_safety_check": false,
            "id": "95d55c5d-dc47-4264-9f54-5bbbf191bb63",
            "key_id": "95d55c5d-dc47-4264-9f54-5bbbf191bb63",
            "policy": "{\"Statement\":[{\"Action\":\"kms:*\",\"Effect\":\"Allow\",\"Principal\":{\"AWS\":\"arn:aws:iam::342597974367:root\"},\"Resource\":\"*\",\"Sid\":\"Enable IAM User Permissions\"},{\"Action\":[\"kms:Decrypt\",\"kms:Encrypt\",\"kms:GenerateDataKey\",\"kms:DescribeKey\"],\"Effect\":\"Allow\",\"Principal\":{\"AWS\":\"arn:aws:iam::342597974367:role/security-admin-test-101912422\"},\"Resource\":\"*\",\"Sid\":\"Allow SecurityAdmin role to use the key\"},{\"Action\":[\"kms:DescribeKey\",\"kms:GetKeyPolicy\",\"kms:GetKeyRotationStatus\"],\"Effect\":\"Allow\",\"Principal\":{\"AWS\":\"arn:aws:iam::342597974367:role/auditor-test-101912422\"},\"Resource\":\"*\",\"Sid\":\"Allow Auditor role to describe key\"}],\"Version\":\"2012-10-17\"}",
            "region": "us-east-1"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "aws_iam_policy.permission_boundary",
            "aws_iam_role.auditor",
            "aws_iam_role.security_admin",
            "aws_kms_key.infrastructure_secrets",
            "data.aws_caller_identity.current",
            "random_string.external_id"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "random_string",
      "name": "external_id",
      "provider": "provider[\"registry.terraform.io/hashicorp/random\"]",
      "instances": [
        {
          "schema_version": 2,
          "attributes": {
            "id": "X8Adi7PeKq4BvLqRmLSEiTcGP30jKhP1",
            "keepers": null,
            "length": 32,
            "lower": true,
            "min_lower": 0,
            "min_numeric": 0,
            "min_special": 0,
            "min_upper": 0,
            "number": true,
            "numeric": true,
            "override_special": null,
            "result": "X8Adi7PeKq4BvLqRmLSEiTcGP30jKhP1",
            "special": false,
            "upper": true
          },
          "sensitive_attributes": []
        }
      ]
    }
  ],
  "check_results": null
}
