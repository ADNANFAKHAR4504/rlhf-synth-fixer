A publishing company needs a secure and efficient content delivery system to serve around twenty thousand premium e-books daily to subscribers worldwide. The system should maintain low latency, enforce access restrictions for authorized users, and capture detailed access logs for analytics and auditing. You need to define the entire infrastructure using Terraform and output only the Terraform code as a single file named tap_stack.tf, with no explanations or additional text.

Use Amazon S3 to store the e-books and configure bucket policies to restrict public access. CloudFront should serve as the content delivery layer, integrated with an Origin Access Identity (OAI) to ensure that only CloudFront can fetch objects from S3. Route 53 should handle DNS routing for the delivery domain, ensuring smooth global resolution. SSL certificates must be provisioned through AWS Certificate Manager (ACM) for secure HTTPS delivery. All access and request metrics should be tracked through CloudWatch, providing insight into usage patterns and performance. Logging should be configured to deliver detailed access logs to a dedicated S3 logging bucket with KMS encryption enabled for data at rest. Finally, define IAM roles and policies based on the principle of least privilege, ensuring that only necessary components have access to the required resources.

The final output should be a complete, valid Terraform configuration for tap_stack.tf â€” only the code, no explanations, comments, or extra output.