A financial application requires secure, private access to AWS services, handling roughly twenty thousand daily requests within a controlled network. The design must maintain strict data protection, support monitoring, and provide automated alerting on anomalies. Define the infrastructure entirely in Terraform, returning only a single file named tap_stack.tf; the output must be code only â€” no explanations, comments, or extra text. The setup should include a VPC with CIDR 10.0.0.0/16, private subnets, and security groups that tightly restrict inbound and outbound traffic. Configure VPC endpoints for both S3 and DynamoDB to enable private connectivity without using public internet routes. Capture detailed network activity with VPC Flow Logs sent to CloudWatch for real-time visibility, and deploy a Lambda function to trigger alerts on suspicious patterns or failures. Apply IAM roles and policies following the principle of least privilege to control all service interactions securely. The result should be a validated, production-ready Terraform configuration defining a fully functional private service access system.

