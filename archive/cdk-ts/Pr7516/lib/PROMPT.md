We need a CDK TypeScript program to deploy a fully fault-tolerant distributed task processing system for a financial services workload. The primary stack must run in us-east-1, with DynamoDB global table replication to us-west-2 for backup. The system must guarantee at-least-once processing with automatic retry and dead-letter handling, while supporting millions of daily transactions.

The infrastructure must include an SQS queue with 300-second visibility timeout, 14-day retention, server-side encryption using a customer-managed KMS key, and a dead-letter queue with a maxReceiveCount of 3. DynamoDB must use on-demand billing with a global secondary index for task status tracking, PITR enabled, Contributor Insights enabled, and TTL for distributed lock expiration. Lambda functions must run on ARM-based Graviton2 processors, use reserved concurrency of 50, fetch environment variables from SSM Parameter Store, and implement Lambda destinations for both success and failure using SNS topics. EventBridge rules must trigger processing based on S3 upload events from multiple buckets with input transformers to normalize event formats.

The stack must include distributed locking via DynamoDB conditional writes, CloudWatch alarms for DLQs exceeding 10 messages, a dashboard showing queue depth, Lambda metrics, and DynamoDB usage, and VPC endpoints for private communication between services. All resources must be tagged consistently for production (Project=DistributedTaskSystem, Owner=SiddhantRaj, Environment=Production).

The output should be a single CDK v2 TypeScript stack (TapStack) including all queues, DLQs, DynamoDB tables, Lambda functions, EventBridge rules, SNS topics, distributed locking logic, monitoring, and cross-region replication wiring, ready for deployment in a production multi-region setup.