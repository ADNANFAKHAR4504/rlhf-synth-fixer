Act as an expert AWS CloudFormation engineer. Your task is to create a complete CloudFormation template in JSON format to deploy a serverless email notification system for a job board platform in the us-east-1 region.

The infrastructure must include the following components and adhere to all specified best practices:

1. Data Storage (Amazon DynamoDB):

- Create two DynamoDB tables with on-demand capacity.
- UserPreferences Table:
- Primary Key: userId (String).
- Attributes: Must include keywords (String Set).
- JobPostings Table:
- Primary Key: jobId (String).
- Attributes: Must include title (String) and description (String).

2. Email Templates (Amazon S3):

- Create a private S3 bucket to store HTML email templates.
- The bucket must be pre-populated with a placeholder template file named notification-template.html.

3. Business Logic (AWS Lambda):

- Create a Lambda function using the Node.js 18.x runtime.
- The function's logic must perform the following actions:
- Scan both DynamoDB tables.
- Match jobs to users based on their preferences.
- Fetch the notification-template.html from the S3 bucket.
- Use the AWS SES SDK to send the notification emails.
- Use environment variables to pass the DynamoDB table names and the S3 bucket name to the function.

4. Scheduling (Amazon EventBridge):

- Create an EventBridge scheduled rule that triggers the Lambda function once daily.
- Use the cron expression: cron(0 12 \* _ ? _).

5. Email Delivery (Amazon SES):

- Create an SES Configuration Set to manage sending and to publish email delivery events (sends, bounces, complaints) to CloudWatch.

6. Monitoring (Amazon CloudWatch):

- Ensure the Lambda function has permissions to write logs to CloudWatch Logs.
- The SES Configuration Set must be configured to send its metrics to CloudWatch.

7. Security (IAM):

- Create a single, least-privilege IAM Execution Role for the Lambda function.
- The role must grant only the following permissions:
  - dynamodb:Scan on both DynamoDB tables.
  - s3:GetObject on the S3 templates bucket.
  - ses:SendEmail.
  - logs:CreateLogGroup, logs:CreateLogStream, logs:PutLogEvents.

8. Parameters & Outputs:

- Use the Parameters section for the SenderEmail (a verified SES email address).
- Do not hardcode any other resource names or values; they should be dynamically generated by CloudFormation.
- Use the Outputs section to expose the names of the UserPreferencesTable, JobPostingsTable, S3Bucket, and the LambdaFunctionARN.

9. Tagging:

- Tag all created resources with the key iac-rlhf-amazon.

Ensure the final output is a single, valid JSON object representing the CloudFormation template.
