{
  "AWSTemplateFormatVersion": "2010-09-09",
  "Description": "Optimized transaction processing infrastructure with cost-efficient resource configurations and multi-region support",
  "Parameters": {
    "EnvironmentType": {
      "Type": "String",
      "Default": "development",
      "AllowedValues": [
        "development",
        "staging",
        "production"
      ],
      "Description": "Environment type for conditional resource deployment"
    },
    "EnvironmentSuffix": {
      "Type": "String",
      "Description": "Unique suffix for resource naming to support multiple PR environments",
      "MinLength": 1,
      "MaxLength": 20
    },
    "LambdaMemorySize": {
      "Type": "Number",
      "Default": 1024,
      "AllowedValues": [
        512,
        1024,
        2048
      ],
      "Description": "Memory allocation for Lambda functions in MB"
    },
    "DBUsername": {
      "Type": "String",
      "Description": "Master username for RDS database",
      "NoEcho": true,
      "MinLength": 1,
      "MaxLength": 16,
      "AllowedPattern": "[a-zA-Z][a-zA-Z0-9]*",
      "Default": "RdsUser"
    },
    "DBPasswordSecretArn": {
      "Type": "String",
      "Description": "ARN of AWS Secrets Manager secret containing database password",
      "NoEcho": true,
      "Default": "arn:aws:secretsmanager:us-east-1:342597974367:secret:db-secret-dev-12345-9658546-4eIjmA"
    },
    "VpcId": {
      "Type": "AWS::EC2::VPC::Id",
      "Description": "VPC ID for resource deployment",
      "Default": "vpc-0a0b77fc646b1223c"
    },
    "PrivateSubnetIds": {
      "Type": "List<AWS::EC2::Subnet::Id>",
      "Description": "Private subnet IDs for RDS and Lambda deployment",
      "Default": "subnet-071df9a9810c38aa4,subnet-020e0aafba890431d,subnet-052da3c0a8cae05b8"
    },
    "DBSubnetIds": {
      "Type": "List<AWS::EC2::Subnet::Id>",
      "Description": "Subnet IDs for RDS subnet group (minimum 2 AZs for Multi-AZ)",
      "Default": "subnet-071df9a9810c38aa4,subnet-020e0aafba890431d,subnet-052da3c0a8cae05b8"
    }
  },
  "Conditions": {
    "IsProduction": {
      "Fn::Equals": [
        {
          "Ref": "EnvironmentType"
        },
        "production"
      ]
    }
  },
  "Resources": {
    "LambdaExecutionManagedPolicy": {
      "Type": "AWS::IAM::ManagedPolicy",
      "Properties": {
        "ManagedPolicyName": {
          "Fn::Sub": "lambda-execution-policy-${EnvironmentSuffix}"
        },
        "Description": "Consolidated managed policy for Lambda execution replacing three duplicate inline policies",
        "PolicyDocument": {
          "Version": "2012-10-17",
          "Statement": [
            {
              "Effect": "Allow",
              "Action": [
                "logs:CreateLogGroup",
                "logs:CreateLogStream",
                "logs:PutLogEvents"
              ],
              "Resource": {
                "Fn::Sub": "arn:aws:logs:${AWS::Region}:${AWS::AccountId}:log-group:/aws/lambda/*"
              }
            },
            {
              "Effect": "Allow",
              "Action": [
                "ec2:CreateNetworkInterface",
                "ec2:DescribeNetworkInterfaces",
                "ec2:DeleteNetworkInterface",
                "ec2:AssignPrivateIpAddresses",
                "ec2:UnassignPrivateIpAddresses"
              ],
              "Resource": "*"
            },
            {
              "Effect": "Allow",
              "Action": [
                "dynamodb:GetItem",
                "dynamodb:PutItem",
                "dynamodb:UpdateItem",
                "dynamodb:DeleteItem",
                "dynamodb:Query",
                "dynamodb:Scan"
              ],
              "Resource": {
                "Fn::Sub": "arn:aws:dynamodb:${AWS::Region}:${AWS::AccountId}:table/session-*"
              }
            },
            {
              "Effect": "Allow",
              "Action": [
                "rds:DescribeDBInstances",
                "rds:DescribeDBClusters"
              ],
              "Resource": {
                "Fn::Sub": "arn:aws:rds:${AWS::Region}:${AWS::AccountId}:db:*"
              }
            },
            {
              "Effect": "Allow",
              "Action": [
                "secretsmanager:GetSecretValue"
              ],
              "Resource": {
                "Fn::Sub": "arn:aws:secretsmanager:${AWS::Region}:${AWS::AccountId}:secret:*"
              }
            },
            {
              "Effect": "Allow",
              "Action": [
                "kms:Decrypt"
              ],
              "Resource": {
                "Fn::Sub": "arn:aws:kms:${AWS::Region}:${AWS::AccountId}:key/*"
              }
            }
          ]
        }
      }
    },
    "TransactionProcessorRole": {
      "Type": "AWS::IAM::Role",
      "Properties": {
        "RoleName": {
          "Fn::Sub": "transaction-processor-role-${EnvironmentSuffix}"
        },
        "AssumeRolePolicyDocument": {
          "Version": "2012-10-17",
          "Statement": [
            {
              "Effect": "Allow",
              "Principal": {
                "Service": "lambda.amazonaws.com"
              },
              "Action": "sts:AssumeRole"
            }
          ]
        },
        "ManagedPolicyArns": [
          {
            "Ref": "LambdaExecutionManagedPolicy"
          }
        ],
        "Tags": [
          {
            "Key": "Environment",
            "Value": {
              "Ref": "EnvironmentType"
            }
          },
          {
            "Key": "EnvironmentSuffix",
            "Value": {
              "Ref": "EnvironmentSuffix"
            }
          }
        ]
      }
    },
    "PaymentProcessorRole": {
      "Type": "AWS::IAM::Role",
      "Properties": {
        "RoleName": {
          "Fn::Sub": "payment-processor-role-${EnvironmentSuffix}"
        },
        "AssumeRolePolicyDocument": {
          "Version": "2012-10-17",
          "Statement": [
            {
              "Effect": "Allow",
              "Principal": {
                "Service": "lambda.amazonaws.com"
              },
              "Action": "sts:AssumeRole"
            }
          ]
        },
        "ManagedPolicyArns": [
          {
            "Ref": "LambdaExecutionManagedPolicy"
          }
        ],
        "Tags": [
          {
            "Key": "Environment",
            "Value": {
              "Ref": "EnvironmentType"
            }
          },
          {
            "Key": "EnvironmentSuffix",
            "Value": {
              "Ref": "EnvironmentSuffix"
            }
          }
        ]
      }
    },
    "OrderProcessorRole": {
      "Type": "AWS::IAM::Role",
      "Properties": {
        "RoleName": {
          "Fn::Sub": "order-processor-role-${EnvironmentSuffix}"
        },
        "AssumeRolePolicyDocument": {
          "Version": "2012-10-17",
          "Statement": [
            {
              "Effect": "Allow",
              "Principal": {
                "Service": "lambda.amazonaws.com"
              },
              "Action": "sts:AssumeRole"
            }
          ]
        },
        "ManagedPolicyArns": [
          {
            "Ref": "LambdaExecutionManagedPolicy"
          }
        ],
        "Tags": [
          {
            "Key": "Environment",
            "Value": {
              "Ref": "EnvironmentType"
            }
          },
          {
            "Key": "EnvironmentSuffix",
            "Value": {
              "Ref": "EnvironmentSuffix"
            }
          }
        ]
      }
    },
    "DBSecurityGroup": {
      "Type": "AWS::EC2::SecurityGroup",
      "Properties": {
        "GroupName": {
          "Fn::Sub": "rds-security-group-${EnvironmentSuffix}"
        },
        "GroupDescription": "Security group for RDS database access",
        "VpcId": {
          "Ref": "VpcId"
        },
        "SecurityGroupIngress": [
          {
            "IpProtocol": "tcp",
            "FromPort": 3306,
            "ToPort": 3306,
            "SourceSecurityGroupId": {
              "Ref": "LambdaSecurityGroup"
            }
          }
        ],
        "Tags": [
          {
            "Key": "Name",
            "Value": {
              "Fn::Sub": "rds-sg-${EnvironmentSuffix}"
            }
          },
          {
            "Key": "Environment",
            "Value": {
              "Ref": "EnvironmentType"
            }
          },
          {
            "Key": "EnvironmentSuffix",
            "Value": {
              "Ref": "EnvironmentSuffix"
            }
          }
        ]
      }
    },
    "LambdaSecurityGroup": {
      "Type": "AWS::EC2::SecurityGroup",
      "Properties": {
        "GroupName": {
          "Fn::Sub": "lambda-security-group-${EnvironmentSuffix}"
        },
        "GroupDescription": "Security group for Lambda functions",
        "VpcId": {
          "Ref": "VpcId"
        },
        "SecurityGroupEgress": [
          {
            "IpProtocol": "-1",
            "CidrIp": "0.0.0.0/0"
          }
        ],
        "Tags": [
          {
            "Key": "Name",
            "Value": {
              "Fn::Sub": "lambda-sg-${EnvironmentSuffix}"
            }
          },
          {
            "Key": "Environment",
            "Value": {
              "Ref": "EnvironmentType"
            }
          },
          {
            "Key": "EnvironmentSuffix",
            "Value": {
              "Ref": "EnvironmentSuffix"
            }
          }
        ]
      }
    },
    "DBSubnetGroup": {
      "Type": "AWS::RDS::DBSubnetGroup",
      "Properties": {
        "DBSubnetGroupName": {
          "Fn::Sub": "rds-subnet-group-${EnvironmentSuffix}"
        },
        "DBSubnetGroupDescription": "Subnet group for RDS Multi-AZ deployment",
        "SubnetIds": {
          "Ref": "DBSubnetIds"
        },
        "Tags": [
          {
            "Key": "Name",
            "Value": {
              "Fn::Sub": "rds-subnet-group-${EnvironmentSuffix}"
            }
          },
          {
            "Key": "Environment",
            "Value": {
              "Ref": "EnvironmentType"
            }
          },
          {
            "Key": "EnvironmentSuffix",
            "Value": {
              "Ref": "EnvironmentSuffix"
            }
          }
        ]
      }
    },
    "TransactionDatabase": {
      "Type": "AWS::RDS::DBInstance",
      "DeletionPolicy": "Snapshot",
      "UpdateReplacePolicy": "Snapshot",
      "Properties": {
        "DBInstanceIdentifier": {
          "Fn::Sub": "transaction-db-${EnvironmentSuffix}"
        },
        "Engine": "mysql",
        "EngineVersion": "8.0.39",
        "DBInstanceClass": "db.t3.large",
        "AllocatedStorage": "100",
        "StorageType": "gp3",
        "StorageEncrypted": true,
        "MultiAZ": true,
        "MasterUsername": {
          "Ref": "DBUsername"
        },
        "MasterUserPassword": {
          "Fn::Sub": "{{resolve:secretsmanager:${DBPasswordSecretArn}:SecretString:password}}"
        },
        "DBSubnetGroupName": {
          "Ref": "DBSubnetGroup"
        },
        "VPCSecurityGroups": [
          {
            "Ref": "DBSecurityGroup"
          }
        ],
        "BackupRetentionPeriod": 7,
        "PreferredBackupWindow": "03:00-04:00",
        "PreferredMaintenanceWindow": "sun:04:00-sun:05:00",
        "EnableCloudwatchLogsExports": [
          "error",
          "general",
          "slowquery"
        ],
        "DeletionProtection": false,
        "PubliclyAccessible": false,
        "Tags": [
          {
            "Key": "Name",
            "Value": {
              "Fn::Sub": "transaction-db-${EnvironmentSuffix}"
            }
          },
          {
            "Key": "Environment",
            "Value": {
              "Ref": "EnvironmentType"
            }
          },
          {
            "Key": "EnvironmentSuffix",
            "Value": {
              "Ref": "EnvironmentSuffix"
            }
          }
        ]
      }
    },
    "TransactionDatabaseReadReplica": {
      "Type": "AWS::RDS::DBInstance",
      "Condition": "IsProduction",
      "DeletionPolicy": "Snapshot",
      "UpdateReplacePolicy": "Snapshot",
      "Properties": {
        "DBInstanceIdentifier": {
          "Fn::Sub": "transaction-db-replica-${EnvironmentSuffix}"
        },
        "SourceDBInstanceIdentifier": {
          "Ref": "TransactionDatabase"
        },
        "DBInstanceClass": "db.t3.large",
        "PubliclyAccessible": false,
        "Tags": [
          {
            "Key": "Name",
            "Value": {
              "Fn::Sub": "transaction-db-replica-${EnvironmentSuffix}"
            }
          },
          {
            "Key": "Environment",
            "Value": {
              "Ref": "EnvironmentType"
            }
          },
          {
            "Key": "EnvironmentSuffix",
            "Value": {
              "Ref": "EnvironmentSuffix"
            }
          }
        ]
      }
    },
    "SessionTable": {
      "Type": "AWS::DynamoDB::Table",
      "DeletionPolicy": "Retain",
      "UpdateReplacePolicy": "Retain",
      "Properties": {
        "TableName": {
          "Fn::Sub": "session-table-${EnvironmentSuffix}"
        },
        "BillingMode": "PAY_PER_REQUEST",
        "AttributeDefinitions": [
          {
            "AttributeName": "sessionId",
            "AttributeType": "S"
          },
          {
            "AttributeName": "userId",
            "AttributeType": "S"
          }
        ],
        "KeySchema": [
          {
            "AttributeName": "sessionId",
            "KeyType": "HASH"
          }
        ],
        "GlobalSecondaryIndexes": [
          {
            "IndexName": "UserIdIndex",
            "KeySchema": [
              {
                "AttributeName": "userId",
                "KeyType": "HASH"
              }
            ],
            "Projection": {
              "ProjectionType": "ALL"
            }
          }
        ],
        "SSESpecification": {
          "SSEEnabled": true
        },
        "PointInTimeRecoverySpecification": {
          "PointInTimeRecoveryEnabled": true
        },
        "TimeToLiveSpecification": {
          "Enabled": true,
          "AttributeName": "ttl"
        },
        "Tags": [
          {
            "Key": "Name",
            "Value": {
              "Fn::Sub": "session-table-${EnvironmentSuffix}"
            }
          },
          {
            "Key": "Environment",
            "Value": {
              "Ref": "EnvironmentType"
            }
          },
          {
            "Key": "EnvironmentSuffix",
            "Value": {
              "Ref": "EnvironmentSuffix"
            }
          }
        ]
      }
    },
    "TransactionProcessorLogGroup": {
      "Type": "AWS::Logs::LogGroup",
      "DeletionPolicy": "Delete",
      "UpdateReplacePolicy": "Delete",
      "Properties": {
        "LogGroupName": {
          "Fn::Sub": "/aws/lambda/transaction-processor-${EnvironmentSuffix}"
        },
        "RetentionInDays": 14
      }
    },
    "TransactionProcessorFunction": {
      "Type": "AWS::Lambda::Function",
      "DeletionPolicy": "Delete",
      "UpdateReplacePolicy": "Delete",
      "Properties": {
        "FunctionName": {
          "Fn::Sub": "transaction-processor-${EnvironmentSuffix}"
        },
        "Runtime": "python3.11",
        "Handler": "index.handler",
        "Role": {
          "Fn::GetAtt": [
            "TransactionProcessorRole",
            "Arn"
          ]
        },
        "MemorySize": {
          "Ref": "LambdaMemorySize"
        },
        "Timeout": 30,
        "Environment": {
          "Variables": {
            "DB_HOST": {
              "Fn::GetAtt": [
                "TransactionDatabase",
                "Endpoint.Address"
              ]
            },
            "DB_PORT": {
              "Fn::GetAtt": [
                "TransactionDatabase",
                "Endpoint.Port"
              ]
            },
            "DB_NAME": "transactions",
            "SESSION_TABLE": {
              "Fn::Sub": "session-table-${EnvironmentSuffix}"
            },
            "ENVIRONMENT": {
              "Ref": "EnvironmentType"
            },
            "REGION": {
              "Ref": "AWS::Region"
            }
          }
        },
        "VpcConfig": {
          "SecurityGroupIds": [
            {
              "Ref": "LambdaSecurityGroup"
            }
          ],
          "SubnetIds": {
            "Ref": "PrivateSubnetIds"
          }
        },
        "Code": {
          "ZipFile": "import json\nimport os\nimport boto3\n\ndef handler(event, context):\n    print(f'Processing transaction in region {os.environ[\"REGION\"]}')\n    return {\n        'statusCode': 200,\n        'body': json.dumps({'message': 'Transaction processed successfully'})\n    }\n"
        },
        "Tags": [
          {
            "Key": "Name",
            "Value": {
              "Fn::Sub": "transaction-processor-${EnvironmentSuffix}"
            }
          },
          {
            "Key": "Environment",
            "Value": {
              "Ref": "EnvironmentType"
            }
          },
          {
            "Key": "EnvironmentSuffix",
            "Value": {
              "Ref": "EnvironmentSuffix"
            }
          }
        ]
      },
      "DependsOn": [
        "TransactionProcessorLogGroup"
      ]
    },
    "PaymentProcessorLogGroup": {
      "Type": "AWS::Logs::LogGroup",
      "DeletionPolicy": "Delete",
      "UpdateReplacePolicy": "Delete",
      "Properties": {
        "LogGroupName": {
          "Fn::Sub": "/aws/lambda/payment-processor-${EnvironmentSuffix}"
        },
        "RetentionInDays": 14
      }
    },
    "PaymentProcessorFunction": {
      "Type": "AWS::Lambda::Function",
      "DeletionPolicy": "Delete",
      "UpdateReplacePolicy": "Delete",
      "Properties": {
        "FunctionName": {
          "Fn::Sub": "payment-processor-${EnvironmentSuffix}"
        },
        "Runtime": "python3.11",
        "Handler": "index.handler",
        "Role": {
          "Fn::GetAtt": [
            "PaymentProcessorRole",
            "Arn"
          ]
        },
        "MemorySize": {
          "Ref": "LambdaMemorySize"
        },
        "Timeout": 30,
        "Environment": {
          "Variables": {
            "DB_HOST": {
              "Fn::GetAtt": [
                "TransactionDatabase",
                "Endpoint.Address"
              ]
            },
            "DB_PORT": {
              "Fn::GetAtt": [
                "TransactionDatabase",
                "Endpoint.Port"
              ]
            },
            "DB_NAME": "transactions",
            "SESSION_TABLE": {
              "Fn::Sub": "session-table-${EnvironmentSuffix}"
            },
            "ENVIRONMENT": {
              "Ref": "EnvironmentType"
            },
            "REGION": {
              "Ref": "AWS::Region"
            }
          }
        },
        "VpcConfig": {
          "SecurityGroupIds": [
            {
              "Ref": "LambdaSecurityGroup"
            }
          ],
          "SubnetIds": {
            "Ref": "PrivateSubnetIds"
          }
        },
        "Code": {
          "ZipFile": "import json\nimport os\nimport boto3\n\ndef handler(event, context):\n    print(f'Processing payment in region {os.environ[\"REGION\"]}')\n    return {\n        'statusCode': 200,\n        'body': json.dumps({'message': 'Payment processed successfully'})\n    }\n"
        },
        "Tags": [
          {
            "Key": "Name",
            "Value": {
              "Fn::Sub": "payment-processor-${EnvironmentSuffix}"
            }
          },
          {
            "Key": "Environment",
            "Value": {
              "Ref": "EnvironmentType"
            }
          },
          {
            "Key": "EnvironmentSuffix",
            "Value": {
              "Ref": "EnvironmentSuffix"
            }
          }
        ]
      },
      "DependsOn": [
        "PaymentProcessorLogGroup"
      ]
    },
    "OrderProcessorLogGroup": {
      "Type": "AWS::Logs::LogGroup",
      "DeletionPolicy": "Delete",
      "UpdateReplacePolicy": "Delete",
      "Properties": {
        "LogGroupName": {
          "Fn::Sub": "/aws/lambda/order-processor-${EnvironmentSuffix}"
        },
        "RetentionInDays": 14
      }
    },
    "OrderProcessorFunction": {
      "Type": "AWS::Lambda::Function",
      "DeletionPolicy": "Delete",
      "UpdateReplacePolicy": "Delete",
      "Properties": {
        "FunctionName": {
          "Fn::Sub": "order-processor-${EnvironmentSuffix}"
        },
        "Runtime": "python3.11",
        "Handler": "index.handler",
        "Role": {
          "Fn::GetAtt": [
            "OrderProcessorRole",
            "Arn"
          ]
        },
        "MemorySize": {
          "Ref": "LambdaMemorySize"
        },
        "Timeout": 30,
        "Environment": {
          "Variables": {
            "DB_HOST": {
              "Fn::GetAtt": [
                "TransactionDatabase",
                "Endpoint.Address"
              ]
            },
            "DB_PORT": {
              "Fn::GetAtt": [
                "TransactionDatabase",
                "Endpoint.Port"
              ]
            },
            "DB_NAME": "transactions",
            "SESSION_TABLE": {
              "Fn::Sub": "session-table-${EnvironmentSuffix}"
            },
            "ENVIRONMENT": {
              "Ref": "EnvironmentType"
            },
            "REGION": {
              "Ref": "AWS::Region"
            }
          }
        },
        "VpcConfig": {
          "SecurityGroupIds": [
            {
              "Ref": "LambdaSecurityGroup"
            }
          ],
          "SubnetIds": {
            "Ref": "PrivateSubnetIds"
          }
        },
        "Code": {
          "ZipFile": "import json\nimport os\nimport boto3\n\ndef handler(event, context):\n    print(f'Processing order in region {os.environ[\"REGION\"]}')\n    return {\n        'statusCode': 200,\n        'body': json.dumps({'message': 'Order processed successfully'})\n    }\n"
        },
        "Tags": [
          {
            "Key": "Name",
            "Value": {
              "Fn::Sub": "order-processor-${EnvironmentSuffix}"
            }
          },
          {
            "Key": "Environment",
            "Value": {
              "Ref": "EnvironmentType"
            }
          },
          {
            "Key": "EnvironmentSuffix",
            "Value": {
              "Ref": "EnvironmentSuffix"
            }
          }
        ]
      },
      "DependsOn": [
        "OrderProcessorLogGroup"
      ]
    }
  },
  "Outputs": {
    "DatabaseEndpoint": {
      "Description": "RDS database endpoint address",
      "Value": {
        "Fn::GetAtt": [
          "TransactionDatabase",
          "Endpoint.Address"
        ]
      },
      "Export": {
        "Name": {
          "Fn::Sub": "${AWS::StackName}-DatabaseEndpoint"
        }
      }
    },
    "DatabasePort": {
      "Description": "RDS database endpoint port",
      "Value": {
        "Fn::GetAtt": [
          "TransactionDatabase",
          "Endpoint.Port"
        ]
      },
      "Export": {
        "Name": {
          "Fn::Sub": "${AWS::StackName}-DatabasePort"
        }
      }
    },
    "DatabaseReadReplicaEndpoint": {
      "Condition": "IsProduction",
      "Description": "RDS read replica endpoint address (production only)",
      "Value": {
        "Fn::GetAtt": [
          "TransactionDatabaseReadReplica",
          "Endpoint.Address"
        ]
      },
      "Export": {
        "Name": {
          "Fn::Sub": "${AWS::StackName}-DatabaseReadReplicaEndpoint"
        }
      }
    },
    "SessionTableName": {
      "Description": "DynamoDB session table name",
      "Value": {
        "Fn::Sub": "session-table-${EnvironmentSuffix}"
      },
      "Export": {
        "Name": {
          "Fn::Sub": "${AWS::StackName}-SessionTableName"
        }
      }
    },
    "TransactionProcessorArn": {
      "Description": "Transaction processor Lambda function ARN",
      "Value": {
        "Fn::GetAtt": [
          "TransactionProcessorFunction",
          "Arn"
        ]
      },
      "Export": {
        "Name": {
          "Fn::Sub": "${AWS::StackName}-TransactionProcessorArn"
        }
      }
    },
    "PaymentProcessorArn": {
      "Description": "Payment processor Lambda function ARN",
      "Value": {
        "Fn::GetAtt": [
          "PaymentProcessorFunction",
          "Arn"
        ]
      },
      "Export": {
        "Name": {
          "Fn::Sub": "${AWS::StackName}-PaymentProcessorArn"
        }
      }
    },
    "OrderProcessorArn": {
      "Description": "Order processor Lambda function ARN",
      "Value": {
        "Fn::GetAtt": [
          "OrderProcessorFunction",
          "Arn"
        ]
      },
      "Export": {
        "Name": {
          "Fn::Sub": "${AWS::StackName}-OrderProcessorArn"
        }
      }
    },
    "LambdaExecutionPolicyArn": {
      "Description": "Consolidated Lambda execution managed policy ARN",
      "Value": {
        "Ref": "LambdaExecutionManagedPolicy"
      },
      "Export": {
        "Name": {
          "Fn::Sub": "${AWS::StackName}-LambdaExecutionPolicyArn"
        }
      }
    },
    "StackRegion": {
      "Description": "AWS Region where stack is deployed",
      "Value": {
        "Ref": "AWS::Region"
      }
    },
    "EnvironmentType": {
      "Description": "Environment type for this deployment",
      "Value": {
        "Ref": "EnvironmentType"
      }
    },
    "EnvironmentSuffix": {
      "Description": "Environment suffix for resource naming",
      "Value": {
        "Ref": "EnvironmentSuffix"
      }
    }
  }
}