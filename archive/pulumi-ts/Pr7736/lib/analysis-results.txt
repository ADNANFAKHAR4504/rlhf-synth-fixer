S3 Compliance Analysis Report
======================================================================

Scan ID: s3-scan-20251202223800
Timestamp: 2025-12-02T22:38:00.569300Z
Environment: pr7736

Overall Compliance Score: 53.3%
Total Buckets: 15
Compliant Buckets: 8
Non-Compliant Buc  'scanId': f"s3-scan-{datetime.utcnow().strftime('%Y%m%d%H%M%S')}",
/home/runner/work/iac-test-automations/iac-test-automations/lib/analyse.py:70: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  'timestamp': datetime.utcnow().isoformat() + 'Z',
/home/runner/work/iac-test-automations/iac-test-automations/lib/analyse.py:127: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  'timestamp': datetime.utcnow().isoformat() + 'Z',

======================================================================
  S3 Compliance Analysis Infrastructure Demo
======================================================================

This script demonstrates the S3 compliance analysis capabilities
deployed by this Pulumi infrastructure.


======================================================================
  Environment Check
======================================================================

  AWS_REGION: us-east-1
  AWS_ACCESS_KEY_ID: ***
  AWS_SECRET_ACCESS_KEY: ***
  ENVIRONMENT_SUFFIX: pr7736

âœ… Environment variables configured

======================================================================
  Infrastructure Validation
======================================================================

ğŸ—ï¸ Required Pulumi Resources:
  âœ“ S3 Bucket (compliance reports storage)
  âœ“ Lambda Function (S3 compliance analyzer)
  âœ“ IAM Role (Lambda execution role)
  âœ“ IAM Policy (S3 read, CloudWatch metrics, tagging permissions)
  âœ“ CloudWatch Log Group (Lambda logging)
  âœ“ CloudWatch Metric Filter (critical findings)
  âœ“ CloudWatch Alarm (critical compliance violations)
  âœ“ SNS Topic (critical alert notifications)
  âœ“ EventBridge Rule (daily scheduled analysis)
  âœ“ EventBridge Target (Lambda invocation)
  âœ“ Lambda Permission (EventBridge invoke)

âœ… All required infrastructure components defined

======================================================================
  Compliance Features Validation
======================================================================

ğŸ“‹ S3 Compliance Checks:
  âœ“ Server-side encryption detection
  âœ“ Public access block validation
  âœ“ Bucket policy analysis (overly permissive access)
  âœ“ Lifecycle policy verification (7-year retention for financial data)
  âœ“ CloudWatch metrics analysis (90-day inactivity detection)
  âœ“ Bucket tagging with compliance status
  âœ“ JSON report generation with severity categories
  âœ“ Report storage in S3 with timestamp

âœ… All compliance features implemented

======================================================================
  Simulating S3 Compliance Scan
======================================================================

ğŸ“‹ Analyzing S3 buckets...
  âœ“ Checking server-side encryption configuration
  âœ“ Verifying public access block settings
  âœ“ Analyzing bucket policies for overly permissive access
  âœ“ Validating lifecycle policies for financial data retention
  âœ“ Reviewing CloudWatch metrics for inactive buckets
  âœ“ Tagging buckets with compliance status

âœ… S3 compliance scan completed

======================================================================
  S3 Compliance Analysis Report
======================================================================

Scan ID: s3-scan-20251202223800
Timestamp: 2025-12-02T22:38:00.569300Z
Environment: pr7736

ğŸ“Š Overall S3 Compliance Score
  Score: 53.3%
  Total Buckets: 15
  Compliant: 8
  Non-Compliant: 7

ğŸ“ˆ Violations by Severity
  ğŸ”´ CRITICAL: 2 violation(s)
  ğŸŸ  HIGH: 3 violation(s)
  ğŸŸ¡ MEDIUM: 2 violation(s)
  ğŸŸ¢ LOW: 0 violation(s)

ğŸ” Detailed Findings

  CRITICAL Violations (2):
    â€¢ Bucket: example-data-bucket
      Issue: No server-side encryption configured
      Recommendation: Enable SSE-S3 or SSE-KMS encryption

    â€¢ Bucket: legacy-files-bucket
      Issue: No public access block configuration
      Recommendation: Configure Block Public Access settings


  HIGH Violations (3):
    â€¢ Bucket: user-uploads-bucket
      Issue: Public access not fully blocked
      Recommendation: Enable all Block Public Access settings

    â€¢ Bucket: financial-invoices-2020
      Issue: Financial data retention policy does not meet 7-year requirement
      Recommendation: Configure lifecycle policy with minimum 7-year retention

    â€¢ Bucket: reports-bucket
      Issue: Bucket policy allows public access
      Recommendation: Restrict bucket policy to specific principals


  MEDIUM Violations (2):
    â€¢ Bucket: temp-files-bucket
      Issue: No access metrics in last 90 days - potential unused bucket
      Recommendation: Review bucket usage and consider archival or deletion

    â€¢ Bucket: archive-2019
      Issue: No access metrics in last 90 days - potential unused bucket
      Recommendation: Review bucket usage and consider archival or deletion


ğŸ“„ Report saved to: lib/analysis-results.txt

======================================================================
  Analysis Complete
======================================================================

âš ï¸  WARNING: 2 critical violation(s) detected
   Overall compliance score: 53.3%
   Recommendation: Immediate remediation required for critical issues
