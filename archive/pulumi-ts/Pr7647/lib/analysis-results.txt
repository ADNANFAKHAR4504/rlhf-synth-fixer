============================================================
COMPLIANCE MONITORING INFRASTRUCTURE ANALYSIS
============================================================

=== Analyzing Lambda Function ===
‚úÖ PASS: Lambda Function Exists
   Found Lambda function: compliance-analyzer-test
‚úÖ PASS: Lambda Runtime
   Runtime: nodejs18.x
‚úÖ PASS: Lambda Handler
   Handler: index.handler
‚úÖ PASS: Lambda Timeout
   Timeout: 300s (expected: 300s)
‚úÖ PASS: Lambda Memory
   Memory: 512MB (expected: 512MB)
‚úÖ PASS: Lambda Env Var: DYNAMO_TABLE_NAME
   DYNAMO_TABLE_NAME: Present
‚úÖ PASS: Lambda Env Var: SNS_TOPIC_ARN
   SNS_TOPIC_ARN: Present
‚úÖ PASS: Lambda Env Var: COMPLIANCE_NAMESPACE
   COMPLIANCE_NAMESPACE: Present

=== Analyzing SNS Topic ===
‚úÖ PASS: SNS Topic Exists
   Found SNS topic: arn:aws:sns:us-east-1:123456789012:compliance-notifications-test
‚úÖ PASS: SNS Email Subscription
   Email subscriptions: 1
‚úÖ PASS: SNS Subscription Endpoint
   Endpoint: compliance@company.com

=== Analyzing DynamoDB Table ===
‚úÖ PASS: DynamoDB Table Exists
   Found DynamoDB table: compliance-history-test
‚úÖ PASS: DynamoDB Hash Key
   Hash Key: checkId (expected: checkId)
‚úÖ PASS: DynamoDB Range Key
   Range Key: timestamp (expected: timestamp)
‚úÖ PASS: DynamoDB Billing Mode
   Billing Mode: PAY_PER_REQUEST (expected: PAY_PER_REQUEST)
‚úÖ PASS: DynamoDB TTL Enabled
   TTL Status: ENABLED
‚úÖ PASS: DynamoDB TTL Attribute
   TTL Attribute: expirationTime (expected: expirationTime)

=== Analyzing EventBridge Rule ===
‚úÖ PASS: EventBridge Rule Exists
   Found EventBridge rule: compliance-schedule-test
‚úÖ PASS: EventBridge Schedule
   Schedule: rate(15 minutes) (expected: rate(15 minutes))
‚úÖ PASS: EventBridge Lambda Target
   Lambda targets: 1

=== Analyzing CloudWatch Alarm ===
‚úÖ PASS: CloudWatch Alarm Exists
   Found CloudWatch alarm: compliance-failure-alarm-test
‚úÖ PASS: Alarm Metric Name
   Metric: ComplianceFailureRate (expected: ComplianceFailureRate)
‚úÖ PASS: Alarm Namespace
   Namespace: ComplianceMonitoring (expected: ComplianceMonitoring)
‚úÖ PASS: Alarm Threshold
   Threshold: 20.0% (expected: 20%)
‚úÖ PASS: Alarm Period
   Period: 900s (expected: 900s / 15 minutes)
‚úÖ PASS: Alarm SNS Actions
   Alarm actions configured: 1

=== Analyzing CloudWatch Logs ===
‚úÖ PASS: CloudWatch Log Group Exists
   Found log group: /aws/lambda/compliance-analyzer-test
‚úÖ PASS: Log Retention Period
   Retention: 7 days (expected: 7 days)

=== Analyzing IAM Roles ===
‚úÖ PASS: Lambda IAM Role Exists
   Found IAM role: compliance-lambda-role-test
‚ùå FAIL: Lambda Basic Execution Policy
   Lambda execution policies attached: 0
‚ùå FAIL: Lambda Custom IAM Policy
   Inline policies: 0

=== Analyzing Resource Tags ===
   ‚ÑπÔ∏è  Tag validation requires actual deployment
‚úÖ PASS: Resource Tagging
   Tags defined in infrastructure code (Environment=compliance-monitoring, CostCenter=security)

============================================================
ANALYSIS SUMMARY
============================================================
‚úÖ Checks Passed: 30
‚ùå Checks Failed: 2
üìä Total Checks: 32
‚ú® Success Rate: 93.8%
============================================================
