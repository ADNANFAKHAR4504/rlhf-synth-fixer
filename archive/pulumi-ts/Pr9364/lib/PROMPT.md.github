# Prompt: Generate Pulumi TypeScript (`index.ts`)

You are an expert Pulumi engineer with 10+ years of experience. Your task is to generate a **Pulumi TypeScript configuration file** named `index.ts` that meets the **exact requirements** listed in the "Provided Data" section.  
**Do not modify, remove, or reword any part of the Provided Data** — it is immutable and must be used exactly as given.

---

## PROVIDED DATA (IMMUTABLE – DO NOT ALTER)

### Constraints:

1. Use **Terraform version 1.0.0 or later**.
2. All infrastructure must be deployed in the **`us-west-2` AWS region**.
3. All AWS resources must be **tagged with `Environment: Production`**.
4. Create a **VPC** with CIDR block `10.0.0.0/16`.
5. Create **both public and private subnets across 3 availability zones**.
6. Configure an **Application Load Balancer (ALB)** in front of EC2 instances.
7. Launch **EC2 instances** of type `t3.micro` inside the VPC.
8. Configure **Auto Scaling** with a minimum of **2 EC2 instances**.
9. Deploy a **MySQL RDS instance** with **KMS-based encryption enabled**.
10. Configure **IAM roles** for both **EC2** and **RDS** for secure access control.
11. Create **S3 buckets** with **versioning enabled** and **default private access**.
12. **Security groups must allow SSH access only** from a **specific IP range**.

---

### Environment:

You are tasked with setting up a cloud environment using Pulumi to support a web application. The environment must meet the following requirements:

1. Deploy a **Virtual Private Cloud (VPC)** with **CIDR block `10.0.0.0/16`**.
2. Create **both public and private subnets across 3 availability zones**.
3. Set up an **Application Load Balancer (ALB)** to route traffic to EC2 instances.
4. Launch **EC2 instances** within the VPC using **instance type `t3.micro`**, with **autoscaling enabled** and **a minimum of 2 instances**.
5. Deploy an **RDS MySQL instance** with **storage encryption enabled using AWS KMS**.
6. Implement **IAM roles** for EC2 and RDS to ensure **secure access control**.
7. Enable **versioning** and default **private access** on S3 buckets.
8. Tag **all resources** with `'Environment: Production'`.
9. Use **Terraform version 1.0.0 or later** as the baseline reference.
10. Set up **security groups** to allow **SSH only from a specified IP range**.

---

### Expected Output:

Create a **Pulumi TypeScript configuration file named `index.ts`** that satisfies all the above constraints and environment requirements.  
The code must be fully deployable using `pulumi up` and must pass all validations.  
No manual modifications should be required after generation.

---

### Proposed Statement:

The infrastructure is to be deployed in the AWS `us-west-2` region with strict compliance to the given constraints.  
This involves networking setup, application hosting, database configuration, IAM security, and object storage — all built to serve a **production-ready web application** using industry best practices.

---

## GENERATION RULES

1. Output only the **Pulumi TypeScript configuration file** named `index.ts`.
2. Use idiomatic **Pulumi v3+ TypeScript** syntax.
3. Include **configuration variables** for:
   - VPC CIDR
   - Public/private subnet CIDRs
   - SSH allowed IP range
   - Project name or tags
4. Implement:
   - A **VPC** with 3 **public and private subnets** across 3 AZs in `us-west-2`
   - **Security groups** that allow SSH **only** from a specified IP range
   - **EC2 instances** (type `t3.micro`) in an **auto scaling group** with a **minimum of 2 instances**
   - An **Application Load Balancer (ALB)** with listeners forwarding to EC2 instances
   - An **RDS MySQL instance** with **KMS-encrypted storage**
   - **S3 buckets** with **versioning enabled** and **private access by default**
   - **IAM roles** for EC2 and RDS that enforce **least privilege access**
5. Apply the **tag `Environment = Production`** to **every resource**.
6. Ensure the infrastructure runs in the **`us-west-2` region**.
7. Use `pulumi preview` and `pulumi up` for verification.
8. Ensure the output is **modular, reusable**, and **production-ready**.

---

## FINAL TASK FOR AI

Generate the complete `index.ts` Pulumi TypeScript configuration file that **exactly matches the PROVIDED DATA** and complies with all **GENERATION RULES** above.  
Do **not include** any explanations, Markdown, or comments outside the TypeScript file.  
Only output the Pulumi configuration content.