======================================================================
AWS Compliance Monitoring Infrastructure Analysis
======================================================================

üìä Running Compliance Scan...
Scan ID: scan-20251203-055524
Timestamp: 2025-12-03T05:55:24.918262

======================================================================
COMPLIANCE SUMMARY
======================================================================
Total Resources Scanned: 83
Compliant Resources: 72
Total Violations: 11
Overall Compliance Score: 86.75%

Service Compliance Scores:
  ‚ö†Ô∏è ec2: 80.0%
  ‚ö†Ô∏è securityGroups: 87.5%
  ‚ö†Ô∏è s3: 83.33%
  ‚úÖ iam: 92.0%
  ‚ö†Ô∏è ebs: 83.33%
  ‚úÖ vpc: 100.0%

======================================================================
VIOLATIONS BY SERVICE
======================================================================

EC2 (3 violations):
  ‚Ä¢ EC2 instance i-abc123 using unapproved instance type t3.2xlarge
  ‚Ä¢ EC2 instance i-def456 missing required tags
  ‚Ä¢ EC2 instance i-ghi789 in non-compliant availability zone

SECURITYGROUPS (1 violations):
  ‚Ä¢ Security group sg-abc123 allows unrestricted ingress on port 22

S3 (2 violations):
  ‚Ä¢ S3 bucket example-bucket-1 does not have encryption enabled
  ‚Ä¢ S3 bucket example-bucket-2 has public read access enabled

IAM (2 violations):
  ‚Ä¢ IAM user john.doe has not rotated access keys in 90+ days
  ‚Ä¢ IAM role AdminRole has overly permissive policy attached

EBS (3 violations):
  ‚Ä¢ EBS volume vol-abc123 is not encrypted
  ‚Ä¢ EBS volume vol-def456 is not encrypted
  ‚Ä¢ EBS volume vol-ghi789 has no snapshot configured

======================================================================
AWS CONFIG RULES ANALYSIS
======================================================================
Total Rules: 4
Active Rules: 4
Average Compliance: 86.65%

Rule Details:
  ‚Ä¢ ec2-approved-instance-types: 80.0% compliant
  ‚Ä¢ s3-bucket-encryption-enabled: 83.3% compliant
  ‚Ä¢ rds-backup-retention-enabled: 100.0% compliant
  ‚Ä¢ ebs-volumes-encrypted: 83.3% compliant

======================================================================
LAMBDA FUNCTIONS ANALYSIS
======================================================================
Total Functions: 3
Deployed Functions: 3

Function Details:
  ‚Ä¢ compliance-processing-lambda
    Purpose: Process Config rule evaluation events
    Status: DEPLOYED
  ‚Ä¢ compliance-aggregation-lambda
    Purpose: Aggregate compliance data from multiple sources
    Status: DEPLOYED
  ‚Ä¢ compliance-remediation-lambda
    Purpose: Automatically remediate compliance violations
    Status: DEPLOYED

======================================================================
CLOUDWATCH DASHBOARD ANALYSIS
======================================================================
Dashboard: ComplianceMonitoring
Status: ACTIVE
Widgets: 5
Metrics Tracked: 5

======================================================================
OVERALL ASSESSMENT
======================================================================
‚ö†Ô∏è  GOOD: Infrastructure is mostly compliant with some improvements needed

Recommendations:
  1. Enable encryption on all S3 buckets and EBS volumes
  2. Enforce approved EC2 instance types across all deployments
  3. Implement automated remediation for critical violations
  4. Review and rotate IAM access keys regularly
  5. Configure SNS notifications for high-priority violations

‚úÖ Analysis complete. Results saved to /home/runner/work/iac-test-automations/iac-test-automations/lib/analysis-results.txt

