Create a Pulumi TypeScript program to deploy a CI/CD pipeline using AWS CodePipeline and CodeBuild. The configuration must: 1. Create an S3 bucket for pipeline artifacts with versioning enabled and lifecycle rules to delete objects after 30 days. 2. Set up an ECR repository for storing Docker images with image scanning on push. 3. Configure a CodeBuild project that uses the aws/codebuild/standard:5.0 image and builds from a GitHub repository. 4. Implement proper IAM roles for CodePipeline and CodeBuild with least-privilege permissions. 5. Create a three-stage pipeline: Source (GitHub), Build (CodeBuild), and Manual Approval. 6. Configure the build stage to output Docker image tags as pipeline variables. 7. Enable CloudWatch Logs for CodeBuild with 7-day retention. 8. Tag all resources with Environment=production and Team=devops. 9. Export the pipeline ARN and artifact bucket name as stack outputs.
